!function(o){"function"==typeof define&&define.amd?define(["jquery"],o):"object"==typeof module&&module.exports?module.exports=function(t,e){return void 0===e&&(e="undefined"!=typeof window?require("jquery"):require("jquery")(t)),o(e),e}:o(jQuery)}(function(o){"use strict";o.extend(o.FroalaEditor.POPUP_TEMPLATES,{"colors.picker":"[_BUTTONS_][_TEXT_COLORS_][_BACKGROUND_COLORS_]"}),o.extend(o.FroalaEditor.DEFAULTS,{colorsText:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],colorsBackground:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],colorsStep:7,colorsDefaultTab:"text",colorsButtons:["colorsBack","|","-"],defaultColors:{background:{init:!1,color:""},text:{init:!1,color:""}},isIE:document.documentMode||/Edge/.test(navigator.userAgent)}),o.FroalaEditor.PLUGINS.colors=function(o){function t(){var t=o.$tb.find('.fr-command[data-cmd="color"]'),e=o.popups.get("colors.picker");if(e||(e=r()),!e.hasClass("fr-active")){o.popups.setContainer("colors.picker",o.$tb),c(e.find(".fr-selected-tab").attr("data-param1"));var a=t.offset().left+t.outerWidth()/2,s=t.offset().top+(o.opts.toolbarBottom?10:t.outerHeight()-10);o.selection.save(),o.popups.show("colors.picker",a,s,t.outerHeight()),o.opts.isIE?($(".fr-popup").find(".sp-input").hide(),$(".fr-popup").find(".sp-palette-toggle").hide(),$(".fr-popup").find(".sp-picker-container").hide()):$(".sp-input").show(),o.selection.restore(),l()}}function e(){o.popups.hide("colors.picker")}function r(){var t='<div class="fr-buttons fr-colors-buttons">';o.opts.toolbarInline&&o.opts.colorsButtons.length>0&&(t+=o.button.buildList(o.opts.colorsButtons)),t+=a()+"</div>";var e={buttons:t,text_colors:s("text"),background_colors:s("background")},r=o.popups.create("colors.picker",e);return r}function a(){var t='<div class="fr-colors-tabs">';return t+='<span class="fr-colors-tab '+("background"==o.opts.colorsDefaultTab?"":"fr-selected-tab ")+'fr-command" data-param1="text" data-cmd="colorChangeSet" title="'+o.language.translate("Text")+'">'+o.language.translate("Text")+"</span>",t+='<span class="fr-colors-tab '+("background"==o.opts.colorsDefaultTab?"fr-selected-tab ":"")+'fr-command" data-param1="background" data-cmd="colorChangeSet" title="'+o.language.translate("Background")+'">'+o.language.translate("Background")+"</span>",t+"</div>"}function s(t){var e="text"==t?o.opts.colorsText:o.opts.colorsBackground,r="text"==t?"clearTextColor":"clearBackgroundColor",a="text"==t?"textColorSpectrum":"bgColorSpectrum",s="text"==t?"toggleTextSpectrum":"toggleBgSpectrum",c="text"==t?"chooseTextColor":"chooseBGColor",l='<div class="sp-container sp-light sp-alpha-enabled sp-clear-enabled sp-initial-disabled fr-color-set fr-'+t+"-color"+(o.opts.colorsDefaultTab==t||"text"!=o.opts.colorsDefaultTab&&"background"!=o.opts.colorsDefaultTab&&"text"==t?" fr-selected-set":"")+'">';l+='<div class="color-inner-row">';for(var n=0;n<e.length;n++)0!==n&&n%o.opts.colorsStep===0&&(l+="<br>"),l+="REMOVE"!=e[n]?'<span class="fr-command fr-select-color" style="background: '+e[n]+';" data-cmd="'+t+'Color" data-param1="'+e[n]+'"></span>':o.opts.isIE?'<span class="fr-command fr-select-color" data-cmd="'+t+'Color" data-param1="REMOVE" title="'+o.language.translate("Clear Formatting")+'"><i class="fa fa-eraser"></i></span>':'<span style="visibility: hidden;" class="fr-command fr-select-color" data-cmd="'+t+'Color" data-param1="REMOVE" title="'+o.language.translate("Clear Formatting")+'"><i class="fa fa-eraser"></i></span>';return l+='<div class="sp-palette-button-container sp-cf"><button type="button" class="sp-palette-toggle fr-command" data-cmd="'+s+'">less</button></div>',l+="</div>",l+='<div class="sp-picker-container"><div class="sp-top sp-cf"><div class="sp-fill"></div><div class="sp-top-inner"><div class="sp-color fr-command" data-cmd="'+a+'" style="background-color: rgb(255, 0, 0);"><div class="sp-sat"><div class="sp-val"><div class="sp-dragger" style="display: none;"></div></div></div></div><div class="sp-clear sp-clear-display fr-command" data-cmd="'+r+'" title="Clear Color Selection"></div><div class="sp-hue"><div class="sp-slider" style="display: none;"></div></div></div><div class="sp-alpha"><div class="sp-alpha-inner"><div class="sp-alpha-handle" style="display: none;"></div></div></div></div><div class="sp-input-container sp-cf"><input style="display:none;" class="sp-input" type="text" spellcheck="false" placeholder=""></div><div class="sp-initial sp-thumb sp-cf"></div><div class="sp-button-container sp-cf"><a class="sp-cancel fr-command" data-cmd="cancelColor" href="#">cancel</a><button type="button" class="sp-choose fr-command" data-cmd="'+c+'">choose</button></div></div>',l+="</div>"}function c(t){var e,r=o.popups.get("colors.picker"),a=$(o.selection.element());for(e="background"==t?"background-color":"color",r.find(".fr-"+t+"-color .fr-select-color").removeClass("fr-selected-color");a.get(0)!=o.$el.get(0);){if(setTimeout(function(){g(e,"color"==e?o.opts.defaultColors.text.color:o.opts.defaultColors.background.color)},0),"transparent"!=a.css(e)&&"rgba(0, 0, 0, 0)"!=a.css(e)){r.find(".fr-"+t+'-color .fr-select-color[data-param1="'+o.helpers.RGBToHex(a.css(e))+'"]').addClass("fr-selected-color");break}a=a.parent()}}function l(){var t=$(o.selection.element());o.opts.defaultColors.background.color=t.css("background-color"),o.opts.defaultColors.text.color=t.css("color")}function n(o,t){o.hasClass("fr-selected-tab")||(o.siblings().removeClass("fr-selected-tab"),o.addClass("fr-selected-tab"),o.parents(".fr-popup").find(".fr-color-set").removeClass("fr-selected-set"),o.parents(".fr-popup").find(".fr-color-set.fr-"+t+"-color").addClass("fr-selected-set"),c(t))}function i(t,e){var r=o.popups.get("colors.picker");if("REMOVE"!=t){r.find("input.sp-input").val(t);var a=o.helpers.RGBToHex(t);o.format.applyStyle("background-color",t),o.selection.save(),$(".fr-command.fr-select-color[data-cmd='backgroundColor']").removeClass("fr-selected-color"),$(".fr-command.fr-select-color[data-cmd='backgroundColor'][data-param1='"+a+"']").addClass("fr-selected-color")}else r.find("input.sp-input").val(""),o.format.applyStyle("background-color","#123456"),o.selection.save(),o.$el.find("span").each(function(t,e){var r=$(e),a=r.css("background-color");("#123456"===a||"#123456"===o.helpers.RGBToHex(a))&&r.replaceWith(r.html())}),o.selection.restore();e&&g("background-color",t)}function d(t,e){var r=o.popups.get("colors.picker");if("REMOVE"!=t){r.find("input.sp-input").val(t);var a=o.helpers.RGBToHex(t);o.format.applyStyle("color",t),o.selection.save(),$(".fr-command.fr-select-color[data-cmd='textColor']").removeClass("fr-selected-color"),$(".fr-command.fr-select-color[data-cmd='textColor'][data-param1='"+a+"']").addClass("fr-selected-color")}else o.format.applyStyle("color","#123456"),r.find("input.sp-input").val(t),o.selection.save(),o.$el.find("span").each(function(t,e){var r=$(e),a=r.css("color");("#123456"===a||"#123456"===o.helpers.RGBToHex(a))&&r.replaceWith(r.html())}),o.selection.restore();e&&g("color",t)}function p(t,e){var r=o.popups.get("colors.picker");r.find("input.sp-input").val(""),"text"===t?($(".fr-command.fr-select-color[data-cmd='textColor']").removeClass("fr-selected-color"),o.format.applyStyle("color","#123456"),o.selection.save(),o.$el.find("span").each(function(t,e){var r=$(e),a=r.css("color");("#123456"===a||"#123456"===o.helpers.RGBToHex(a))&&r.replaceWith(r.html())}),o.selection.restore(),g("color")):($(".fr-command.fr-select-color[data-cmd='backgroundColor']").removeClass("fr-selected-color"),o.format.applyStyle("background-color","#123456"),o.selection.save(),o.$el.find("span").each(function(t,e){var r=$(e),a=r.css("background-color");("#123456"===a||"#123456"===o.helpers.RGBToHex(a))&&r.replaceWith(r.html())}),o.selection.restore(),g("background-color"))}function u(t){t&&(i(o.opts.defaultColors.background.color||"REMOVE"),d(o.opts.defaultColors.text.color||"REMOVE")),e()}function f(t){var r=o.popups.get("colors.picker"),a="text"===t?r.find(".fr-color-set.sp-container.fr-text-color"):r.find(".fr-color-set.sp-container.fr-background-color"),s=a.find(".sp-input"),c=s.val();o.selection.restore(),"text"===t?d(c||"REMOVE"):i(c||"REMOVE"),e()}function m(t){var e=o.popups.get("colors.picker"),r="text"===t?e.find(".fr-color-set.sp-container.fr-text-color"):$(".fr-color-set.sp-container.fr-background-color"),a=r.find(".sp-picker-container"),s=r.find(".sp-palette-toggle");a.toggle();var c=a.is(":visible");c?(s.text("less"),r.removeClass("no-spectrum")):(s.text("more"),r.addClass("no-spectrum"))}function g(t,e){function r(){(0>=y||0>=F||0>=R)&&c(),O=!0,m.addClass(M),w=null}function a(){O=!1,m.removeClass(M)}function s(){l(t)}function c(){u()}function l(t,e){if(u(),!A){var r=tinycolor.fromRatio({h:P,s:1,v:1});k.css("background-color",r.toHexString());var a=n();if(a){var s=a.toHexString(),c=a.toRgbString();e||("color"===t?d(c):i(c));var l=a.toRgb();l.a=0;var p=tinycolor(l).toRgbString(),f="linear-gradient(left, "+p+", "+s+")";o.opts.isIE?D.css("filter",tinycolor(p).toFilter({gradientType:1},s)):(D.css("background","-webkit-"+f),D.css("background","-moz-"+f),D.css("background","-ms-"+f),D.css("background","linear-gradient(to right, "+p+", "+s+")"))}}}function n(o){return tinycolor.fromRatio({h:P,s:V,v:H,a:Math.round(100*G)/100},{format:"rgb"})}function p(o,e){if(tinycolor.equals(o,n()))return void l(t,e);var r,a;o?(A=!1,r=tinycolor(o),a=r.toHsv(),P=a.h%360/360,V=a.s,H=a.v,G=a.a):A=!0,l(t,e)}function u(){var o=V,t=H;if(A)C.hide(),h.hide(),g.hide();else{C.show(),h.show(),g.show();var e=o*F,r=y-t*y;e=Math.max(-B,Math.min(F-B,e-B)),r=Math.max(-B,Math.min(y-B,r-B)),g.css({top:r+"px",left:e+"px"});var a=G*$;C.css({left:a-T/2+"px"});var s=P*R;h.css({top:s-S+"px"})}}var f=o.popups.get("colors.picker");f.find("input:focus").blur();var m="color"===t?f.find(".fr-color-set.sp-container.fr-text-color"):f.find(".fr-color-set.sp-container.fr-background-color"),g=m.find(".sp-dragger"),h=m.find(".sp-slider"),C=m.find(".sp-alpha-handle"),k=m.find(".sp-color"),E=m.find(".sp-hue"),x=m.find(".sp-alpha"),F=k.width(),y=k.height(),B=g.height(),R=(E.width(),E.height()),S=h.height(),$=x.width(),T=C.width(),D=m.find(".sp-alpha-inner"),M="sp-dragging",w=null,A=!0,O=!1,P=0,V=0,H=0,G=1,_=m.find(".sp-input");v(_,t),b(x,function(o,t,e){G=o/$,A=!1,e.shiftKey&&(G=Math.round(10*G)/10),s()},r,a),b(E,function(o,t){P=parseFloat(t/R),A=!1,s()},r,a),b(k,function(o,t,e){V=parseFloat(o/F),H=parseFloat((y-t)/y),A=!1,s()},r,a),e?(p(e,!0),s()):(A=!0,s())}function h(){o.popups.hide("colors.picker"),o.toolbar.showInline()}function v(t,r){$(t).off("keypress").on("keypress",function(a){if(13==a.which){var s=$(t).val();o.selection.restore(),"color"===r?d(s,!0):i(s,!0),e()}})}function b(t,e,r,a){function s(o){o.stopPropagation&&o.stopPropagation(),o.preventDefault&&o.preventDefault(),o.returnValue=!1}function c(r){if(o.events.disableBlur(),o.selection.restore(),d){if(o.opts.isIE&&i.documentMode<9&&!r.button)return n();var a=r.originalEvent&&r.originalEvent.touches&&r.originalEvent.touches[0],c=a&&a.pageX||r.pageX,l=a&&a.pageY||r.pageY,g=Math.max(0,Math.min(c-p.left,f)),h=Math.max(0,Math.min(l-p.top,u));m&&s(r),e.apply(t,[g,h,r])}}function l(o){var e=o.which?3==o.which:2==o.button;e||d||r.apply(t,arguments)!==!1&&(d=!0,u=$(t).height(),f=$(t).width(),p=$(t).offset(),$(i).bind(g),$(i.body).addClass("sp-dragging"),c(o),s(o))}function n(){d&&($(i).unbind(g),$(i.body).removeClass("sp-dragging"),setTimeout(function(){a.apply(t,arguments)},0)),d=!1}e=e||function(){},r=r||function(){},a=a||function(){};var i=document,d=!1,p={},u=0,f=0,m="ontouchstart"in window,g={};g.selectstart=s,g.dragstart=s,g["touchmove mousemove"]=c,g["touchend mouseup"]=n,$(t).off("touchstart mousedown").on("touchstart mousedown",l),$(t).off("touchend mouseup").on("touchend mouseup",n);var h=o.popups.get("colors.picker");h.on("touchend mouseup",n)}return{showColorsPopup:t,hideColorsPopup:e,changeSet:n,background:i,text:d,back:h,removeColor:p,chooseColorPicker:f,closeColorPicker:u,initializeSpectrum:g,toggleSpectrum:m}},o.FroalaEditor.DefineIcon("colors",{NAME:"tint"}),o.FroalaEditor.RegisterCommand("color",{title:"Colors",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("colors.picker")?(this.$el.find(".fr-marker")&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("colors.picker")):this.colors.showColorsPopup()},plugin:"colors"}),o.FroalaEditor.RegisterCommand("textColor",{undo:!0,callback:function(o,t){this.selection.restore(),this.colors.text(t,!0)}}),o.FroalaEditor.RegisterCommand("backgroundColor",{undo:!0,callback:function(o,t){this.selection.restore(),this.colors.background(t,!0)}}),o.FroalaEditor.RegisterCommand("colorChangeSet",{undo:!1,focus:!1,callback:function(o,t){var e=this.popups.get("colors.picker").find('.fr-command[data-cmd="'+o+'"][data-param1="'+t+'"]');this.colors.changeSet(e,t)}}),o.FroalaEditor.RegisterCommand("clearTextColor",{undo:!1,focus:!1,callback:function(o,t){this.popups.get("colors.picker").find('.fr-command[data-cmd="'+o+'"][data-param1="'+t+'"]');this.colors.removeColor("text",t)}}),o.FroalaEditor.RegisterCommand("clearBackgroundColor",{undo:!1,focus:!1,callback:function(o,t){this.popups.get("colors.picker").find('.fr-command[data-cmd="'+o+'"][data-param1="'+t+'"]');this.colors.removeColor("background",t)}}),o.FroalaEditor.RegisterCommand("chooseTextColor",{undo:!1,focus:!1,callback:function(o,t){this.colors.chooseColorPicker("text")}}),o.FroalaEditor.RegisterCommand("chooseBGColor",{undo:!1,focus:!1,callback:function(o,t){this.colors.chooseColorPicker("background")}}),o.FroalaEditor.RegisterCommand("cancelColor",{undo:!1,focus:!1,callback:function(o,t){this.colors.closeColorPicker(!0)}}),o.FroalaEditor.RegisterCommand("textColorSpectrum",{undo:!1,focus:!1,callback:function(o){this.colors.initializeSpectrum("text",!0)}}),o.FroalaEditor.RegisterCommand("bgColorSpectrum",{undo:!1,focus:!1,callback:function(o){this.colors.initializeSpectrum("background",!0)}}),o.FroalaEditor.RegisterCommand("toggleTextSpectrum",{undo:!1,focus:!1,callback:function(o){this.colors.toggleSpectrum("text")}}),o.FroalaEditor.RegisterCommand("toggleBgSpectrum",{undo:!1,focus:!1,callback:function(o){this.colors.toggleSpectrum("background")}}),o.FroalaEditor.DefineIcon("colorsBack",{NAME:"arrow-left"}),o.FroalaEditor.RegisterCommand("colorsBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.colors.back()}})});
