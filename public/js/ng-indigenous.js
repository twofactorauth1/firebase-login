var mainApp=angular.module("mainApp",["ipCookie","ngResource","ngRoute","ngSanitize","ngTouch","ngMask","angular-parallax","config","dm.style","duScroll","mrPageEnterAnimate","angularMoment","timer","ui","ui.bootstrap","com.2fdevs.videogular","com.2fdevs.videogular.plugins.controls","com.2fdevs.videogular.plugins.overlayplay","com.2fdevs.videogular.plugins.buffering","com.2fdevs.videogular.plugins.poster","truncate","angular-jqcloud","720kb.socialshare","slick","wu.masonry","slugifier","LocalStorageModule","ngMap"]).config(["$routeProvider","$locationProvider","$httpProvider","localStorageServiceProvider",function(e,t,n,o){"use strict";window.history&&window.history.pushState&&t.html5Mode(!0).hashPrefix("!"),e.when("/",{template:function(e){var t='<div class="main-include" ssb-data-styles data-ng-include="';return 1===window.indigenous.defaultBlog?t+=" '/template/blog-list":t+=" '/template/index",e.cachebuster&&(t+="?cachebuster="+e.cachebuster),t+="'",t+=' "></div>'},controller:"CacheCtrl as cacheCtrl",reloadOnSearch:!1}).when("/404",{templateUrl:"../views/404.html",controller:"NotFoundCtrl as notfound"}).when("/blog",{template:function(e){var t,n="blog";return!0===window.indigenous.ssbBlog&&(n="blog-list"),t='<div class="main-include" ssb-data-styles data-ng-include="',t+=" '/template/"+n,e.cachebuster&&(t+="?cachebuster="+e.cachebuster),t+="'",t+=' "></div>'},controller:"CacheCtrl as cacheCtrl"}).when("/page/blog/:postName",{template:function(e){if(!0===window.indigenous.ssbBlog)return"<div data-ng-include=\"'blogpost.html'\"></div>";var t='<div data-ng-include="';return t+=" '/template/single-post",e.cachebuster&&(t+="?cachebuster="+e.cachebuster),t+="'",t+=' "></div>'},controller:"CacheCtrl as cacheCtrl"}).when("/author/:author",{template:function(e){var t,n="blog";return!0===window.indigenous.ssbBlog&&(n="blog-list"),t='<div class="main-include" ssb-data-styles data-ng-include="',t+=" '/template/"+n,e.cachebuster&&(t+="?cachebuster="+e.cachebuster),t+="'",t+=' "></div>'},controller:"CacheCtrl as cacheCtrl"}).when("/tag/:tag",{template:function(e){var t,n="blog";return!0===window.indigenous.ssbBlog&&(n="blog-list"),t='<div class="main-include" ssb-data-styles data-ng-include="',t+=" '/template/"+n,e.cachebuster&&(t+="?cachebuster="+e.cachebuster),t+="'",t+=' "></div>'},controller:"CacheCtrl as cacheCtrl"}).when("/category/:category",{template:function(e){var t,n="blog";return!0===window.indigenous.ssbBlog&&(n="blog-list"),t='<div class="main-include" ssb-data-styles data-ng-include="',t+=" '/template/"+n,e.cachebuster&&(t+="?cachebuster="+e.cachebuster),t+="'",t+=' "></div>'},controller:"CacheCtrl as cacheCtrl"}).when("/blog/:postName",{template:function(e){if(!0===window.indigenous.ssbBlog)return"<div data-ng-include=\"'blogpost.html'\"></div>";var t='<div data-ng-include="';return t+=" '/template/single-post",e.cachebuster&&(t+="?cachebuster="+e.cachebuster),t+="'",t+=' "></div>'},controller:"CacheCtrl as cacheCtrl"}).when("/:name",{template:function(e){var t='<div class="main-include" ssb-data-styles data-ng-include="';return t+=" '/template/"+e.name.toLowerCase(),e.cachebuster&&(t+="?cachebuster="+e.cachebuster),t+="'",t+=' "></div>'},controller:"CacheCtrl as cacheCtrl",reloadOnSearch:!1}).when("/cached/:page",{controller:"CacheCtrl as cacheCtrl",templateUrl:"../views/cache.html",reloadOnSearch:!1}).when("/preview/:pageId",{controller:"PreviewCtrl as previewCtrl",templateUrl:"../views/main.html",reloadOnSearch:!1}).when("/preview/:pageId/:postId",{controller:"PreviewCtrl as previewCtrl",templateUrl:"../views/main.html"}).when("/:name/:name_1",{template:function(e){var t='<div class="main-include" ssb-data-styles data-ng-include="';return t+=" '/template/"+e.name.toLowerCase()+"/"+e.name_1.toLowerCase(),e.cachebuster&&(t+="?cachebuster="+e.cachebuster),t+="'",t+=' "></div>'},controller:"CacheCtrl as cacheCtrl",reloadOnSearch:!1}).otherwise({template:function(e){window.location.pathname.length>1&&(e.name=window.location.pathname.substr(1));var t='<div class="main-include" ssb-data-styles data-ng-include="';return t+=" '/template/"+encodeURIComponent(e.name.toLowerCase()),e.cachebuster&&(t+="?cachebuster="+e.cachebuster),t+="'",t+=' "></div>'},controller:"CacheCtrl as cacheCtrl",reloadOnSearch:!1}),o.setPrefix("indi")}]).run(["$rootScope","$location","$anchorScroll","$routeParams","$document","$timeout","ipCookie","analyticsService",function(e,t,n,o,a,r,i,s){"use strict";var c,l=0===t.$$path.indexOf("/preview/"),d=window.location.search.indexOf("editor=true"),u=window.location.search.indexOf("newAnalytics=true");-1!=d||l||(u>=0?s.collect(null,function(){}):s.sessionStart(function(){})),e.app={isMobile:function(){var e=!1;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(e=!0),e}()},e.pageTitle=function(){return e.isSocialEnabled?window.indigenous&&window.indigenous.precache&&window.indigenous.precache.siteData&&window.indigenous.precache.siteData.post?window.indigenous.precache.siteData.post.post_title:void 0:e.title},e.$on("$routeChangeSuccess",function(){e.isSocialEnabled=-1!==t.absUrl().search(/\/blog\/.+/),-1!=d||l||(u>=0?s.collectPage(!0,function(){clearInterval(c);var e=0;c=setInterval(function(){s.collectPage(!1,function(){++e>=36e5&&clearInterval(c)})},3e4)}):s.pageStart(function(){s.pagePing(),clearInterval(c);var e=0;c=setInterval(function(){s.pagePing(),++e>=36e5&&clearInterval(c)},15e3)}))})}]).run(["$rootScope","$location",function(e,t){"use strict";e.$on("duScrollspy:becameActive",function(n,o){var a=o.prop("hash");a&&(t.hash(a.substr(1)).replace(),e.$apply())})}]).config(["$provide",function(e){"use strict";e.decorator("$exceptionHandler",["$delegate","$window",function(e,t){return function(n,o){t.trackJs&&t.trackJs.track(n),e(n,o)}}])}]);mainApp.constant("formValidations",{email:/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.([a-z]{2,})|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i,phone:/^\(?(\d{3})\)?[ .-]?(\d{3})[ .-]?(\d{4})$/,zip:/(^\d{5}$)|(^\d{5}-\d{4}$)/,extension:/^[0-9]*$/}),app.constant("externalScriptLookup",{'<script src="https://www.paypalobjects.com/js/external/dg.js" async><\/script>':["products","ssb-form-donate"],'<script src="https://www.paypalobjects.com/js/external/apdg.js" async><\/script>':["products","ssb-form-donate"],'<script src="https://js.stripe.com/v2/?tmp" async><\/script>':["products","ssb-form-donate","payment-form"],'<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDMI1SIOEHJm83bMZ-lWjzZN1nXdk6S0X0" async><\/script>':["contact-us","ssb-location-finder"]}),app.constant("nonShippingChargeStates",[{name:"Alabama",abbr:"AL"},{name:"Arizona",abbr:"AZ"},{name:"California",abbr:"CA"},{name:"Idaho",abbr:"ID"},{name:"Iowa",abbr:"IA"},{name:"Louisiana",abbr:"LA"},{name:"Maine",abbr:"ME"},{name:"Maryland",abbr:"MD"},{name:"Massachusetts",abbr:"MA"},{name:"Nevada",abbr:"NV"},{name:"Oklahoma",abbr:"OK"},{name:"Utah",abbr:"UT"},{name:"Virginia",abbr:"VA"},{name:"Wyoming",abbr:"WY"}]),app.constant("shippingStates",[{name:"Alabama",abbr:"AL"},{name:"Alaska",abbr:"AK"},{name:"Arizona",abbr:"AZ"},{name:"Arkansas",abbr:"AR"},{name:"California",abbr:"CA"},{name:"Colorado",abbr:"CO"},{name:"Connecticut",abbr:"CT"},{name:"Delaware",abbr:"DE"},{name:"District of Columbia",abbr:"DC"},{name:"Florida",abbr:"FL"},{name:"Georgia",abbr:"GA"},{name:"Hawaii",abbr:"HI"},{name:"Idaho",abbr:"ID"},{name:"Illinois",abbr:"IL"},{name:"Indiana",abbr:"IN"},{name:"Iowa",abbr:"IA"},{name:"Kansas",abbr:"KS"},{name:"Kentucky",abbr:"KY"},{name:"Louisiana",abbr:"LA"},{name:"Maine",abbr:"ME"},{name:"Maryland",abbr:"MD"},{name:"Massachusetts",abbr:"MA"},{name:"Michigan",abbr:"MI"},{name:"Minnesota",abbr:"MN"},{name:"Mississippi",abbr:"MS"},{name:"Missouri",abbr:"MO"},{name:"Montana",abbr:"MT"},{name:"Nebraska",abbr:"NE"},{name:"Nevada",abbr:"NV"},{name:"New Hampshire",abbr:"NH"},{name:"New Jersey",abbr:"NJ"},{name:"New Mexico",abbr:"NM"},{name:"New York",abbr:"NY"},{name:"North Carolina",abbr:"NC"},{name:"North Dakota",abbr:"ND"},{name:"Ohio",abbr:"OH"},{name:"Oklahoma",abbr:"OK"},{name:"Oregon",abbr:"OR"},{name:"Pennsylvania",abbr:"PA"},{name:"Rhode Island",abbr:"RI"},{name:"South Carolina",abbr:"SC"},{name:"South Dakota",abbr:"SD"},{name:"Tennessee",abbr:"TN"},{name:"Texas",abbr:"TX"},{name:"Utah",abbr:"UT"},{name:"Vermont",abbr:"VT"},{name:"Virginia",abbr:"VA"},{name:"Washington",abbr:"WA"},{name:"West Virginia",abbr:"WV"},{name:"Wisconsin",abbr:"WI"},{name:"Wyoming",abbr:"WY"}]),mainApp.controller("CacheCtrl",["$scope","$rootScope","embeddedSiteDataService","SsbPageSectionService","$window","$location","$document","$timeout",function(e,t,n,o,a,r,i,s){"use strict";e.isEditing=!1,e.blog_post=null;var c;e.addUnderNavSetting=function(t,n){var o={allowUndernav:!1,navComponent:null};e.components&&e.components.length>0?e.components.forEach(function(n,a){n&&"masthead"===n.type&&n._id==t&&e.components[a-1]&&(0!==a&&"navigation"===e.components[a-1].type?(o.allowUndernav=!0,o.navComponent=e.components[a-1]):o.allowUndernav=!1)}):e.sections&&e.sections.length>0&&e.sections.forEach(function(n,a){n.components.forEach(function(n){if(n&&"masthead"===n.type&&n._id==t&&e.sections[a-1]){var r=_.findWhere(e.sections[a-1].components,{type:"navigation"});0!==a&&void 0!==r?(o.allowUndernav=!0,o.navComponent=r):o.allowUndernav=!1}})}),n(o)},e.defaultSpacings={pt:0,pb:0,pl:0,pr:0,mt:0,mb:0,mr:"auto",ml:"auto",mw:"100%",usePage:!1},e.$on("getCurrentPage",function(t,n){n.currentpage=e.page}),e.components=[],n.getPageData(e.websiteId,function(n,l){if(e.$emit("external.scripts.page.data",{page:l}),n)"/login"===r.$$path?a.location.href="/login":a.location.reload();else{if(o.setSectionOffset(0),e.page=l,t.title=e.page.title,t.pageHandle=e.page.handle,e.sections=l.sections,_.each(l.sections,function(t,n){t&&("nav-hero"==t.layout&&void 0==c&&(c="section_"+t._id),!1===t.ssb?e.components=e.components.concat(t.components):e["sections_"+n]=t)}),_.each(e.components,function(t,n){e["components_"+n]=t}),"single-post"===l.handle){var d=_.findWhere(e.page.components,{type:"single-post"});d&&(e.blog_post=d)}angular.element(document).ready(function(){i.scrollTop(0),s(function(){if(r.$$hash)var t=e.$watch(function(){return document.getElementById(r.$$hash)||document.getElementById("section_"+r.$$hash)||document.getElementById("component_"+r.$$hash)},function(e,n){if(e&&!angular.equals(e,n)){t();var a=1e3;c&&(a=2e3),s(function(){var e=document.getElementById(r.$$hash);e||(e=document.getElementById("section_"+r.$$hash)),e||(e=document.getElementById("component_"+r.$$hash)),e&&i.scrollToElementAnimated(e,o.offset,1e3)},a)}});$(window).on("hashchange",function(){var e=$(":target");if(e.length>0){var t=document.getElementById(e.attr("id"));t||(t=document.getElementById("section_"+e.attr("id"))),t||(t=document.getElementById("component_"+e.attr("id"))),i.scrollTop(0),s(function(){i.scrollToElementAnimated(t,o.offset,1e3)},200)}})},0)});try{indigenous.ssbBlog||-1===r.path().toLowerCase().indexOf("blog")||_(indigenous.precache.siteData.pages).chain().each(function(e,t){if("index"===t&&e.ssb&&void 0!==_(e.sections).chain().findWhere({global:!0,version:5,type:"ssb-page-section",title:"Header"}).value()){$("head").append('<style type="text/css">.ssb-main .navigation-v2 .navbar {min-height: 0!important;}.ssb-main .navigation-v2 .navbar .navbar-header {display: none!important;}</style>')}}).value()}catch(e){}}})}]),mainApp.controller("MainCtrl",["$scope","ENV","$document","$window",function(e,t,n,o){"use strict";this.segmentIOWriteKey=t.segmentKey,e.init=function(t){e.websiteId=t},e.isSection=function(e){return"section"===e},e.orgId=o.indigenous.orgId,t.stripeKey=t.stripeKey[e.orgId]}]),mainApp.controller("NotFoundCtrl",["$scope","$window",function(e,t){"use strict";e.onResizeFunction=function(){e.windowHeight=t.innerHeight,e.windowWidth=t.innerWidth},e.onResizeFunction(),angular.element(t).bind("resize",function(){e.onResizeFunction(),e.$apply()})}]),mainApp.controller("PreviewCtrl",["$scope","$rootScope","previewPagesService","SsbPageSectionService","$window","$location","$document","$timeout",function(e,t,n,o,a,r,i,s){"use strict";function c(t){t.hideIntercom&&(e.$parent.hideIntercom=!0)}e.isEditing=!1,e.addUnderNavSetting=function(t,n){var o={allowUndernav:!1,navComponent:null};e.components&&e.components.length>0?e.components.forEach(function(n,a){n&&"masthead"===n.type&&n._id==t&&(0!==a&&"navigation"==e.components[a-1].type?(o.allowUndernav=!0,o.navComponent=e.components[a-1]):o.allowUndernav=!1)}):e.sections&&e.sections.length>0&&e.sections.forEach(function(n,a){n.components.forEach(function(n){if(n&&"masthead"===n.type&&n._id==t&&e.sections[a-1]){var r=_.findWhere(e.sections[a-1].components,{type:"navigation"});0!==a&&void 0!==r?(o.allowUndernav=!0,o.navComponent=r):o.allowUndernav=!1}})}),n(o)},e.defaultSpacings={pt:0,pb:0,pl:0,pr:0,mt:0,mb:0,mr:"auto",ml:"auto",mw:"100%",usePage:!1},n(e.websiteId,function(n,l){e.$emit("external.scripts.page.data",{page:l}),n?"/login"===r.$$path?a.location.href="/login":a.location.href="/404":s(function(){o.setSectionOffset(0),e.page=l,t.title=e.page.title,t.pageHandle=e.page.handle,e.sections=l.sections,c(l),angular.element(document).ready(function(){i.scrollTop(0),s(function(){if(r.$$hash){var e=document.getElementById(r.$$hash);e&&i.scrollToElementAnimated(e,0,1e3)}},3e3)})},500)})}]),angular.module("angular-parallax",[]).directive("parallax",["$window",function(e){"use strict";return{restrict:"A",scope:{parallaxRatio:"@",parallaxVerticalOffset:"@",parallaxHorizontalOffset:"@"},link:function(t,n){var o=function(){n.css("left",t.parallaxHorizontalOffset+"px");var o=e.pageYOffset*(t.parallaxRatio?t.parallaxRatio:1.1);if(o<=e.innerHeight){var a=o<t.parallaxVerticalOffset?t.parallaxVerticalOffset:o;n.css("top",a+"px")}};o(),angular.element(e).bind("scroll",o),angular.element(e).bind("touchmove",o)}}}]).directive("parallaxBackground",["$window","$timeout",function(e,t){return{restrict:"A",transclude:!0,template:"<div ng-transclude></div>",scope:{parallaxRatio:"@",parallaxVerticalOffset:"@",parallaxXPosition:"@"},link:function(n,o){o.addClass("opacity-0");var a=!0,r=function(e){var t=0;if(e.offsetParent)do{t+=e.offsetTop}while(e=e.offsetParent);return t},i=function(){var i=0,s="50%";if(n.parallaxXPosition&&("left"===n.parallaxXPosition&&(s="0%"),"center"===n.parallaxXPosition&&(s="50%"),"right"===n.parallaxXPosition&&(s="100%")),o.hasClass("parallax")){var c=$(window).width(),l=!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g);(c<750||l)&&(n.parallaxRatio=.02),i=(r(o[0])-e.pageYOffset)*(n.parallaxRatio?n.parallaxRatio:1.1),i-=0,o.css("background-position",s+" "+i+"px"),o.css("background-attachment","fixed")}else o.css("background-position",s+" "+i+"px"),o.css("background-attachment","inherit");a&&(t(function(){o.removeClass("opacity-0")},0),a=!1)};$(document).ready(function(){t(function(){i()},0)}),angular.element(e).bind("scroll",i),angular.element(e).bind("touchmove",i)}}}]),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",[function(){"use strict"}]).directive("carousel",[function(){"use strict";return{}}]),app.directive("blogTeaserComponent",["postsService","$filter",function(e,t){"use strict";return{scope:{component:"=",ssbEditor:"="},templateUrl:"/components/component-wrap.html",controller:["$scope","postsService",function(e,n){function o(n,o){var r=[];_.each(n,function(e){s(e)&&c(e)&&r.push(e)}),r=a(r);var i=0;return i=2==e.component.version?e.component.numberOfTotalPosts||e.teaserposts.length:e.component.numberOfTotalPosts||3,r=t("limitTo")(r,i),e.posts=r,o()}function a(n){var o=i(),a=r(e.component);return t("orderBy")(n,[a,"date_created"],o)}function r(e){return e.postorder?1==e.postorder||2==e.postorder?"date_modified":3==e.postorder||4==e.postorder?"date_created":5==e.postorder||6==e.postorder?"date_published":void 0:"date_published"}function i(){return 1!=e.component.postorder&&3!=e.component.postorder&&5!=e.component.postorder&&(2==e.component.postorder||4==e.component.postorder||e.component.postorder,!0)}function s(t){var n=e.component.postTags;return!(n&&n.length>0)||(!!(t.postfilerPoststags&&_.intersection(n,t.post_tags).length>0)||void 0)}function c(t){var n=e.component.postCategories;return!(n&&n.length>0)||(!!(t.post_categories&&_.intersection(n,_.pluck(t.post_categories,"text")).length>0)||void 0)}e.loading=!0,e.currentPostPage=1,n(function(t,n){_.each(n,function(e){e.date_published=new Date(e.publish_date||e.created.date).getTime(),e.date_created=new Date(e.created.date).getTime(),e.date_modified=new Date(e.modified.date).getTime()}),e.teaserposts=angular.copy(n),o(n,function(){e.pageChanged(1),e.loading=!1})}),e.listArticleStyle=function(e){var t=" ";return e&&e.articleBorder&&e.articleBorder.show&&e.articleBorder.color&&(t+="border-color: "+e.articleBorder.color+";",t+="border-width: "+e.articleBorder.width+"px;",t+="border-style: "+e.articleBorder.style+";",t+="border-radius: "+e.articleBorder.radius+"%;"),t},e.titleStyle=function(e){var t=" ";return e&&e.settings&&e.settings.title&&(e.settings.title.fontSize&&(t+="font-size: "+e.settings.title.fontSize+"px !important;"),e.settings.title.fontFamily&&(t+="font-family: "+e.settings.title.fontFamily+"px !important;"),e.settings.title.color&&(t+="color: "+e.settings.title.color+"!important;")),t},e.descriptionStyle=function(e){var t=" ";return e&&e.settings&&e.settings.description&&(e.settings.description.fontSize&&(t+="font-size: "+e.settings.description.fontSize+"px !important;"),e.settings.description.fontFamily&&(t+="font-family: "+e.settings.description.fontFamily+"px !important;"),e.settings.description.color&&(t+="color: "+e.settings.description.color+"!important;")),t},e.pageChanged=function(t){if(e.currentPostPage=t,e.posts&&e.component.numberOfPostsPerPage){var n,o=(e.currentPostPage-1)*e.component.numberOfPostsPerPage,a=e.component.numberOfPostsPerPage;0===a&&(a=e.posts.length),n=o+a,e.filteredPosts=e.posts.slice(o,n)}else e.filteredPosts=e.posts}}]}}]),app.directive("blogComponent",["postsService","$filter","$location","$timeout",function(e,t,n,o){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",controller:["$scope","postsService",function(e,a){e.blog={},e.showCloud=!1,e.component.spacing=e.$parent.defaultSpacings;var r=n.$$path.replace("/page/","");a(function(t,n){e.blog.blogposts=n,e.blog.postTags=[],e.blog.categories=[],_.each(n,function(t){r.indexOf("tag/")>-1&&(e.blog.currentTag=r.replace("/tag/",""),e.blog.blogposts=_.filter(e.blog.blogposts,function(t){if(t.post_tags)return t.post_tags.indexOf(e.blog.currentTag)>-1})),r.indexOf("category/")>-1&&(e.blog.currentCat=r.replace("/category/",""),e.blog.blogposts=_.filter(e.blog.blogposts,function(t){return t.post_category===e.blog.currentCat})),r.indexOf("author/")>-1&&(e.blog.currentAuthor=r.replace("/author/",""),e.blog.blogposts=_.filter(e.blog.blogposts,function(t){return t.post_author===e.blog.currentAuthor})),t.post_tags&&_.each(t.post_tags,function(t){e.blog.postTags.indexOf(t)<=-1&&e.blog.postTags.push(t)}),t.post_category&&e.blog.categories.indexOf(t.post_category)<=-1&&e.blog.categories.push(t.post_category)}),$(document).ready(function(){o(function(){e.activateTagCloud(e.blog.postTags)},500)})}),e.activateTagCloud=function(t){var n=[];_.each(t,function(e){var o=2,a=_.countBy(_.flatten(t),function(t){return t==e}).true;a&&(o+=a),n.push({text:e,weight:o,link:"/tag/"+e})}),e.rendered=!1,e.tagCloud=n,$(".jqcloud").jQCloud(e.tagCloud,{autoResize:!0,width:230,height:300,afterCloudRender:function(){o(function(){angular.element(".jqcloud").css({width:"100%"})},100)}})},e.curPage=0,e.pageSize=10,e.numberOfPages=function(){return e.blog.blogposts?Math.ceil(e.blog.blogposts.length/e.pageSize):0},e.sortBlogFn=function(e){return function(n){return e.postorder?1==e.postorder||2==e.postorder?Date.parse(t("date")(n.modified.date,"MM/dd/yyyy HH:mm:ss")):3==e.postorder||4==e.postorder?Date.parse(t("date")(n.created.date,"MM/dd/yyyy HH:mm:ss")):5==e.postorder||6==e.postorder?Date.parse(t("date")(n.publish_date||n.created.date,"MM/dd/yyyy")):void 0:Date.parse(t("date")(n.publish_date||n.created.date,"MM/dd/yyyy"))}},e.customSortOrder=function(e){return 1!=e.postorder&&3!=e.postorder&&5!=e.postorder&&(2==e.postorder||4==e.postorder||e.postorder,!0)}}]}}]),app.directive("comingSoonComponent",function(){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html"}}),app.directive("contactUsComponent",["geocodeService","accountService","$timeout",function(e,t,n){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(o){o.reloadMap=function(){o.$watch("map",function(e){e&&(google.maps.event.trigger(o.map,"resize"),o.map.setCenter(new google.maps.LatLng(o.component.location.lat,o.component.location.lon)))})},angular.isDefined(o.component.bg)||(o.component.bg={}),angular.isDefined(o.component.bg.img)||(o.component.bg.img={}),angular.isDefined(o.component.bg.img.show)||(o.component.bg.img.show=!1),o.component.boxColor&&(o.boxColor=function(e,t){var n;return t=angular.isDefined(t)?t:1,3===(n=e.substring(1).split("")).length&&(n=[n[0],n[0],n[1],n[1],n[2],n[2]]),n="0x"+n.join(""),"rgba("+[n>>16&255,n>>8&255,255&n].join(",")+","+t+")"}(o.component.boxColor,o.component.boxOpacity)),o.updateContactUsAddress=function(){o.component.location.lat&&o.component.location.lon?n(function(){o.reloadMap()},500):e.validateAddress(o.component.location,function(t,a){t&&1===a.length?(o.component.location.lat=a[0].geometry.location.lat(),o.component.location.lon=a[0].geometry.location.lng(),n(function(){o.reloadMap()},500)):o.contactAddress&&e.getGeoSearchAddress(o.contactAddress,function(e){e.lat&&e.lon&&(o.component.location.lat=e.lat,o.component.location.lon=e.lon,n(function(){o.reloadMap()},500))})})},o.$on("mapInitialized",function(e,t){o.map=t,google.maps.event.trigger(o.map,"resize")}),o.setAddress=function(){return o.contactAddress=e.stringifyAddress(o.component.location,!0),o.contactAddress},o.component.custom||(o.component.custom={hours:!0,address:!0}),o.setBusinessDetails=function(e,t,n){e?t.business.addresses&&t.business.addresses.length>-1&&(o.component.location=t.business.addresses[0]):t.business.hours&&(o.component.hours=t.business.hours,o.component.splitHours=t.business.splitHours),n()},o.calcMaxWidth=function(e){var t=angular.element("."+e);if(t.length)return t.width()-100-50+"px"};var a=o.$watch(function(){return"object"==typeof google&&"object"==typeof google.maps},function(e,n){e&&(o.mapLoaded=!0,t(function(e,t){o.component.custom.hours||o.setBusinessDetails(!1,t,function(){}),(o.component.location.address||o.component.location.address2||o.component.location.city||o.component.location.state||o.component.location.zip)&&o.component.custom.address?o.updateContactUsAddress():o.setBusinessDetails(!0,t,function(){o.updateContactUsAddress()})}),a())})}}}]),app.directive("featureBlockComponent",function(){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html"}}),app.directive("featureListComponent",[function(){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(e){e.features={featureIndex:0},e.loading=!0,e.listStyles=function(e,t){var n,o=" ";return t&&((n=$(".list-features-"+e._id+" li.active .fr-view span:not('.fr-marker'):not('.fr-placeholder'):not(:empty):last").css("color"))||(n=$(".list-features-"+e._id+" li.active").css("color")),o+="border-bottom: 1px solid "+n+";"),o},e.featureClass=function(){var t=e.component.anchor||e.component._id,n=angular.element("#"+t+" div.features-wrap");return n.width()<768?"feature-xs-width":n.width()<992?"feature-sm-width":""},e.featureStyle=function(e){var t=" ";return e&&e.blockBorder&&e.blockBorder.show&&e.blockBorder.color&&(t+="border-color: "+e.blockBorder.color+";",t+="border-width: "+e.blockBorder.width+"px;",t+="border-style: "+e.blockBorder.style+";",t+="border-radius: "+e.blockBorder.radius+"%;"),e.blockbgcolor&&(t+="background: "+e.blockbgcolor),t},e.setSelectedFeatureIndex=function(t){e.loading=!0,e.features.featureIndex=t,e.loading=!1;var n=angular.element("#"+e.component._id+" .feature-tab-content .col-md-5 img");angular.forEach(n,function(e){var t=angular.element(e).attr("src");t&&angular.element(e).wrap('<a href="'+t+'" title="Project A" data-gallery=""></a>')})},e.setStyles=function(e){var t=" ";return e&&("left"===e.align||"right"===e.align?t+="float: "+e.align+" !important;":"center"===e.align&&(t+="margin: 0 auto !important; float:none !important;")),t},e.updateFeatureClass=function(t,n){var o=!0;return t&&t["features[features/featureIndex]/media"]&&t["features[features/featureIndex]/media"][n]&&!1===t["features[features/featureIndex]/media"][n].visibility&&(o=!1),o&&e.component.features[n].media&&-1===e.component.features[n].media.indexOf("width: 0px")}}}}]),app.directive("footerComponent",["$window","websiteService","$location",function(e,t,n){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(o,a){o.orgId=e.indigenous.orgId,o.component.spacing=o.$parent.defaultSpacings;var r=n.$$host,i="//www.indigenous.io";1==o.orgId?i="//www.gorvlvr.com":4==o.orgId&&(i="//techevent.us"),o.footerLinkUrl=i+"?utm_source="+r+"&utm_medium=footer_link",t(function(e,t){e||(o.website=t,o.copyright={year:(new Date).getFullYear()},o.copyrightYear=(new Date).getFullYear())}),a.parents(".ssb-section-layout").length||a.addClass("legacy-footer")}}}]),app.directive("imageGalleryComponent",function(){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(e){e.touchMove=!0,e.draggable=!0,e.autoplay=!0,e.dataLoaded=!0}}}),app.directive("imageTextComponent",function(){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html"}}),app.directive("mastheadComponent",["$window","$timeout",function(e,t){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(n){n.component.bg&&n.component.bg.img&&n.component.bg.img.url&&n.component.bg.img.show&&n.component.bg.img.undernav&&(n.addUndernavClasses=!0),angular.element("body").on("click",".navbar-toggle",function(){n.setUnderbnavMargin()}),angular.element(document).ready(function(){t(function(){n.setUnderbnavMargin()},0)}),angular.element(e).bind("resize",function(){n.setUnderbnavMargin()}),n.setUnderbnavMargin=function(){for(var o=10,a=n.$parent;!a.addUnderNavSetting&&o>0;)a=a.$parent,o--;a.addUnderNavSetting&&a.addUnderNavSetting(n.component._id,function(e){n.allowUndernav=e.allowUndernav,n.navComponent=e.navComponent}),t(function(){var t=angular.element(".component_wrap_"+n.component._id+".undernav200"),o=angular.element(".masthead_"+n.component._id+".mastHeadUndernav");if(n.addUndernavClasses&&n.allowUndernav){var a=angular.element(".undernav").height();n.navComponent&&(a=angular.element(".component_wrap_"+n.navComponent._id+".undernav").height());var r=a,i=!0;t&&(t.css("margin-top",-r),n.allowFullScreen&&t.css("height",e.innerHeight+a)),angular.element(".undernav").addClass("nav-undernav"),n.navComponent&&n.navComponent.bg&&n.navComponent.bg.img&&!n.navComponent.bg.img.show&&n.navComponent.bg.color&&(i=!1),i?angular.element(".nav-undernav .bg").addClass("bg-nav-undernav"):angular.element(".nav-undernav .bg").removeClass("bg-nav-undernav"),angular.element(".undernav").closest("li.fragment").addClass("li-nav-undernav"),angular.element(".undernav").closest("section").addClass("unset"),o&&o.css("height",r),angular.element(".masthead-actions")&&angular.element(".masthead-actions").css("margin-top",r-4),$(window).trigger("scroll")}else t&&t.css("margin-top",0),angular.element(".masthead-actions")&&angular.element(".masthead-actions").css("margin-top",0)},300)}}}}]),app.directive("meetTeamComponent",[function(){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(e){e.teamClass=function(){var t=e.component.anchor||e.component._id,n=angular.element("#"+t+" div.team-member-wrap");return n.width()<768?"team-xs-width":n.width()<992?"team-sm-width":""},e.gotoPage=function(e){if(e.joinOurTeam){window.location="https://indigenous.io/careers"}}}}}]),app.directive("navigationComponent",["websiteService","accountService","$timeout",function(e,t,n){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",controller:["$scope","websiteService","accountService","SsbPageSectionService",function(e,t,o,a){e.navbarId=_.random(0,1e3),e.website={},window.indigenous&&window.indigenous.precache&&window.indigenous.precache.siteData&&window.indigenous.precache.siteData.linkList&&(e.website.linkLists=window.indigenous.precache.siteData.linkList,n(function(){$(window).trigger("resize")},0)),angular.isDefined(e.component.shownavbox)||(e.component.shownavbox=!0),e.website.linkLists||t(function(t,o){e.website=o,n(function(){$(window).trigger("resize")},0)}),o(function(t,n){e.account=n});var r={},i={};e.$emit("getCurrentPage",r),e.currentpage=r.currentpage,!e.currentpage||"blog-list"!==e.currentpage.handle&&"blog-post"!==e.currentpage.handle||(e.currentpage.handle="blog"),e.$watchCollection(function(){return a.offset},function(t){e.scrollOffsetTop=t}),window.indigenous&&window.indigenous.precache&&window.indigenous.precache.siteData&&window.indigenous.precache.siteData.pages&&(i=window.indigenous.precache.siteData.pages),e.checkIfReloadPage=function(e){if(e&&e.data){if("blog"===e.data)return!0;if(i&&i[e.data]&&i[e.data].isBlogCopy)return!0}return!1}}]}}]),app.directive("paymentFormComponent",["$filter","$q","productService","paymentService","userService","commonService","ipCookie","formValidations","$location",function(e,t,n,o,a,r,i,s,c){"use strict";return{require:[],scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(e){e.newAccount={email:""};var n=function(t){e.loading=!1,window.location=t},l=function(e,t){angular.element("#"+e+" .error").html(t),angular.element("#"+e).addClass("has-error"),angular.element("#"+e+" .glyphicon").addClass("glyphicon-remove")},d=function(e){angular.element("#"+e+" .error").html(""),angular.element("#"+e).removeClass("has-error").addClass("has-success"),angular.element("#"+e+" .glyphicon").removeClass("glyphicon-remove").addClass("glyphicon-ok")};e.buttonDisabled=!1,2===e.component.version?(e.newAccount.plan=e.component.productIds.ALLINONE,e.newAccount.addSignupFee=!0):3===e.component.version&&(e.newAccount.plan=e.component.productIds.RVLVRPLAN),e.emailValidation=s.email,e.havingNetworkIssue=!1,e.emptyBusinessName=!1,e.validBusinessName=!0,e.dotComExt=!1,a.getTmpAccount(function(t){e.tmpAccount=t;var n=t;e.newAccount.hidePassword=!1,n.tempUser?(n.tempUser.email&&(e.newAccount.email=n.tempUser.email,e.newAccount.tempUserId=n.tempUser._id,e.newAccount.hidePassword=!0),"tw"===n.tempUser.credentials[0].type&&(e.newAccount.hidePassword=!0),n.tempUser.businessName&&(e.newAccount.businessName=n.tempUser.businessName),n.tempUser.profilePhotos&&n.tempUser.profilePhotos.length&&(e.newAccount.profilePhoto=n.tempUser.profilePhotos[0])):a.saveOrUpdateTmpAccount(n,function(){})}),e.isAdmin=function(){return e.isAdmin},e.showExtension="",e.$watch("newAccount.phone",function(t){e.showExtension=void 0!==t&&""!==t}),e.$watch("newAccount.fullName",function(t){if(void 0!==t){var n=t.match(/\S+/g);n?n.length>=3?(e.newAccount.first=n[0],e.newAccount.last=n[2]):2===n.length?(e.newAccount.first=n[0],e.newAccount.last=n[1]):1===n.length&&(e.newAccount.first=n[0],e.newAccount.last=""):(e.newAccount.first="",e.newAccount.last="")}},!0),e.removeAccount=function(){e.newAccount.businessName=null,e.newAccount.profilePhoto=null,e.newAccount.tempUserId=null,e.newAccount.email=null,e.tmpAccount.tempUser=null,e.newAccount.hidePassword=!1},e.makeSocailAccount=function(t){if(t){var n="/signup/"+t+"?redirectTo=/signup";return e.newAccount.coupon&&(n=n+"?coupon="+e.poulateCoupon),void(window.location.href=n)}},e.showFooter=function(e){e?angular.element("#footer").show():angular.element("#footer").hide()},e.createAccount=function(t){1===e.component.version?e.createAccountVersion1(t):2===e.component.version?e.createAccountVersion2(t):3===e.component.version&&e.createAccountV3(t)},e.createAccountV3=function(t){if(e.validateFormV3()){var r=e.tmpAccount;r.subdomain=$.trim(t.businessName).replace(/ /g,"").replace(/\./g,"_").replace(/@/g,"").replace(/_/g," ").replace(/\W+/g,"").toLowerCase(),r.business=r.business||{},r.business.name=t.businessName,a.checkDomainExists(t.businessName,function(s,d){s&&(e.isFormValid=!1,e.showFooter(!0)),d&&"false"!==d?(e.requiredFieldsFilled=!0,e.showFooter(!1),e.loading=!0,e.isFormValid=!0,a.saveOrUpdateTmpAccount(r,function(r){var s={username:t.email,password:t.password,email:t.email,accountToken:r.token,coupon:t.coupon,first:t.first,middle:t.middle,last:t.last,existingUser:t.existingUser,orgId:1};o.getStripeCardToken(t.card,function(t,o){if(o)switch(e.$apply(function(){e.isFormValid=!1,e.showFooter(!0),e.loading=!1}),o.param){case"number":l("card_number",o.message);break;case"exp_year":l("card_expiry",o.message);break;case"cvc":l("card_cvc",o.message);break;case"exp_month":l("card_expiry",o.message);break;default:l("card_number",o.message)}else s.cardToken=t,s.plan=e.newAccount.plan,s.anonymousId=window.analytics?window.analytics.user().anonymousId():null,s.permanent_cookie=i("permanent_cookie"),s.fingerprint=(new Fingerprint).get(),s.setupFee=15e4,a.initializeUser(s,function(t,o){if(o&&o.accountUrl)if("indigenous.io"===c.host()||"www.indigenous.io"===c.host()){var a=CryptoJS.HmacSHA256(s.email,"vZ7kG_bS_S-jnsNq4M2Vxjsa5mZCxOCJM9nezRUQ");if(window.intercomSettings={name:s.username,email:s.email,user_hash:a.toString(CryptoJS.enc.Hex),created_at:Math.floor(Date.now()/1e3),app_id:"b3st2skm"},window._fbq=window._fbq||[],window._fbq.push(["track","6032779610613",{value:"0.00",currency:"USD"}]),"undefined"==typeof _gaw){var r,i=document.createElement("script");i.type="text/javascript",i.innerText='var google_conversion_id = 941009161;var google_conversion_language = "en";var google_conversion_format = "3";var google_conversion_color = "ffffff";var google_conversion_label = "eRTgCNSRo2EQidLawAM";var google_remarketing_only = false;',document.getElementsByTagName("head")[0].appendChild(i),(r=document.createElement("script")).onload=function(){n(o.accountUrl)},r.type="text/javascript",r.src="//www.googleadservices.com/pagead/conversion.js",document.getElementsByTagName("head")[0].appendChild(r)}}else n(o.accountUrl);else e.isFormValid=!1,e.loading=!1,"card_declined"===t.message?l("card_number","There was an error charging your card."):"incorrect_cvc"===t.message?l("card_cvc","Your card's security code is incorrect"):l("card_number",t.message),e.showFooter(!0)})})})):(e.isFormValid=!1,e.showFooter(!0),e.requiredFieldsFilled=!1)})}else e.requiredFieldsFilled=!1},e.validateFormV3=function(){e.isFormValid=!1;var t=!0;return e.newAccount.email||(e.checkEmailExists(e.newAccount),t=!1),e.checkPasswordLength(e.newAccount),e.newAccount.password||e.newAccount.tempUserId||e.newAccount.hidePassword||(t=!1),!e.newAccount.hidePassword&&e.newAccount.password&&(e.passwordIsValid||(t=!1)),e.newAccount.businessName||(e.checkDomainExists(e.newAccount),t=!1),e.newAccount.card={number:angular.element("#number").val(),cvc:angular.element("#cvc").val(),exp_month:parseInt(angular.element("#expiry").val().split("/")[0]),exp_year:parseInt(angular.element("#expiry").val().split("/")[1])},e.newAccount.card.number&&e.newAccount.card.cvc&&e.newAccount.card.exp_month&&e.newAccount.card.exp_year||(e.checkCardNumber(),e.checkCardExpiry(),e.checkCardCvv(),t=!1),e.checkCoupon(),e.couponIsValid||(t=!1),!!t},e.createAccountVersion2=function(t){if(e.validateFormVersion2()){e.buttonDisabled=!0;var r=e.tmpAccount;r.subdomain=$.trim(t.businessName).replace(/ /g,"").replace(/\./g,"_").replace(/@/g,"").replace(/_/g," ").replace(/\W+/g,"").toLowerCase(),r.business=r.business||{},r.business.name=t.businessName,a.checkDomainExists(t.businessName,function(s,d){s&&(e.buttonDisabled=!1,e.isFormValid=!1,e.showFooter(!0)),d&&"false"!==d?(e.requiredFieldsFilled=!0,e.showFooter(!1),e.loading=!0,e.isFormValid=!0,a.saveOrUpdateTmpAccount(r,function(r){var s={username:t.email,password:t.password,email:t.email,accountToken:r.token,coupon:t.coupon,first:t.first,middle:t.middle,last:t.last,existingUser:t.existingUser};o.getStripeCardToken(t.card,function(o,r){if(r)switch(e.buttonDisabled=!1,e.$apply(function(){e.isFormValid=!1,e.buttonDisabled=!1,e.showFooter(!0),e.loading=!1}),r.param){case"number":l("card_number",r.message);break;case"exp_year":l("card_expiry",r.message);break;case"cvc":l("card_cvc",r.message);break;case"exp_month":l("card_expiry",r.message);break;default:l("card_number",r.message)}else e.buttonDisabled=!1,s.cardToken=o,s.plan=e.newAccount.plan,s.anonymousId=window.analytics?window.analytics.user().anonymousId():null,s.permanent_cookie=i("permanent_cookie"),s.fingerprint=(new Fingerprint).get(),s.setupFee=0,!0===t.addSignupFee&&(s.setupFee=15e4),a.initializeUser(s,function(t,o){if(o&&o.accountUrl)if("indigenous.io"===c.host()||"www.indigenous.io"===c.host()){var a=CryptoJS.HmacSHA256(s.email,"vZ7kG_bS_S-jnsNq4M2Vxjsa5mZCxOCJM9nezRUQ");if(window.intercomSettings={name:s.username,email:s.email,user_hash:a.toString(CryptoJS.enc.Hex),created_at:Math.floor(Date.now()/1e3),app_id:"b3st2skm"},window._fbq=window._fbq||[],window._fbq.push(["track","6032779610613",{value:"0.00",currency:"USD"}]),"undefined"==typeof _gaw){var r,i=document.createElement("script");i.type="text/javascript",i.innerText='var google_conversion_id = 941009161;var google_conversion_language = "en";var google_conversion_format = "3";var google_conversion_color = "ffffff";var google_conversion_label = "eRTgCNSRo2EQidLawAM";var google_remarketing_only = false;',document.getElementsByTagName("head")[0].appendChild(i),(r=document.createElement("script")).onload=function(){n(o.accountUrl)},r.type="text/javascript",r.src="//www.googleadservices.com/pagead/conversion.js",document.getElementsByTagName("head")[0].appendChild(r)}}else n(o.accountUrl);else e.isFormValid=!1,e.buttonDisabled=!1,e.loading=!1,"card_declined"===t.message?l("card_number","There was an error charging your card."):"incorrect_cvc"===t.message?l("card_cvc","Your card's security code is incorrect"):l("card_number",t.message),e.showFooter(!0)})})})):(e.isFormValid=!1,e.buttonDisabled=!1,e.showFooter(!0),e.requiredFieldsFilled=!1)})}else e.requiredFieldsFilled=!1},e.validateFormVersion2=function(){e.isFormValid=!1;var t=!0;return e.newAccount.email||(e.checkEmailExists(e.newAccount),t=!1),e.checkPasswordLength(e.newAccount),e.newAccount.password||e.newAccount.tempUserId||e.newAccount.hidePassword||(t=!1),!e.newAccount.hidePassword&&e.newAccount.password&&(e.passwordIsValid||(t=!1)),e.newAccount.businessName||(e.checkDomainExists(e.newAccount),t=!1),e.newAccount.card={number:angular.element("#number").val(),cvc:angular.element("#cvc").val(),exp_month:parseInt(angular.element("#expiry").val().split("/")[0]),exp_year:parseInt(angular.element("#expiry").val().split("/")[1])},e.newAccount.card.number&&e.newAccount.card.cvc&&e.newAccount.card.exp_month&&e.newAccount.card.exp_year||(e.checkCardNumber(),e.checkCardExpiry(),e.checkCardCvv(),t=!1),e.checkCoupon(),e.couponIsValid||(t=!1),t},e.createAccountVersion1=function(t){if(e.isFormValid=!1,e.showFooter(!0),e.newAccount.email)if(e.newAccount.password||e.newAccount.tempUserId||e.newAccount.hidePassword)if(e.newAccount.businessName){e.isFormValid=!0,e.showFooter(!1);var n=e.tmpAccount;n.subdomain=$.trim(t.businessName).replace(/ /g,"").replace(/\./g,"_").replace(/@/g,"").replace(/_/g," ").replace(/\W+/g,"").toLowerCase(),n.business=n.business||{},n.business.name=t.businessName,a.saveOrUpdateTmpAccount(n,function(n){var o={username:t.email,password:t.password,email:t.email,accountToken:n.token,coupon:t.coupon};o.anonymousId=window.analytics.user().anonymousId(),o.permanent_cookie=i("permanent_cookie"),o.fingerprint=(new Fingerprint).get(),a.initializeUser(o,function(t,n){if(n&&n.accountUrl)if("indigenous.io"===c.host()||"www.indigenous.io"===c.host()){var a=CryptoJS.HmacSHA256(o.email,"vZ7kG_bS_S-jnsNq4M2Vxjsa5mZCxOCJM9nezRUQ");if(window.intercomSettings={name:o.username,email:o.email,user_hash:a.toString(CryptoJS.enc.Hex),created_at:Math.floor(Date.now()/1e3),app_id:"b3st2skm"},window._fbq=window._fbq||[],window._fbq.push(["track","6032779610613",{value:"0.00",currency:"USD"}]),!_gaw.loaded){var r=document.createElement("script");r.type="text/javascript",r.innerText='var google_conversion_id = 941009161;var google_conversion_language = "en";var google_conversion_format = "3";var google_conversion_color = "ffffff";var google_conversion_label = "eRTgCNSRo2EQidLawAM";var google_remarketing_only = false;',document.getElementsByTagName("head")[0].appendChild(r);var i=document.createElement("script");i.type="text/javascript",i.src="//www.googleadservices.com/pagead/conversion.js",document.getElementsByTagName("head")[0].appendChild(i),_gaw.loaded=!0}window.location=n.accountUrl}else window.location=n.accountUrl;else e.isFormValid=!1,e.showFooter(!0)})})}else e.checkDomainExists(t);else e.checkPasswordLength(t);else e.checkEmailExists(t)},e.loading=!1,e.createAccountWithoutCC=function(n){e.loading||(e.isFormValid=!1,e.validateForm=!0,e.loading=!0,e.promises=[],e.showFooter(!0),e.checkEmailExists(n,!0),e.checkPhoneExtension(n),e.newAccount.password||e.newAccount.tempUserId||e.newAccount.hidePassword||(e.checkPasswordLength(n),e.validateForm=!1,e.loading=!1),e.checkDomainExists(n),e.validBusinessName||(e.validateForm=!1,e.loading=!1),e.newAccount.hidePassword||(e.checkPasswordLength(n),e.passwordIsValid||(e.validateForm=!1,e.loading=!1)),e.validateForm&&(e.checkCoupon(),e.couponIsValid&&e.promises.length&&t.all(e.promises).then(function(t){if(_.each(t,function(t,n){0===n&&e.validateEmail(t.data)}),e.validateForm){e.isFormValid=!0,e.loading=!1,e.showFooter(!1);var o=e.tmpAccount;o.subdomain=$.trim(n.businessName).replace(/ /g,"").replace(/\./g,"_").replace(/@/g,"").replace(/_/g," ").replace(/\W+/g,"").toLowerCase(),o.business=o.business||{},o.business.name=n.businessName,o.signupPage=c.path(),e.newAccount.phone&&(o.business.phones=[],o.business.phones[0]={_id:r.generateUniqueAlphaNumericShort(),number:e.newAccount.phone,extension:e.newAccount.extension,default:!0}),a.saveOrUpdateTmpAccount(o,function(t){var o={username:n.email,password:n.password,email:n.email,accountToken:t.token,coupon:n.coupon,first:n.first,middle:n.middle,last:n.last,campaignId:e.component.campaignId,existingUser:n.existingUser};o.plan="",window.analytics&&window.analytics.user?o.anonymousId=window.analytics.user().anonymousId():o.anonymousId="",o.permanent_cookie=i("permanent_cookie"),o.fingerprint=(new Fingerprint).get();var r=$("#card_name #name").val();if(r){var s=r.split(" ");3===s.length?(o.first=s[0],o.middle=s[1],o.last=s[2]):2===s.length?(o.first=s[0],o.last=s[1]):1===s.length&&(o.last=s[0])}a.initializeUser(o,function(t,n){n&&n.accountUrl?"indigenous.io"===c.host()||"www.indigenous.io"===c.host()?(window._fbq=window._fbq||[],window._fbq.push(["track","6032779610613",{value:"0.00",currency:"USD"}]),window.location=n.accountUrl):window.location=n.accountUrl:(e.isFormValid=!1,e.showFooter(!0))})})}}).catch(function(t){e.loading=!1})))},e.validateBusinessName=function(t){t?(e.validateForm=!1,e.loading=!1,e.validBusinessName=!1):(e.validBusinessName=!0,e.validateForm=!0)},e.validateEmail=function(t,n){!0===t?(e.loading=!1,n&&(n.hidePassword=!0,n.existingUser=!0),l("email","You will be able to log in to this account with your existing credentials."),angular.element("#email").addClass("has-success"),angular.element("#email .glyphicon").addClass("glyphicon-ok")):(e.validateForm=!0,n&&(n.hidePassword=!1,n.existingUser=!1),d("email"))},e.checkDomainExists=function(t){if(e.havingNetworkIssue=!1,t.businessName){e.emptyBusinessName=!1;var n=$.trim(t.businessName);new RegExp("\\b.com\\b").test(n)&&(e.dotComExt=!0),n=n.replace(/ /g,"").replace(/\./g,"_").replace(/@/g,"").replace(/_/g," ").replace(/\W+/g,"").toLowerCase(),t.businessName=n,a.checkDomainExists(n,function(t,n){t&&(e.isFormValid=!1,e.showFooter(!0)),n?(e.domainExistsAlready="false"===n,e.validateBusinessName(e.domainExistsAlready)):(e.isFormValid=!1,e.showFooter(!0),e.havingNetworkIssue=!0)})}else e.validBusinessName=!1,e.emptyBusinessName=!0},e.checkEmailExists=function(t,n){e.newAccount.email=t.email,t.email?n?e.promises.push(a.checkDuplicateEmail(t.email)):a.checkEmailExists(t.email,function(n){e.validateEmail(n,t)}):(l("email","Valid Email Required"),e.validateForm=!1,e.loading=!1)},e.checkFirstName=function(t){e.newAccount.first=t.first,t.first?d("first"):l("first","First Name Required")},e.checkLastName=function(t){e.newAccount.last=t.last,t.last?d("last"):l("last","Last Name Required")},e.checkPhone=function(t){e.newAccount.phone=t.phone,t.phone?d("phone"):l("phone","Phone Required")},e.checkPasswordLength=function(t){!t.password||t.password.length<6?(l("password",""),e.passwordIsValid=!1):(d("password"),e.passwordIsValid=!0)},e.checkPhoneExtension=function(t){e.newAccount.extension=t.extension,s.extension.test(t.extension)||!t.extension?d("extension"):l("extension","Enter a valid extension")},e.checkMembership=function(e){e.membership},e.checkCardNumber=function(){angular.element("#number").val()?d("card_number"):l("card_number","Card Number Required")},e.checkCardExpiry=function(){var e,t=angular.element("#expiry").val(),n=t.split("/"),o=n[0].trim();n.length>1&&(e=n[1].trim()),t&&o&&e?d("card_expiry"):t?o?e||l("card_expiry","Expiry Year Required"):l("card_expiry","Expiry Month Required"):l("card_expiry","Expiry Required")},e.checkCardCvv=function(){angular.element("#cvc").val()?d("card_cvc"):l("card_cvc","CVC Required")},e.checkCoupon=function(){e.couponChecked=!0,e.checkingCoupon=!0;var t=e.newAccount.coupon;t?o.validateIndigenousCoupon(t,function(n){e.currentCoupon=n,e.checkingCoupon=!1,n.id&&n.id===t?(angular.element("#coupon-name .error").html(""),e.couponIsValid=!0):(angular.element("#coupon-name .error").html("Invalid Coupon"),e.couponIsValid=!1)}):(e.couponIsValid=!0,e.checkingCoupon=!1,d("coupon-name"))},e.checkCardName=function(){$("#card_name #name").val()&&d("card_name")},c.search().coupon&&(e.poulateCoupon=angular.copy(c.search().coupon),e.newAccount.coupon=e.poulateCoupon,e.checkCoupon()),c.search().email&&(e.poulateEmail=angular.copy(c.search().email),e.newAccount.email=e.poulateEmail,e.checkEmailExists(e.newAccount))}}}]),app.directive("pricingTablesComponent",function(){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html"}}),app.directive("productsComponent",["$timeout","paymentService","productService","accountService","CartDetailsService","userService","orderService","formValidations","$routeParams","$location","ENV","$sce","localStorageService","$modal","shippingStates","$filter",function(e,t,n,o,a,r,i,s,c,l,d,u,p,m,g,h){return{require:[],scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(r,f){function v(e){var t=new RegExp("[\\?&]tags=([^&#]*)"),n=r.component.productTags,o=t.exec(location.search);if(o&&o.length>1&&(n=_.union(n,o[1].split("-"))),!(n&&n.length>0))return!0;if(n=_.map(n,function(e){return e.toLowerCase()}),e.tags){var a=_.map(e.tags,function(e){return e.toLowerCase()});if(_.intersection(n,a).length>0)return!0}}function b(e,t){var n=[];_.each(e,function(e){v(e)&&(a.checkOnSale(e)?(e.onSaleToday=!0,e.actualSalesPrice=e.sale_price):e.actualSalesPrice=e.regular_price,n.push(e))});var o=_.filter(n,function(e){return"DONATION"!==e.type});if(r.productSortOrder.order){var i="created.date",s=!0;"price_low"==r.productSortOrder.order?(i="actualSalesPrice",s=!1):"price_high"==r.productSortOrder.order&&(i="actualSalesPrice",s=!0),r.products=h("orderBy")(o,[i,"created.date"],s)}else r.products=o;t&&t()}function w(e){n.getActiveProducts(a.reloadItems,function(t){r.originalProducts=t,D&&D.productSortOrder?r.productSortOrder.order=D.productSortOrder:r.productSortOrder.order="most_recent",b(r.originalProducts,function(){r.pageChanged(1)}),e||B()})}function y(){var e="",t="";if(r.newContact.details){r.newContact.details[0].phones&&r.newContact.details[0].phones[0]&&r.newContact.details[0].phones[0].number&&(e=r.newContact.details[0].phones[0].number),r.newContact.details[0].emails&&r.newContact.details[0].emails[0]&&r.newContact.details[0].emails[0].email&&(t=r.newContact.details[0].emails[0].email);var n=[{_id:Math.uuid(10),emails:[{_id:Math.uuid(10),email:t}],phones:[],addresses:[{_id:Math.uuid(10),address:r.newContact.details[0].addresses[0].address,address2:r.newContact.details[0].addresses[0].address2,state:r.newContact.details[0].addresses[0].state,zip:r.newContact.details[0].addresses[0].zip,country:"US",defaultShipping:!1,defaultBilling:!1,city:r.newContact.details[0].addresses[0].city,countryCode:"",displayName:""}]}];r.newContact.details[0].phones&&r.newContact.details[0].phones[0]&&r.newContact.details[0].phones[0].number&&n[0].phones.push({_id:Math.uuid(10),number:r.newContact.details[0].phones[0].number}),r.newContact.details=n}var o=r.newContact,i={first_name:o.first,last_name:o.last,phone:e,city:o.details?o.details[0].addresses[0].city:"",country:"US",address_1:o.details?o.details[0].addresses[0].address:"",company:"",postcode:o.details?o.details[0].addresses[0].zip:"",email:o.details?o.details[0].emails[0].email:"",address_2:o.details?o.details[0].addresses[0].address2:"",state:o.details?o.details[0].addresses[0].state:""};r.addresses.shipping&&(i=r.newShippingContactAddress);var s={customer:o,session_id:null,status:"paid",cart_discount:0,total_discount:0,total_shipping:k(r.totalShipping),total_tax:k(r.totalTax),shipping_tax:k(r.shippingTax),cart_tax:r.cartTax||0,currency:"usd",line_items:[],total_line_items_quantity:a.items.length,payment_details:{method_title:"Credit Card Payment",method_id:"cc",card_token:null,charge_description:null,statement_description:null,paid:!0},shipping_methods:"",shipping_address:i,billing_address:{first_name:o.first,last_name:o.last,phone:e,city:o.details?o.details[0].addresses[0].city:"",country:"US",address_1:o.details?o.details[0].addresses[0].address:"",company:"",postcode:o.details?o.details[0].addresses[0].zip:"",email:o.details?o.details[0].emails[0].email:"",address_2:o.details?o.details[0].addresses[0].address2:"",state:o.details?o.details[0].addresses[0].state:""},notes:[]};return _.each(a.items,function(e){var t=e.regular_price*e.quantity,n={product_id:e._id,quantity:e.quantity,regular_price:k(e.regular_price),sale_price:e.on_sale?k(e.sale_price):null,on_sale:e.onSaleToday||!1,taxable:e.taxable||!1,variation_id:"",tax_class:null,sku:"",total:k(t),name:e.name,total_tax:"0.00",type:e.type,status:e.status};s.line_items.push(n)}),s}function C(e){e&&(r.settings=e.commerceSettings,a.commerceSettings=e.commerceSettings,r.settings&&(r.paypalInfo=r.settings.paypal,r.settings.taxes&&"business_location"===r.settings.taxbased&&e.business.addresses&&e.business.addresses.length>0&&e.business.addresses[0].zip&&e.business.addresses[0].zip&&r.getTax(e.business.addresses[0].zip)))}function S(e){return s.zip.test(e)}function x(e){return!e||0===e.length}function k(e){return parseFloat(Math.round(100*e)/100).toFixed(2)}function A(){r.coupon?r.coupon.amount_off?(r.cart_discount=r.coupon.amount_off,r.percent_off=!1):r.coupon.percent_off&&(r.cart_discount=r.coupon.percent_off,r.percent_off=!0):(r.cart_discount=0,r.percent_off=!1),a.calculateTotalCharges(r.cart_discount,r.percent_off)}function P(n,o){t.getStripeCardToken(n,function(t,n){if(n){switch(n.param){case"number":$(".modal #card_number .error").html(n.message),$(".modal #card_number").addClass("has-error"),$(".modal #card_number .glyphicon").addClass("glyphicon-remove");break;case"exp_month":case"exp_year":$(".modal #card_expiry .error").html(n.message),$(".modal #card_expiry").addClass("has-error"),$(".modal #card_expiry .glyphicon").addClass("glyphicon-remove");break;case"cvc":$(".modal #card_cvc .error").html(n.message),$(".modal #card_cvc").addClass("has-error"),$(".modal #card_cvc .glyphicon").addClass("glyphicon-remove");break;case"name":$(".modal #card_name .error").html(n.message),$(".modal #card_name").addClass("has-error"),$(".modal #card_name .glyphicon").addClass("glyphicon-remove");break;default:$(".modal #card_number .error").html("There was an error processing your payment information.  Please check the details and try again."),$(".modal #card_number").addClass("has-error"),$(".modal #card_number .glyphicon").addClass("glyphicon-remove")}r.checkoutModalState=3}else{r.initializeModalEvents();var s="";r.newContact.details[0].phones&&r.newContact.details[0].phones[0]&&r.newContact.details[0].phones[0].number&&(s=r.newContact.details[0].phones[0].number);var c=[{_id:Math.uuid(10),emails:[{_id:Math.uuid(10),email:r.newContact.details[0].emails[0].email}],phones:[],addresses:[{_id:Math.uuid(10),address:r.newContact.details[0].addresses[0].address,address2:r.newContact.details[0].addresses[0].address2,state:r.newContact.details[0].addresses[0].state,zip:r.newContact.details[0].addresses[0].zip,country:"US",defaultShipping:!1,defaultBilling:!1,city:r.newContact.details[0].addresses[0].city,countryCode:"",displayName:""}]}];r.newContact.details[0].phones&&r.newContact.details[0].phones[0]&&r.newContact.details[0].phones[0].number&&c[0].phones.push({_id:Math.uuid(10),number:r.newContact.details[0].phones[0].number}),r.newContact.details=c;var l=r.newContact,d={first_name:l.first,last_name:l.last,phone:s,city:l.details?l.details[0].addresses[0].city:"",country:"US",address_1:l.details?l.details[0].addresses[0].address:"",company:"",postcode:l.details?l.details[0].addresses[0].zip:"",email:l.details?l.details[0].emails[0].email:"",address_2:l.details?l.details[0].addresses[0].address2:"",state:l.details?l.details[0].addresses[0].state:""};r.addresses.shipping&&(d=r.newShippingContactAddress);var u={customer:l,session_id:null,status:"paid",cart_discount:0,total_discount:0,total_shipping:k(r.totalShipping),total_tax:k(a.totalTax),shipping_tax:k(r.shippingTax),cart_tax:r.cartTax||0,currency:"usd",line_items:[],total_line_items_quantity:a.items.length,payment_details:{method_title:"Credit Card Payment",method_id:"cc",card_token:t,charge_description:null,statement_description:null,paid:!0},shipping_methods:"",shipping_address:d,billing_address:{first_name:l.first,last_name:l.last,phone:s,city:l.details[0].addresses[0].city,country:"US",address_1:l.details[0].addresses[0].address,company:"",postcode:l.details[0].addresses[0].zip,email:l.details[0].emails[0].email,address_2:l.details[0].addresses[0].address2,state:l.details[0].addresses[0].state},notes:[]};_.each(a.items,function(e){var t=e.regular_price*e.quantity,n={product_id:e._id,quantity:e.quantity,regular_price:k(e.regular_price),sale_price:e.on_sale?k(e.sale_price):null,on_sale:e.onSaleToday||!1,taxable:e.taxable||!1,variation_id:"",tax_class:null,sku:"",total:k(t),name:e.name,total_tax:"0.00",status:e.status};u.line_items.push(n)}),o&&(u.coupon=o),i.checkForInactiveProducts(u,function(t,n){if(n)return r.checkoutModalState=3,r.failedOrderMessage=n.message,a.reloadItems=!0,void e(function(){a.reloadItems=!1},1e3);i.createOrder(u,function(t){if(t&&!t._id){var n="Error in order processing";return t.message&&(n=t.message),r.checkoutModalState=3,void(r.failedOrderMessage=n)}r.order=t,r.refreshList=!1,a.items&&_.filter(a.items,function(e){return"auto_inactive"===e.status}).length&&(r.refreshList=!0),r.checkoutModalState=5,a.items=[],r.cartDetails=[],a.subTotal=0,a.totalTax=0,a.total=0,p.remove(E),M={products:[]},B(),N(),a.showTax=!1,r.showTax=!1,r.refreshList&&(a.reloadItems=!0,e(function(){a.reloadItems=!1},1e3),r.refreshList=!1)})})}})}function T(t){r.settings&&r.settings.checkout&&r.settings.checkout.redirectUrl&&e(function(){var e=r.settings.checkout.redirectUrl;r.order&&(e=e+"?orderId="+r.order._id),window.location.href=e},t||r.settings.checkout.redirectTimeout||5e3)}function I(){r.cart_discount=0,r.showDiscount=void 0,r.percent_off=!1,r.coupon=void 0,r.checkoutOrder={coupon:""}}r.showPaypalLoading=!1,r.showPaypalErrorMsg=!1,r.order=null,r.shippingStates=g,r.detailedDescription=!1,a.reloadItems=!1;var E="",O="",M="",U="",F="",D={};r.checkoutModalState=1,r.newContact={},r.newShippingContactAddress={},r.currentProductPage=1,r.addresses={labelText:"Address",buttonText:"Payment",shipping:!1},r.showTax=!1,r.showNotTaxed=!1,r.hasSubscriptionProduct=!1,r.paypalURL=u.trustAsResourceUrl(d.paypalCheckoutURL),r.taxPercent=0,I(),r.productSortOrder={order:"most_recent"},r.calculateTotalChargesfn=a.calculateTotalCharges,r.currentPath=angular.copy(l),r.$watch("addresses.shipping",function(e){e?(r.addresses.labelText="Billing Address",r.addresses.buttonText="Shipping"):(r.addresses.labelText="Address",r.addresses.buttonText="Payment")},!0),r.$watch(function(){return a},function(){r.total=a.total,r.subTotal=a.subTotal,r.totalTax=a.totalTax,r.showTax=a.showTax,r.taxPercent=a.taxPercent,r.showNotTaxed=a.showNotTaxed,r.numItems=a.items.length,r.cartDetails=a.items,r.hasSubscriptionProduct=a.hasSubscriptionProduct,r.totalDiscount=a.totalDiscount,r.totalShipping=a.totalShipping,r.shippingTax=a.shippingTax,r.cartTax=a.cartTax,r.cartDetails&&r.cartDetails.length&&a.calculateTotalCharges(r.cart_discount,r.percent_off)},!0),r.$watch(function(){return a.reloadItems},function(e){e&&w(!0)}),r.setInnerHeight=function(){var e=" ";if($(window).width()<768){var t=$("#cart-checkout-modal .modal-header").outerHeight(),n=$("#cart-checkout-modal .modal-footer:not('.ng-hide')").eq(0).outerHeight();return e+=" height:"+($(window).height()-(t+n))+"px;"}},w(),r.changeProductSortOrder=function(){D.productSortOrder=r.productSortOrder.order,p.set(F,D),b(r.originalProducts,function(){r.pageChanged(1)})},r.itemClicked=function(e){var t=!1;return e&&a.items&&(t=!!_.find(a.items,function(t){return t._id===e._id})),t},r.getTax=function(e,t){var n=y();r.waitForTax=!0,i.getEstimatedTax(n,function(e){e&&e.tax_rate>0?(a.showTax=!0,r.waitForTax=!1,a.taxPercent=parseFloat(100*e.tax_rate).toFixed(2),t&&t(a.taxPercent)):(a.showTax=!1,r.waitForTax=!1)})},o(function(e,t){if(e);else{if(r.account=t,r.paypalInfo=null,r.stripeInfo=null,r.account.credentials.forEach(function(e,t){"stripe"==e.type&&(r.stripeInfo=e)}),C(r.account),E="cart_cookie_"+r.account._id+"_"+r.account.subdomain,O="order_cookie_"+r.account._id+"_"+r.account.subdomain,F="product_cookie_"+r.account._id+"_"+r.component._id,!(M=p.get(E))){var n="cart_cookie_"+r.component._id;(M=p.get(n))?p.set(E,M):M={products:[]}}U=p.get(O),(D=p.get(F))||(D={productSortOrder:"most_recent"},p.set(F,D)),r.productSortOrder.order=D.productSortOrder}}),r.invalidZipCode=!1,r.billingPostCodeChanged=function(e,t){if(r.emptyZipCode=!1,r.invalidZipCode=!1,!e)return r.emptyZipCode=!1,void(r.emptyZipCode=!0);t&&a.checkIfStateTaxable(t,r.cart_discount,r.percent_off),S(e)?e&&r.settings.taxes&&"business_location"!==r.settings.taxbased&&(r.calculatingTax=!0,r.invalidZipCode=!1,a.showTax=!1,r.getTax(e,function(){r.calculatingTax=!1,a.showTax=!0,a.calculateTotalCharges(r.cart_discount,r.percent_off)})):(r.invalidZipCode=!0,"business_location"!==r.settings.taxbased&&(a.showTax=!1))},r.invalidShippingZipCode=!1,r.shippingPostCodeChanged=function(e,t){if(r.emptyShippingZipCode=!1,r.invalidShippingZipCode=!1,!e)return r.emptyShippingZipCode=!1,void(r.emptyShippingZipCode=!0);t&&a.checkIfStateTaxable(t,r.cart_discount,r.percent_off),S(e)?e&&r.settings.taxes&&"business_location"!==r.settings.taxbased&&(r.calculatingTax=!0,r.invalidShippingZipCode=!1,a.showTax=!1,r.getTax(e,function(){r.calculatingTax=!1,a.showTax=!0,a.calculateTotalCharges(r.cart_discount,r.percent_off)})):(r.invalidShippingZipCode=!0,"business_location"!==r.settings.taxbased&&(a.showTax=!1))},r.checkBillingFirst=function(e){r.emptyFirstName=!e},r.checkShippingFirst=function(e){r.emptyShippingFirstName=!e},r.checkBillingLast=function(e){r.emptyLastName=!e},r.checkShippingLast=function(e){r.emptyShippingLastName=!e},r.checkBillingEmail=function(e){e?(r.emptyEmail=!1,r.invalidEmail=!s.email.test(e)):(r.emptyEmail=!0,r.invalidEmail=!1)},r.checkBillingAddress=function(e){r.emptyAddress=!e},r.checkShippingAddress=function(e){r.emptyShippingAddress=!e},r.checkBillingState=function(e){e?(r.emptyState=!1,a.checkIfStateTaxable(e,r.cart_discount,r.percent_off)):(r.emptyState=!0,a.isStateTaxable=!1)},r.checkShippingState=function(e){e?(r.emptyShippingState=!1,a.checkIfStateTaxable(e,r.cart_discount,r.percent_off)):(r.emptyShippingState=!0,a.isStateTaxable=!1)},r.checkBillingCity=function(e){r.emptyCity=!e},r.checkShippingCity=function(e){r.emptyShippingCity=!e},r.checkBillingPhone=function(e){r.invalidPhone=!!e&&!$("#checkout-billing-phone-number").intlTelInput("isValidNumber")},r.validateAddressDetails=function(e,t,n){r.emptyFirstName=!1,r.emptyLastName=!1,r.emptyEmail=!1,r.emptyAddress=!1,r.emptyState=!1,r.emptyCity=!1,r.invalidZipCode=!1,r.emptyZipCode=!1,r.invalidEmail=!1,r.invalidPhone=!1;var o,i,s,c,l,d;r.newContact&&(o=r.newContact.first,i=r.newContact.last),e&&(s=e.address,c=e.state,l=e.city,d=e.zip),r.checkBillingFirst(o),r.checkBillingLast(i),r.checkBillingEmail(t),r.checkBillingAddress(s),r.checkBillingState(c),r.checkBillingCity(l),r.checkBillingPhone(n),r.billingPostCodeChanged(d,c),r.emptyFirstName||r.emptyLastName||r.emptyEmail||r.emptyAddress||r.emptyState||r.emptyCity||r.invalidZipCode||r.emptyZipCode||r.invalidEmail||r.invalidPhone||(r.addresses.shipping?r.checkoutModalState=8:a.hasSubscriptionProduct?r.checkoutModalState=3:r.stripeInfo&&r.paypalInfo?r.checkoutModalState=6:r.stripeInfo?r.checkoutModalState=3:r.paypalInfo&&(r.checkoutModalState=6))},r.validateShippingAddressDetails=function(){r.emptyShippingFirstName=!1,r.emptyShippingLastName=!1,r.emptyShippingAddress=!1,r.emptyShippingState=!1,r.emptyShippingCity=!1,r.invalidShippingZipCode=!1,r.emptyShippingZipCode=!1;var e,t,n,o,i,s;r.newShippingContactAddress&&(e=r.newShippingContactAddress.first_name,t=r.newShippingContactAddress.last_name,n=r.newShippingContactAddress.address_1,o=r.newShippingContactAddress.state,i=r.newShippingContactAddress.city,r.newShippingContactAddress.email,s=r.newShippingContactAddress.postcode,r.newShippingContactAddress.phone),r.checkShippingFirst(e),r.checkShippingLast(t),r.checkShippingAddress(n),r.checkShippingState(o),r.checkShippingCity(i),r.shippingPostCodeChanged(s,o),r.emptyShippingFirstName||r.emptyShippingLastName||r.emptyShippingAddress||r.emptyShippingState||r.emptyShippingCity||r.invalidShippingZipCode||r.emptyShippingZipCode||(a.hasSubscriptionProduct?r.addresses.shipping&&(r.checkoutModalState=3):r.stripeInfo&&r.paypalInfo?r.checkoutModalState=6:r.stripeInfo?r.checkoutModalState=3:r.paypalInfo&&(r.checkoutModalState=6))},r.scrollToElement=function(){e(function(){$(".form-group.has-error").eq(0).length?$(".form-group.has-error").eq(0)[0].scrollIntoView():angular.element("#cart-checkout-modal .modal-body").scrollTop(0)},0)},r.updateSelectedProduct=function(e){e.attributes=r.selectedProductAttributes(e),r.selectedProduct=e,r.openProductDetailsModal()},r.openNewProductDetailsModal=function(t){r.selectedProduct=t,r.detailedDescription=!1,r.modalInstance=m.open({templateUrl:"new-product-details-modal",keyboard:!0,size:"lg",scope:r}),e(function(){angular.element(".modal-backdrop").addClass("product-description-modal-background"),angular.element(".modal-content").addClass("product-description-modal-content"),angular.element(".modal-dialog").addClass("product-description-modal-dialog"),angular.element(".modal.fade").addClass("product-description-modal")},0),l.search("productId",t._id)},r.showFullContent=function(){angular.element(".product-description-modal-dialog").addClass("detailed-product-description-modal-dialog"),r.detailedDescription=!0},r.selectedProductAttributes=function(e){var t;if(e){var n=[];_.each(e.variations,function(e){_.each(e.attributes,function(e){var t=_.find(n,function(t){return t.name===e.name});if(t)t.values.indexOf(e.option)<0&&t.values.push(e.option);else{var o={name:e.name,values:[e.option]};n.push(o)}})}),t=n}else t=[];return t},r.updatePrice=function(){var e=r.selectedProduct.variations,t=r.selectedProduct.attributes,n=_.find(e,function(e){var n=!0;return _.each(t,function(t){_.find(e.attributes,function(e){return e.name===t.name}).option!==t.selected&&(n=!1)}),n});n&&(r.matchedVariation=n)},r.addDetailsToCart=function(e,t,n){e&&(M.products.push({product:t,variation:n,quantity:1}),p.set(E,M));var o="";if(n?((o=n).variation=!0,o.name=t.name):o=_.find(r.products,function(e){return e._id===t._id}),o){o.quantity||(o.quantity=1),-1===a.items.indexOf(o)&&(o.quantity=1);var i=_.find(a.items,function(e){return e._id===o._id});i?i.quantity=parseInt(i.quantity,10)+1:a.addItemToCart(o,r.cart_discount,r.percent_off)}},r.reloadCartDetails=function(e,t,n){var o="";t?((o=t).variation=!0,o.name=e.name):o=_.find(r.products,function(t){return t._id===e._id}),o&&(o.quantity=n,_.find(a.items,function(e){return e._id===o._id})||a.addItemToCart(o,r.cart_discount,r.percent_off))},r.removeFromCart=function(e,t){e&&(M.products.forEach(function(e,n){e.product._id==t._id&&M.products.splice(n,1)}),M.products.length||(M.state=1),p.set(E,M)),a.removeItemFromCart(t,r.cart_discount,r.percent_off)},r.checkCardNumber=function(){_.compact($(".modal #number").map(function(){return $(this).val()}).get())[0]?($(".modal #card_number .error").html(""),$(".modal #card_number").removeClass("has-error").addClass("has-success"),$(".modal #card_number .glyphicon").removeClass("glyphicon-remove").addClass("glyphicon-ok")):($(".modal #card_number .error").html("Card Number Required"),$(".modal #card_number").addClass("has-error"),$(".modal #card_number .glyphicon").addClass("glyphicon-remove"))},r.basicInfo={},r.validateBasicInfo=function(){},r.paypalPayment=function(){r.showPaypalLoading=!0,r.failedOrderMessage="",I();var t=r.newContact;if(x(t.first)||x(t.last)||x(t.first)||x(t.details[0].emails[0].email))r.checkoutModalState=2;else{r.initializeModalEvents();var n="";r.newContact.details[0].phones&&r.newContact.details[0].phones[0]&&r.newContact.details[0].phones[0].number&&(n=r.newContact.details[0].phones[0].number);var o=[{_id:Math.uuid(10),emails:[{_id:Math.uuid(10),email:r.newContact.details[0].emails[0].email}],phones:[],addresses:[{_id:Math.uuid(10),address:r.newContact.details[0].addresses[0].address,address2:r.newContact.details[0].addresses[0].address2,state:r.newContact.details[0].addresses[0].state,zip:r.newContact.details[0].addresses[0].zip,country:"US",defaultShipping:!1,defaultBilling:!1,city:r.newContact.details[0].addresses[0].city,countryCode:"",displayName:""}]}];r.newContact.details[0].phones&&r.newContact.details[0].phones[0]&&r.newContact.details[0].phones[0].number&&o[0].phones.push({_id:Math.uuid(10),number:r.newContact.details[0].phones[0].number}),r.newContact.details=o;var s=r.newContact,c={first_name:s.first,last_name:s.last,phone:n,city:s.details?s.details[0].addresses[0].city:"",country:"US",address_1:s.details?s.details[0].addresses[0].address:"",company:"",postcode:s.details?s.details[0].addresses[0].zip:"",email:s.details?s.details[0].emails[0].email:"",address_2:s.details?s.details[0].addresses[0].address2:"",state:s.details?s.details[0].addresses[0].state:""};r.addresses.shipping&&(c=r.newShippingContactAddress);var l={customer:s,session_id:null,status:"paid",cart_discount:0,total_discount:0,total_shipping:k(r.totalShipping),total_tax:k(r.totalTax),shipping_tax:k(r.shippingTax),cart_tax:r.cartTax||0,currency:"usd",line_items:[],total_line_items_quantity:a.items.length,payment_details:{method_title:"Credit Card Payment",method_id:"cc",card_token:null,charge_description:null,statement_description:null,paid:!0},shipping_methods:"",shipping_address:c,billing_address:{first_name:s.first,last_name:s.last,phone:n,city:s.details[0].addresses[0].city,country:"US",address_1:s.details[0].addresses[0].address,company:"",postcode:s.details[0].addresses[0].zip,email:s.details[0].emails[0].email,address_2:s.details[0].addresses[0].address2,state:s.details[0].addresses[0].state},notes:[]};_.each(a.items,function(e){var t=e.regular_price*e.quantity,n={product_id:e._id,quantity:e.quantity,regular_price:k(e.regular_price),sale_price:e.on_sale?k(e.sale_price):null,on_sale:e.onSaleToday||!1,taxable:e.taxable||!1,variation_id:"",tax_class:null,sku:"",total:k(t),name:e.name,total_tax:"0.00",type:e.type,status:e.status};l.line_items.push(n)}),i.checkForInactiveProducts(l,function(t,n){if(n)return r.checkoutModalState=6,r.failedOrderMessage=n.message,a.reloadItems=!0,void e(function(){a.reloadItems=!1},1e3);i.createPaypalOrder(l,function(e){if(r.order=e,r.showPaypalLoading=!1,e&&!e._id){var t="Error in order processing";return e.message&&(t=e.message),r.checkoutModalState=6,void(r.failedOrderMessage=t)}r.refreshList=!1,a.items&&_.filter(a.items,function(e){return"auto_inactive"===e.status}).length&&(r.refreshList=!0),r.checkoutModalState=7,r.checkoutExpType=screen.width<769?"mini":"light",p.set(O,e),r.paypalKey=e.payment_details.payKey,a.items=[],r.cartDetails=[],a.subTotal=0,a.totalTax=0,a.total=0,p.remove(E)})})}},r.makeCartPayment=function(){var e=r.checkoutOrder.coupon;if(e&&!1===r.couponIsValid)r.checkoutModalState=3;else{angular.element("#cart-checkout-modal .modal-body").scrollTop(0),r.failedOrderMessage="",r.checkoutModalState=4;var n=_.compact($(".modal #expiry").map(function(){return $(this).val()}).get())[0];n&&-1!==n.indexOf("/")&&(n=n.split("/"));var o=n&&n[0].trim(),a="";n&&n.length>1&&(a=n[1].trim());var i={name:_.compact($(".modal #card_name #name").map(function(){return $(this).val()}).get())[0],number:_.compact($(".modal #number").map(function(){return $(this).val()}).get())[0],cvc:_.compact($(".modal #cvc").map(function(){return $(this).val()}).get())[0],exp_month:o,exp_year:a};if(!(i.number&&i.cvc&&i.exp_month&&i.exp_year&&i.name))return r.checkCardName(),r.checkCardNumber(),r.checkCardExpiry(),r.checkCardCvv(),void(r.checkoutModalState=3);if(i.number&&i.cvc&&i.exp_month&&i.exp_year&&!r.isCardExpired){var s=r.newContact;x(s.first)||x(s.last)||x(s.first)||x(s.details[0].emails[0].email)?r.checkoutModalState=2:(s&&(i.name=s.first+" "+s.last,i.address_line1=s.details[0].addresses[0].address,i.address_city=s.details[0].addresses[0].city,i.address_state=s.details[0].addresses[0].state,i.address_zip=s.details[0].addresses[0].zip,i.address_country=s.details[0].addresses[0].country||"US",s.details[0].addresses[0].address2&&(i.address_line2=s.details[0].addresses[0].address2)),e?(r.showDiscount=void 0,t.validateCoupon(e,function(t){if(r.currentCoupon=t,r.checkingCoupon=!1,!t||!t.id||t.id!==e)return angular.element("#coupon-name .error").html("Invalid Coupon"),r.couponIsValid=!1,r.checkoutModalState=3,r.coupon=void 0,void(r.showDiscount=!1);angular.element("#coupon-name .error").html(""),r.couponIsValid=!0,r.coupon=t,r.showDiscount=!0,P(i,t)})):(r.coupon=void 0,r.showDiscount=!1,P(i)))}else r.checkoutModalState=3}};var N=function(){$(".modal #product-card-details").trigger("reset"),$(".modal #card_number").removeClass("has-error has-success"),$(".modal #card_number .glyphicon").removeClass("glyphicon-remove glyphicon-ok"),$(".modal #card_name").removeClass("has-error has-success"),$(".modal #card_name .glyphicon").removeClass("glyphicon-remove glyphicon-ok"),$(".modal #card_expiry").removeClass("has-error has-success"),$(".modal #card_expiry .glyphicon").removeClass("glyphicon-remove glyphicon-ok"),$(".modal #card_cvc").removeClass("has-error has-success"),$(".modal #card_cvc .glyphicon").removeClass("glyphicon-remove glyphicon-ok"),$(f).find(".jp-card-number").text("   "),$(f).find(".jp-card-cvc").text(""),$(f).find(".jp-card-name").text("Full Name"),$(f).find(".jp-card-expiry").text("/"),$(f).find(".jp-card").removeClass("jp-card-identified"),I()};r.initializeModalEvents=function(){$(".modal").off("hidden.bs.modal").on("hidden.bs.modal",function(){e(function(){r.$apply(function(){5===r.checkoutModalState&&(r.checkoutModalState=1,r.newContact={},r.newShippingContactAddress={},r.addresses.shipping=!1,N())})},0)})},r.pageChanged=function(e){if(r.currentProductPage=e,r.products){var t=(r.currentProductPage-1)*r.component.numtodisplay,n=r.component.numtodisplay;0===n&&(n=r.products.length);var o=t+n;r.filteredProducts=r.products.slice(t,o)}},r.variationAttributeExists=function(e){var t=r.selectedProduct.variations,n=!1;return _.each(t,function(t){_.find(t.attributes,function(t){t.option===e&&(n=!0)})}),n},r.checkCardNumber=function(){r.failedOrderMessage="",_.compact($(".modal #number").map(function(){return $(this).val()}).get())[0]?($(".modal #card_number .error").html(""),$(".modal #card_number").removeClass("has-error").addClass("has-success"),$(".modal #card_number .glyphicon").removeClass("glyphicon-remove").addClass("glyphicon-ok")):($(".modal #card_number .error").html("Card Number Required"),$(".modal #card_number").addClass("has-error"),$(".modal #card_number .glyphicon").addClass("glyphicon-remove"))},r.checkCardName=function(){r.failedOrderMessage="",_.compact($(".modal #card_name #name").map(function(){return $(this).val()}).get())[0]?($(".modal #card_name .error").html(""),$(".modal #card_name").removeClass("has-error").addClass("has-success"),$(".modal #card_name .glyphicon").removeClass("glyphicon-remove").addClass("glyphicon-ok")):($(".modal #card_name .error").html("Card Name Required"),$(".modal #card_name").addClass("has-error"),$(".modal #card_name .glyphicon").addClass("glyphicon-remove"))},r.currentYear=(new Date).getYear()-100,r.fullCurrentYear=(new Date).getFullYear(),r.currentMonth=(new Date).getMonth()+1,r.checkCardExpiry=function(){r.isCardExpired=!1,r.failedOrderMessage="";var e=_.compact($(".modal #expiry").map(function(){return $(this).val()}).get())[0];e&&-1!==e.indexOf("/")&&(e=e.split("/"));var t,n=e,o=n&&n[0].trim();if(n&&n.length>1&&(t=n[1].trim()),e&&o&&t){if(r.yearLength=t.length,2==r.yearLength){if(parseInt(t)<parseInt(r.currentYear))return $("#card_expiry .error").html("Card Year has Expired"),$("#card_expiry").addClass("has-error"),$("#card_expiry .glyphicon").addClass("glyphicon-remove"),void(r.isCardExpired=!0)}else if(4==r.yearLength){if(parseInt(t)<parseInt(r.fullCurrentYear))return $("#card_expiry .error").html("Card Year has Expired"),$("#card_expiry").addClass("has-error"),$("#card_expiry .glyphicon").addClass("glyphicon-remove"),void(r.isCardExpired=!0)}else if(3==r.yearLength)return $("#card_expiry .error").html("Card Year is not valid"),$("#card_expiry").addClass("has-error"),$("#card_expiry .glyphicon").addClass("glyphicon-remove"),void(r.isCardExpired=!0);o<r.currentMonth&&parseInt(t)<=r.currentYear?($("#card_expiry .error").html("Card Month has Expired"),$("#card_expiry").addClass("has-error"),$("#card_expiry .glyphicon").addClass("glyphicon-remove"),r.isCardExpired=!0):o>12?($("#card_expiry .error").html("Card Month is invalid"),$("#card_expiry").addClass("has-error"),$("#card_expiry .glyphicon").addClass("glyphicon-remove"),r.isCardExpired=!0):($(".modal #card_expiry .error").html(""),$(".modal #card_expiry .glyphicon").removeClass("glyphicon-remove").addClass("glyphicon-ok"),$(".modal #card_expiry").removeClass("has-error").addClass("has-success"),r.isCardExpired=!1)}else e?o?t||$(".modal #card_expiry .error").html("Expiry Year Required"):$(".modal #card_expiry .error").html("Expiry Month Required"):$(".modal #card_expiry .error").html("Expiry Required"),$(".modal #card_expiry").addClass("has-error"),$(".modal #card_expiry .glyphicon").addClass("glyphicon-remove"),r.isCardExpired=!0},r.checkCardCvv=function(){r.failedOrderMessage="",_.compact($(".modal #cvc").map(function(){return $(this).val()}).get())[0]?($(".modal #card_cvc .error").html(""),$(".modal #card_cvc").removeClass("has-error").addClass("has-success"),$(".modal #card_cvc .glyphicon").removeClass("glyphicon-remove").addClass("glyphicon-ok")):($(".modal #card_cvc .error").html("CVC Required"),$(".modal #card_cvc").addClass("has-error"),$(".modal #card_cvc .glyphicon").addClass("glyphicon-remove"))},r.checkCoupon=function(){r.couponChecked=!0,r.checkingCoupon=!0;var e=r.checkoutOrder.coupon;e?(r.showDiscount=void 0,t.validateCoupon(e,function(t){r.currentCoupon=t,r.checkingCoupon=!1,t&&t.id&&t.id===e?(angular.element("#coupon-name .error").html(""),r.couponIsValid=!0,r.coupon=t,r.showDiscount=!0):(angular.element("#coupon-name .error").html("Invalid Coupon"),r.couponIsValid=!1,r.showDiscount=!1,r.coupon=void 0)})):(r.coupon=void 0,r.showDiscount=!1,r.couponIsValid=!0,r.checkingCoupon=!1,angular.element("#coupon-name .error").html(""),angular.element("#coupon-name").removeClass("has-error").addClass("has-success"),angular.element("#coupon-name .glyphicon").removeClass("glyphicon-remove").addClass("glyphicon-ok"))},M||(M={products:[]});var B=function(){M.products.forEach(function(e,t){r.reloadCartDetails(e.product,e.variation,e.quantity)}),a.calculateTotalCharges(r.cart_discount),M.state&&(r.checkoutModalState=M.state),M.contactInfo?r.newContact=M.contactInfo:r.newContact={},M.shippingInfo?r.newShippingContactAddress=M.shippingInfo:r.newShippingContactAddress={},M.checkShippingInfo?r.addresses.shipping=M.checkShippingInfo:r.addresses.shipping=!1,D.productSortOrder&&(r.productSortOrder.order=D.productSortOrder),M.checkShippingInfo=r.addresses.shipping,c.state&&"products"==c.comp&&(r.checkoutModalState=parseInt(c.state),r.showModalFn(),5==r.checkoutModalState&&U&&i.setOrderPaid(U,function(t){if(t&&!t._id){var n="Error in order processing";return t.message&&(n=t.message),void(r.failedOrderMessage=n)}p.remove(O),r.refreshList&&(a.reloadItems=!0,e(function(){a.reloadItems=!1},1e3),r.refreshList=!1)}),6==r.checkoutModalState&&(r.showPaypalErrorMsg=!0))};r.cookieUpdateContactFn=function(){M.contactInfo=r.newContact,p.set(E,M)},r.cookieUpdateContactShippingFn=function(){M.shippingInfo=r.newShippingContactAddress,p.set(E,M)},r.cookieUpdateContactShippingValueFn=function(){M.checkShippingInfo=r.addresses.shipping,p.set(E,M)},r.cookieUpdateQuantityFn=function(e){M.products.forEach(function(t,n){e._id==t.product._id&&(t.quantity=parseInt(e.quantity))}),p.set(E,M)},r.paypalLoginClickFn=function(){if(screen.width<769){new PAYPAL.apps.DGFlowMini({trigger:"submitBtn"});$("#payPalform").submit()}else new PAYPAL.apps.DGFlow({expType:null}).startFlow(l.absUrl());r.close(),angular.element("body").hide(),e(function(){angular.element("body").show()},3e3)},r.deleteOrderFn=function(e){i.deletePaypalOrder(e,function(e){e.deleted&&(r.close(),r.checkoutModalState=1)})},r.showModalFn=function(){r.modalInstance=m.open({templateUrl:"product-cart-modal",keyboard:!0,size:"lg",scope:r,backdrop:"static"}),r.account&&C(r.account),e(function(){$("#product-card-details-"+r.component._id).card({container:"#card-wrapper-"+r.component._id}),angular.element("#cart-checkout-modal").parents(".modal-dialog").addClass("product-cart-modal-dialog")},200)},r.openProductDetailsModal=function(){r.modalInstance=m.open({templateUrl:"product-details-modal",keyboard:!0,size:"lg",scope:r}),e(function(){angular.element("#product-details-content").parents(".modal").addClass("product-details-cart-modal")},200)},r.closeProductDetailsModal=function(){r.modalInstance.close()},r.close=function(){r.modalInstance.close(),5==r.checkoutModalState&&(r.checkoutModalState=1,T(1))},r.cartValidItemCountFn=function(){var e=!0;return r.cartDetails.forEach(function(t,n){t.quantity?parseInt(t.quantity)<=0&&(e=!1):e=!1}),e},r.isImage=function(e){return!(e&&0===e.indexOf("fa-"))},r.$watch("checkoutModalState",function(e){5===e&&T()}),r.$watch("products",function(t){if(t&&t.length>0&&!a.productViewLoaded&&l.search().productId){var n=l.search().productId,o=_.find(t,function(e){return e._id===n});o&&(a.productViewLoaded=!0,e(function(){2==r.component.version?r.openNewProductDetailsModal(o):r.updateSelectedProduct(o)},2e3))}}),r.$on("$routeChangeStart",function(e,t,n){a.productViewLoaded=!1}),r.$watch("showDiscount",function(e){angular.isDefined(e)&&A()},!0),r.gridStyle=function(e){var t=" ";return e&&e.bg&&e.bg.color&&(t+="background-color: "+e.bg.color+"!important;"),t},r.titleStyle=function(e){var t=" ";return e&&(e.titleFontFamily&&(t+="font-family: "+e.titleFontFamily+"!important;"),e.titleTextSize&&(t+="font-size: "+e.titleTextSize+"px !important;"),e.titleTextColor&&(t+="color: "+e.titleTextColor+"!important;")),t},r.priceStyle=function(e){var t=" ";return e&&(e.priceFontFamily&&(t+="font-family: "+e.priceFontFamily+"!important;"),e.priceTextSize&&(t+="font-size: "+e.priceTextSize+"px !important;"),e.priceTextColor&&(t+="color: "+e.priceTextColor+"!important;")),t},r.descriptionStyle=function(e){var t=" ";return e&&(e.descriptionFontFamily&&(t+="font-family: "+e.descriptionFontFamily+"!important;"),e.descriptionTextSize&&(t+="font-size: "+e.descriptionTextSize+"px !important;"),e.descriptionTextColor&&(t+="color: "+e.descriptionTextColor+"!important;")),t},r.setCheckoutState=function(e,t){e&&(M.state=t,p.set(E,M)),r.checkoutModalState=t,angular.element("#cart-checkout-modal .modal-body").scrollTop(0)},r.cartButtonStyle=function(e){var t=" ";return e&&(e.addToCartBtnBgColor&&(t+="background-color: "+e.addToCartBtnBgColor+"!important;",t+="border-color: "+e.addToCartBtnBgColor+"!important;"),e.addToCartBtnTxtColor&&(t+="color: "+e.addToCartBtnTxtColor+"!important;")),t},r.productSortOrderOptions=[{label:"Most Recent",data:"most_recent"},{label:"Price: Low to High",data:"price_low"},{label:"Price: High to Low",data:"price_high"}]},controller:["$scope",function(e){}]}}]),app.directive("simpleFormComponent",["ipCookie","$window","$timeout","userService","formValidations","campaignService","$location",function(e,t,n,o,a,r,i){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(t){function s(e){return e.replace(/[^\w-\s]/gi,"")}function c(e){e.style.setProperty("border-color","none","important"),e.style.setProperty("border-width","0px","important"),e.style.setProperty("border-radius","none%","important"),e.style.setProperty("border-style","none","important")}t.elementClass=".simple-form-"+t.component._id+" .form-submit-button";var l=null;t.isBusy=!1,t.originalData={bg:{}},t.component.campaignId&&r.getCampaign(t.component.campaignId,function(e){l=e}),t.nthRow="nth-row",angular.isDefined(t.component.tags)||(t.component.tags=[],t.component.contact_type&&t.component.tags.push(t.component.contact_type)),t.fieldClass=function(e){var n="col-sm-12";return t.component.formSettings&&t.component.formSettings.fieldsPerRow>0&&(n="col-sm-"+Math.floor(12/t.component.formSettings.fieldsPerRow),t.component.formSettings.spacing&&t.component.formSettings.spacing.pr&&(t.nthRow="nth-row"+t.component.formSettings.fieldsPerRow)),n},t.fieldShow=function(e){var n=_.find(t.component.fields,function(t){return t.name===e});if(n&&n.value)return!0},t.fieldStyle=function(e){var t=" ";return e&&e.spacing&&e.spacing.mb&&(t+="margin-bottom: "+e.spacing.mb+"px;"),t},t.inputStyle=function(e){var t=" ";return e&&e.align&&(t+="text-align: "+e.align+";"),e&&e.inputTextSize&&(t+="font-size: "+e.inputTextSize+"px !important;"),e&&e.inputFontFamily&&(t+="font-family: "+e.inputFontFamily+";"),e&&e.inputBgColor&&(t+="background-color: "+e.inputBgColor+"!important;"),e&&e.inputBorderColor&&(t+="border-color: "+e.inputBorderColor+";"),e&&e.inputTextColor&&(t+="color: "+e.inputTextColor+";"),t},t.buttonStyle=function(e){var n="";return e&&e.align&&("left"!==e.align&&"right"!==e.align||(n+="float: "+e.align+";"),"center"===e.align&&(n+="margin: 0 auto;")),e&&e.bg&&e.bg.color&&(n+=" background-color: "+e.bg.color+"!important;",n+=" border-color: "+e.bg.color+";",t.originalData.bg.color=e.bg.color,t.originalData.borderColor=e.bg.color),e&&e.txtcolor&&(n+=" color: "+e.txtcolor+"!important;",t.originalData.txtcolor=e.txtcolor),e&&e.border&&e.border.show&&(e.border.color&&(n+=" border-color: "+e.border.color+"  !important;",t.originalData.btn={},t.originalData.btn.border=e.border),e.border.width&&(n+=" border-width: "+e.border.width+"px   !important;"),e.border.radius||(e.border.radius=0),n+=" border-radius: "+e.border.radius+"%  !important;",e.border.style?n+=" border-style: "+e.border.style+" !important;":n+=" border-style: none !important;"),n},t.formStyle=function(e){var t="";return e&&(e.formFontFamily&&(t+="font-family: "+e.formFontFamily+";"),e.formTextColor&&(t+="color: "+e.formTextColor+";")),t},angular.element(document).ready(function(){var e=t.$watch(function(){return angular.element(t.elementClass).length},function(o,a){o&&(e(),n(function(){var e=angular.element(t.elementClass),o={bg:{color:e.css("background-color")},txtcolor:e.css("color"),borderColor:e.css("border-color")},a=null;e&&(e.hover(function(){var e=null;t.component.formSettings&&t.component.formSettings.btnStyle&&t.component.formSettings.btnStyle.hover&&(e=t.component.formSettings.btnStyle.hover),e?(e.bg&&e.bg.color&&(this.style.setProperty("background-color",e.bg.color,"important"),this.style.setProperty("border-color",e.bg.color,"important")),e.border&&e.border.show?(e.border.color&&this.style.setProperty("border-color",e.border.color,"important"),e.border.width&&this.style.setProperty("border-width",e.border.width+"px","important"),e.border.radius||(e.border.radius=0),this.style.setProperty("border-radius",e.border.radius+"%","important"),e.border.style&&this.style.setProperty("border-style",e.border.style,"important")):c(this)):c(this),e&&e.txtcolor&&this.style.setProperty("color",e.txtcolor,"important")},function(){c(this),this.style.setProperty("background-color",t.originalData.bg.color||o.bg.color,"important"),this.style.setProperty("color",t.originalData.txtcolor||o.txtcolor,"important"),this.style.setProperty("border-color",t.originalData.borderColor||o.borderColor,"important");var e=t.originalData.btn||t.component.btn;e&&e.border&&e.border.show&&(e.border.color&&this.style.setProperty("border-color",e.border.color,"important"),e.border.width&&this.style.setProperty("border-width",e.border.width+"px","important"),e.border.radius||(e.border.radius=0),this.style.setProperty("border-radius",e.border.radius+"%","important"),e.border.style&&this.style.setProperty("border-style",e.border.style,"important"))}),e.on("mousedown touchstart",function(){t.component.formSettings&&t.component.formSettings.btnStyle&&t.component.formSettings.btnStyle.pressed&&(a=t.component.formSettings.btnStyle.pressed),a?(a.bg&&a.bg.color&&(this.style.setProperty("background-color",a.bg.color,"important"),this.style.setProperty("border-color",a.bg.color,"important")),a.border&&a.border.show?(a.border.color&&this.style.setProperty("border-color",a.border.color,"important"),a.border.width&&this.style.setProperty("border-width",a.border.width+"px","important"),a.border.radius||(a.border.radius=0),this.style.setProperty("border-radius",a.border.radius+"%","important"),a.border.style?this.style.setProperty("border-style",a.border.style,"important"):this.style.setProperty("border-style","none","important")):c(this)):c(this),a&&a.txtcolor&&this.style.setProperty("color",a.txtcolor,"important")}),e.on("mouseup touchend",function(){var e=this;n(function(){c(e),e.style.setProperty("background-color",t.originalData.bg.color||o.bg.color,"important"),e.style.setProperty("color",t.originalData.txtcolor||o.txtcolor,"important"),e.style.setProperty("border-color",t.originalData.borderColor||o.borderColor,"important");var n=t.originalData.btn||t.component.btn;n&&n.border&&n.border.show&&(n.border.color&&e.style.setProperty("border-color",n.border.color,"important"),n.border.width&&e.style.setProperty("border-width",n.border.width+"px","important"),n.border.radius||(n.border.radius=0),e.style.setProperty("border-radius",n.border.radius+"%","important"),e.style.setProperty("border-style",n.border.style||"none","important"))},1e3)}))},500))})}),t.formValidations=a,t.user={},t.createUser=function(a){t.userExists=!1,t.isBusy=!0;var r,c=(new Fingerprint).get(),d=e("session_cookie")?e("session_cookie").id:null;t.component.skipWelcomeEmail&&(r=!0);var u,p="true"===t.component.sendEmail;!t.component.campaignId||p?t.component.campaignId="":u=t.component.campaignId;var m=[];l&&angular.isDefined(l.searchTags)&&l.searchTags.tags.length&&(m=_.uniq(_.pluck(l.searchTags.tags,"data")));var g=[],h=i.$$search,f=angular.copy(t.user);angular.isObject(h)&&Object.keys(h).length&&_.each(h,function(e,t){g.push({name:s(t),value:s(e)}),f[t]=e});var v={fingerprint:c,sessionId:d,first:t.user.first,last:t.user.last,details:[{emails:[],phones:[]}],campaignId:u,campaignTags:m,emailId:t.component.emailId,sendEmail:t.component.sendEmail,skipWelcomeEmail:r,fromEmail:t.component.fromEmail,fromName:t.component.fromName,contact_type:t.component.tags,uniqueEmail:t.component.uniqueEmail||!1,activity:{activityType:"CONTACT_FORM",note:t.user.message||"Contact form data.",sessionId:e("session_cookie")?e("session_cookie").id:null,contact:f}};v.details[0].emails.push({email:t.user.email}),(t.user.phone||t.user.extension)&&v.details[0].phones.push({number:t.user.phone,extension:t.user.extension,type:"m"}),g.length&&(v.extra=g),t.user._optin&&(v.optIn=t.user._optin),o.addContact(v,function(e,o){if(t.isBusy=!1,o&&409===o.code)t.userExists=!0;else if(o&&409!==o.code)t.formError=!0,n(function(){t.formError=!1},5e3);else if(e){if(t.component.facebookConversionCode){var r=window._fbq||(window._fbq=[]);if(!r.loaded){var i=document.createElement("script");i.async=!0,i.src="//connect.facebook.net/en_US/fbds.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(i,s),r.loaded=!0}window._fbq=window._fbq||[],window._fbq.push(["track",t.component.facebookConversionCode,{value:"0.00",currency:"USD"}])}t.component.redirect?(t.formSuccess=!0,t.user={},a.$setPristine(!0),n(function(){t.formSuccess=!1},3e3),"page"===t.component.redirectType&&(window.location.href=t.component.redirectUrl),"external"===t.component.redirectType&&(window.location.href="http://"+t.component.redirectUrl)):(t.formSuccess=!0,t.user={},a.$setPristine(!0),n(function(){t.formSuccess=!1},3e3))}})}}}}]),app.directive("singlePostComponent",["$window","$location","accountService","postService","ENV",function(e,t,n,o,a){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(r){r.component.spacing=r.$parent.defaultSpacings,r.facebookClientID=a.facebookClientID,r.blogPageUrl=t.$$absUrl;var i=t.$$path.replace("/page","").replace("/blog/","");r.blog={},r.$parent.blog_post&&-1===t.$$path.indexOf("/blog/")?r.blog.post=r.$parent.blog_post:n(function(t,n){o.getSinglePost(i,n.website.websiteId,function(t){r.blog.post=t,e.document.title=t.post_title.replace(/<\/?[^>]+(>|$)/g,"")})}),r.$back=function(){window.history.back()},r.getEncodedUrl=function(e){return encodeURI(e)},r.getImageUrl=function(e){return e&&!/http[s]?/.test(e)&&(e="http:"+e),angular.isDefined(e)&&o.isValidImage(e)?encodeURI(e):""},r.getPlainTitle=function(e){var t,n=e;return e&&(t=angular.element(".plain-post-title"))&&t.length&&(n=t.text().trim()),n}}}}]),app.directive("socialLinkComponent",["$timeout",function(e){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(t){t.getUrl=function(e){return e&&!/http[s]?/.test(e)&&(e="http://"+e),e},e(function(){t.loadSocialLinks=!0},500)}}}]),app.directive("testimonialsComponent",[function(){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(e){e.component.slider||(e.component.slider={speed:300,autoPlay:!0,autoPlayInterval:5e3}),e.touchMove=!0,e.draggable=!0,e.autoplay=e.component.slider.autoPlay,e.dataLoaded=!0,e.accessibility=!0}}}]),app.directive("textOnlyComponent",["$timeout",function(e){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",controller:["$scope","SsbPageSectionService","$compile",function(t,n,o){t.$watchCollection(function(){return n.offset},function(n){e(function(){var e=$("#"+t.component._id+" [du-smooth-scroll]"),a=$("#"+t.component._id).parent("#sticky-wrapper");e&&a&&angular.forEach(e,function(e){$(e).attr("offset",n),o($(e))(t)})},100)})}]}}]),app.directive("thumbnailSliderComponent",["$window","$timeout",function(e,t){return{scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(n,o,a){function r(e,t){var n=[];if(angular.isArray(e[0]))return e;for(var o=0;o<e.length;o+=t)n.push(e.slice(o,o+t));return n}n.interval="6000";var i=angular.element(e),s=function(){var e=!1;return function(t,n){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}();i.width();n.showSlider=!0,n.bindThumbnailSlider=function(e,t){var o=4;n.component.layoutModifiers&&n.component.layoutModifiers.columns&&(o=n.component.layoutModifiers.columns),(e<768||t)&&(o=1),n.slider=r(n.component.thumbnailCollection,o),n.slider.length>1?n.displayThumbnailPaging=!0:n.displayThumbnailPaging=!1},n.bindThumbnailSlider(i.width(),s),angular.element(document).ready(function(){var e=n.$watch(function(){return angular.element("#myCarousel-"+n.component._id).length},function(o,a){o&&o>0&&(t(function(){var e=angular.element("#myCarousel-"+n.component._id);e.carousel&&e.carousel()},0),e())})}),angular.element(e).bind("resize",function(){n.bindThumbnailSlider(i.width())})}}}]),app.directive("topBarComponent",function(){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(e){e.getUrl=function(e){return e&&!/http[s]?/.test(e)&&(e="http://"+e),e}}}}),app.directive("videoGalleryComponent",function(){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(){}}}),app.directive("videoComponent",["$sce",function(e){"use strict";return{scope:{component:"="},templateUrl:"/components/component-wrap.html",link:function(t){t.flvVideoUrl=function(t,n,o,a,r){var i=urlParser.parse(n),s="";return i?(s=t+i.id+"?showinfo=0&rel=0&hd=1",o&&(s+="&autoplay=1"),a||(s+="&controls=0"),r||(s+="&modestbranding=1")):s=t,e.trustAsResourceUrl(s)},t.trustSrc=function(t){return e.trustAsResourceUrl(t)},t.config={autoHide:!0,autoPlay:!1,autoHideTime:1500,responsive:!0,stretch:"fit",theme:{url:"../../js/libs/videogular-themes-default/videogular.css",playIcon:"&#xe000;",pauseIcon:"&#xe001;",volumeLevel3Icon:"&#xe002;",volumeLevel2Icon:"&#xe003;",volumeLevel1Icon:"&#xe004;",volumeLevel0Icon:"&#xe005;",muteIcon:"&#xe006;",enterFullScreenIcon:"&#xe007;",exitFullScreenIcon:"&#xe008;"}}}}}]),angular.module("mainApp").directive("convertHtml",["$sce",function(e){"use strict";return{restrict:"E",replace:!0,template:"<div data-ng-bind-html='obj'> </div>",link:function(t,n,o){t.obj=e.trustAsHtml(o.contents)}}}]),angular.module("dm.style",[]).directive("style",["$compile",function(e){"use strict";return{restrict:"E",link:function(t,n){if(n.html()&&!$.contains(document.head,n.get(0))){var o=e('<style ng-bind-template="'+n.html()+'"></style>');n.replaceWith(o(t))}}}}]),angular.module("mainApp").directive("elem",["$timeout",function(e){"use strict";return{replace:!0,transclude:!0,scope:{ngModel:"=",className:"@className"},template:'<div class="element-wrap fr-view" ng-class="className" id="{{getId()}}"><div  ng-class="{{vm.elementClass()}}"  ng-attr-style="{{vm.elementStyle(false)}}" class="ssb-text-settings {{vm.showHideClass()}}" ><div ng-if="component.isOverlayActive" class="bg slider-overlay-bg-1" ng-style ="{\'background\': component.overlayBackground, opacity: component.overlayOpacity === 0 ?  component.overlayOpacity : component.overlayOpacity/100  || 0 , \'height\': component.isOverlayActive ? component.gridHeight+\'px\':\'\' }"></div><div class="word-break " ng-class ="{ \'abs_overlay\': component.isOverlayActive  }" ng-bind-html="ngModel | unsafe"></div></div></div>',link:function(t,n){if(t.component=t.$parent.component,e(function(){!n.hasClass("ssb-text-o-desktop")&&n.children().hasClass("ssb-text-o-desktop")&&(n.addClass("ssb-text-o-desktop"),n.parents(".ssb-text-only").addClass("ssb-text-o-desktop")),!n.hasClass("ssb-text-o-moblie")&&n.children().hasClass("ssb-text-o-moblie")&&(n.addClass("ssb-text-o-moblie"),n.parents(".ssb-text-only").addClass("ssb-text-o-moblie"))},0),t.getId=function(){var e=n.closest(".ssb-component").attr("id");return"text-element_"+n.closest(".ssb-section-layout").attr("id")+"-"+e+"-"+n.attr("ng-model").replace("component.","").replace("vm.","").replace(/\./g,"/")},t.ngModel&&t.ngModel.indexOf)if(-1!==t.ngModel.indexOf("[script")){var o={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#x2F;":"/","&apos;":"'"},a=t.ngModel.replace(/\[script /g,"<script ").replace(/\]\[\/script\]/g,"><\/script>").replace(/\[script\]/,"<script>").replace(/\[\/script\]/,"<\/script>");t.ngModel=function(e){return String(e).replace(/(&amp;|&lt;|&gt;|&quot;|&#39;|&#x2f;|&apos;)/g,function(e){return o[e]||e})}(a)}else-1!==t.ngModel.indexOf("&lt;!-- more --&gt;")&&(t.ngModel=t.ngModel.replace(/&lt;!-- more --&gt;/,""))}}}]),app.directive("errSrc",function(){"use strict";return{scope:{errSrc:"@"},link:function(e,t,n){e.$watch(function(){return n.ngSrc},function(n){n||t.attr("src",e.errSrc)}),t.bind("error",function(){e.errSrc.length>0&&t.attr("src",e.errSrc)})}}}),angular.module("mainApp").directive("externalScripts",["$sce","externalScriptLookup",function(e,t){"use strict";return{restrict:"E",replace:!0,template:'<span ng-bind-html="externalScripts"></span>',link:function(n){n.externalScripts="";var o=[],a=t;n.$on("external.scripts.page.data",function(t,r){var i=r.page;i&&_.uniq(_.pluck(_.flatten(_.pluck(i.sections,"components")),"type")).forEach(function(t){for(var r in a)a[r].indexOf(t)>-1&&-1===o.indexOf(r)&&(o.push(r),n.externalScripts+="\n\n"+r,n.externalScripts=e.trustAsHtml(n.externalScripts))})})}}}]),app.directive("indInternationalTelNumber",["$timeout","$window",function(e,t){"use strict";return{restrict:"A",require:"ngModel",scope:{form:"@form"},link:function(t,n,o,a){e(function(){"phone"===o.name&&($(n).removeAttr("placeholder"),$(n).intlTelInput({nationalMode:!1,utilsScript:"/js/libs_misc/intl-tel-input/build/js/utils.js"}),t.form&&($(n).on("open:countrydropdown",function(e){$(n).parents("section").addClass("overflow_visible-without-index")}),$(n).on("close:countrydropdown",function(e){$(n).parents("section").removeClass("overflow_visible-without-index")}),t.$watch(function(){return a.$modelValue},function(e){e?t.$parent[t.form][o.name].$setValidity(o.name,$(n).intlTelInput("isValidNumber")):t.$parent[t.form][o.name].$setValidity(o.name,!0)})))},0)}}}]),app.directive("indSlider",["$timeout","$window",function(e,t){"use strict";return{restrict:"A",link:function(n,o,a){e(function(){$(o).slick(n.$eval(a.indSlider))},0),angular.element(t).bind("resize",function(){e(function(){var t=$(o).height(),r=$(o).closest("[testimonials-component]").siblings(".flex-container-absolute-column").height();t<r&&$(o).hasClass("slick-initialized")&&($(o).slick("unslick"),e(function(){n.$apply(function(){$(o).closest("[testimonials-component]").attr("height",r+"px"),$(o).slick(n.$eval(a.indSlider))})},100))},0)})}}}]),angular.module("mainApp").directive("lastItem",["$timeout",function(e){"use strict";return{restrict:"A",link:function(t,n){t.parent=$(n[0].parentElement||n[0].parentNode),t.parent.css("visibility","hidden"),t.$last&&e(function(){t.parent.css("visibility","visible")},350)}}}]),app.directive("stopEvent",function(){"use strict";return{restrict:"A",link:function(e,t,n){t.on(n.stopEvent,function(e){e.stopPropagation()})}}}),function(e,t,n){"use strict";var o=t.module("mrPageEnterAnimate",[]);t.module("mrPageEnterAnimate").provider("Settings",function(){this.settings={completelyVisible:!1},this.$get=function(){var e=this.settings;return{key:function(t){return e[t]||t}}},this.setSettings=function(e){this.settings=e}}),o.directive("mrPageEnter",["Settings","$timeout",function(n,o){return{restrict:"A",link:function(a,r,i){var s=i.mrPageEnter,c=function(t){var o=t[0].getBoundingClientRect();return!0===n.key("completelyVisible")?o.top>=0&&o.left>=0&&o.bottom<=(e.innerHeight||document.documentElement.clientHeight)&&o.right<=(e.innerWidth||document.documentElement.clientWidth):o.bottom>=0&&o.right>=0&&o.top<=(e.innerHeight||document.documentElement.clientHeight)&&o.left<=(e.innerWidth||document.documentElement.clientWidth)},l=function(){!0===c(r)&&(t.element(e).unbind("scroll",l),t.element(e).unbind("resize",l),t.element(e).unbind("load",l),o(function(){r.addClass(s+"-active")},0))};r.addClass(s),t.element(e).bind("scroll",l),t.element(e).bind("resize",l),t.element(e).bind("load",l)}}}])}(window,window.angular),angular.module("mainApp").directive("perfectScrollbar",["$parse","$window","$rootScope",function(e,t,n){"use strict";var o=["wheelSpeed","wheelPropagation","minScrollbarLength","useBothWheelAxes","useKeyboard","suppressScrollX","suppressScrollY","scrollXMarginOffset","scrollYMarginOffset","includePadding"];return{restrict:"EA",transclude:!0,template:"<div><div ng-transclude></div></div>",replace:!0,link:function(a,r,i){var s=angular.element(t),c={},l=function(e){a.$evalAsync(function(){"true"==i.scrollDown&&"mouseenter"!==e&&setTimeout(function(){$(r).scrollTop($(r).prop("scrollHeight"))},100),r.perfectScrollbar("update")})};if(!n.app.isMobile){for(var d=0,u=o.length;d<u;d++){var p=o[d];void 0!==i[p]&&(c[p]=e(i[p])())}a.$evalAsync(function(){r.perfectScrollbar(c);var t=e(i.onScroll);r.scroll(function(){var e=r.scrollTop(),n=r.prop("scrollHeight")-r.height();a.$apply(function(){t(a,{scrollTop:e,scrollHeight:n})})})}),r.bind("mousemove",l),i.refreshOnChange&&a.$watchCollection(i.refreshOnChange,function(){l()}),i.refreshOnResize&&s.on("resize",l),r.bind("$destroy",function(){s.off("resize",l),r.perfectScrollbar("destroy")})}}}}]),mainApp.service("anchorSmoothScroll",function(){"use strict";this.scrollTo=function(e){var t,n=self.pageYOffset?self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0,o=function(e){for(var t=document.getElementById(e),n=t.offsetTop,o=t;o.offsetParent&&o.offsetParent!=document.body;)n+=(o=o.offsetParent).offsetTop;return n}(e),a=o>n?o-n:n-o;if(a<100)this.scrollTo(0,o);else{var r,i=Math.round(a/100),s=Math.round(a/25),c=0;if(i>=20&&(i=20),r=o>n?n+s:n-s,o>n)for(t=n;t<o;t+=s)setTimeout("window.scrollTo(0, "+r+")",c*i),(r+=s)>o&&(r=o),c++;else for(t=n;t>o;t-=s)setTimeout("window.scrollTo(0, "+r+")",c*i),(r-=s)<o&&(r=o),c++}}}),angular.module("mainApp.directives",[]).directive("indigewebSkeuocard",function(){"use strict";return{require:[],restrict:"C",transclude:!1,templateUrl:"../../views/partials/_skeuocard.html",link:function(e){e.card=new Skeuocard($("#skeuocard"))}}}),function(){"use strict";function e(e){return{restrict:"C",link:function(t,n){e(function(){t.$watch(function(){return n.height()},function(e,t){if(e!==t&&n.hasClass("ssb-fixed")){var o=n.attr("id").replace("section_",""),a=angular.element("#clone_of_"+o);a.length&&a.hasClass("ssb-fixed-clone-element")&&a.height(e)}})},200)}}}app.directive("ssbCheckFixed",e),e.$inject=["$timeout"]}(),angular.module("mainApp").directive("userScripts",["accountService","websiteService","$routeParams","$sce","$location",function(e,t,n,o,a){"use strict";return{restrict:"E",replace:!0,template:'<span ng-bind-html="userScripts"></span>',link:function(r,i,s){r.userScripts="";var c=function(){r.userScripts="";var i=a.path().indexOf("/blog")>-1?"blog":n.name;a.$$path.indexOf("/blog/")>-1?i="blog-post":(a.$$path.indexOf("/author/")>-1||a.$$path.indexOf("/category/")>-1||a.$$path.indexOf("/tag/")>-1)&&(i="blog"),i||(i=s.handle),e(function(e,n){n&&void 0!==n.showhide&&void 0!==n.showhide.userScripts&&n.showhide.userScripts&&t(function(e,t){t.resources&&t.resources.userScripts&&t.resources.toggles&&t.resources.toggles.userScripts&&(angular.isDefined(t.resources.userScripts[i])&&(r.userScripts+="\n\n"+t.resources.userScripts[i].sanitized),r.userScripts=o.trustAsHtml(r.userScripts))})})};r.$on("$routeChangeSuccess",function(){c()})}}}]),(mainApp=angular.module("mainApp")).filter("generateURLforLinks",function(){"use strict";return function(e){if(e)switch(e.type){case"page":return"/"+e.data;case"home":return"/";case"url":return e.data;case"section":return e.page&&"index"!==e.page?"/"+e.page+"#"+e.data:"/#"+e.data;case"product":case"collection":return"";case"external":var t=e.data;return!t||/http[s]?/.test(t)||/tel/.test(t)||(t="http://"+t),t;default:return"#"}}}),(mainApp=angular.module("mainApp")).filter("generateURLforProducts",function(){"use strict";return function(e,t){var n="";return e&&(n=t.search("productId",e._id).$$absUrl),n}}),mainApp.filter("offset",function(){"use strict";return function(e,t){if(t=parseInt(t,10),e)return e.slice(t)}}),mainApp.filter("reverse",function(){"use strict";return function(e){return Array.prototype.slice.call(e).reverse()}}),mainApp.filter("unsafe",["$sce",function(e){"use strict";return e.trustAsHtml}]),mainApp.filter("urlFilter",function(){"use strict";return function(e){if(e)return e.replace(/ /g,"").replace(/\./g,"_").replace(/@/g,"").replace(/_/g," ").replace(/\W+/g,"").toLowerCase()}}),mainApp.factory("accountService",["$location","$http",function(e,t){"use strict";var n={};return function(e){0!==Object.getOwnPropertyNames(n).length?e(null,n):window.indigenous.precache&&window.indigenous.precache.account?(n=window.indigenous.precache.account,delete window.indigenous.precache.account,e(null,n)):t.get("/api/1.0/account",{cache:!0}).success(function(t){n=t,e(null,t)}).error(function(t){e(t,null)})}}]),mainApp.service("analyticsService",["$http","$location","ipCookie",function(e,t,n){"use strict";var o,a,r=window.location.href,i=$.url(r),s=new UAParser,c=!1;this.sessionStart=function(a){var r,l,d,u,p,m,g=(new Date).getTime(),h=new Date,f=n("session_cookie"),v=n("permanent_cookie"),b=!0,w={},y=!1,_=document.referrer,C=null;h.setMinutes(h.getMinutes()+30),f&&f.id?(n.remove("session_cookie",{path:"/"}),n("session_cookie",f,{expires:h,path:"/"})):(c=!0,n("session_cookie",{id:Math.uuid()},{expires:h,path:"/"})),void 0===v?n("permanent_cookie",{id:Math.uuid()},{expires:3650,path:"/"}):b=!1,r=(l={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/WPDesktop/i)},any:function(){return l.Android()||l.BlackBerry()||l.iOS()||l.Opera()||l.Windows()}}).any()?"mobile":"desktop",d=(new Fingerprint).get(),u=jstz.determine(),o={session_id:n("session_cookie").id,permanent_tracker:n("permanent_cookie").id,user_agent:{browser:s.getBrowser(),engine:s.getEngine(),os:s.getOS(),device:r},ip_address:"${keen.ip}",fingerprint:d.toString(),session_start:g,session_length:0,timezone:u.name(),new_visitor:b,entrance:i.attr("path"),fullEntrance:t.absUrl()},t.search().utm_source&&(y=!0,w.utm_source=t.search().utm_source),t.search().utm_medium&&(y=!0,w.utm_medium=t.search().utm_medium),t.search().utm_campaign&&(y=!0,w.utm_campaign=t.search().utm_campaign),t.search().utm_term&&(y=!0,w.utm_term=t.search().utm_term),t.search().utm_content&&(y=!0,w.utm_content=t.search().utm_content),y&&(o.campaign=w),void 0!==_&&(C={source:(p=$.url(_)).attr("source"),protocol:p.attr("protocol"),domain:p.attr("host"),port:p.attr("port"),path:p.attr("path"),anchor:p.attr("anchor")}),o.referrer=C,o.source_type=this.getSourceType(p.attr("host")),m="/api/1.0/"+["analytics","session",n("session_cookie").id,"sessionStart"].join("/"),e.post(m,o).success(function(e){a(e)})},this.getSourceType=function(e){var t="direct",n=["google.com","daum.net","eniro.se","naver.com","yahoo.com","msn.com","bing.com","aol.com","lycos.com","ask.com","altavista.com","search.netscape.com","cnn.com/SEARCH","about.com","mamma.com","alltheweb.com","voila.fr","search.virgilio.it","baidu.com","alice.com","yandex.com","najdi.org.mk","aol.com","mamma.com","seznam.cz","search.com","wp.pl","online.onetcenter.org","szukacz.pl","yam.com","pchome.com","kvasir.no","sesam.no","ozu.es","terra.com","mynet.com","ekolay.net","rambler.ru"];return e&&(t="referral"),-1!==n.indexOf(e)&&(t="organic"),t},this.pageStart=function(t){var o,r,s,l=this,d=(new Date).getTime(),u=n("session_cookie");if(i=$.url(window.location.href),o=i,u&&u.id){r=n("session_cookie").id||Math.uuid(),a={url:{source:o.attr("source"),protocol:o.attr("protocol"),domain:o.attr("host"),port:o.attr("port"),path:o.attr("path"),anchor:o.attr("anchor")},pageActions:[],start_time:d,end_time:0,session_id:r,entrance:c},c=!1;var p={ev:"pg",fe:o.attr("source"),sid:r+"-collect"};s="/api/1.0/"+["analytics","session",r,"pageStart"].join("/"),e.post(s,a).success(function(e){l.collect(p,t)})}else this.sessionStart(void 0)},this.pagePing=function(){var t,o=a;o.ping_time=(new Date).getTime(),n("session_cookie")&&(t="/api/1.0/"+["analytics","session",n("session_cookie").id,"ping"].join("/"),e.post(t,o))},this.getGeoSearchAddress=function(t,n){var o="/api/1.0/"+["geo","search","address",t].join("/");e.get(o).success(function(e){n(e)})},this.collectPage=function(e,t){var o=this,a=n("session_cookie"),r=$.url(window.location.href);if(a&&a.id){var i=n("session_cookie").id||Math.uuid(),s={ev:"pg",fe:r.attr("source"),sid:i};e||(s.ev="p"),o.collect(s,t)}else o.collect(null,function(){var a=n("session_cookie").id||Math.uuid(),i={ev:"pg",fe:r.attr("source"),sid:a};e||(i.ev="p"),o.collect(i,t)})},this.collect=function(o,a){var r,i,l,d,u,p,m=this,g=((new Date).getTime(),new Date),h=n("session_cookie"),f=n("permanent_cookie"),v=!0,b={},w=!1,y=document.referrer;o||(g.setMinutes(g.getMinutes()+30),h&&h.id?(n.remove("session_cookie",{path:"/"}),n("session_cookie",h,{expires:g,path:"/"})):(c=!0,n("session_cookie",{id:Math.uuid()},{expires:g,path:"/"})),void 0===f?n("permanent_cookie",{id:Math.uuid()},{expires:3650,path:"/"}):v=!1,r=(i={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/WPDesktop/i)},any:function(){return i.Android()||i.BlackBerry()||i.iOS()||i.Opera()||i.Windows()}}).any()?"mobile":"desktop",l=(new Fingerprint).get(),d=jstz.determine(),(o={}).sid=n("session_cookie").id,o.pt=n("permanent_cookie").id,o.ev="s",s.getBrowser()&&(o.uabn=s.getBrowser().name,o.uabv=s.getBrowser().version,o.uabm=s.getBrowser().major),s.getEngine()&&(o.uaen=s.getEngine().name,o.uaev=s.getEngine().version),s.getOS()&&(o.uaon=s.getOS().name,o.uaov=s.getOS().version),o.uad=r,o.f=l.toString(),o.t=d.name(),o.nv=v,o.fe=t.absUrl(),t.search().utm_source&&(w=!0,b.utm_source=t.search().utm_source),t.search().utm_medium&&(w=!0,b.utm_medium=t.search().utm_medium),t.search().utm_campaign&&(w=!0,b.utm_campaign=t.search().utm_campaign),t.search().utm_term&&(w=!0,b.utm_term=t.search().utm_term),t.search().utm_content&&(w=!0,b.utm_content=t.search().utm_content),w&&(o.utms=b.utm_source,o.utmm=b.utm_medium,o.utmc=b.utm_campaign,o.utmt=b.utm_term,o.utmct=b.utm_content),void 0!==y&&(u=$.url(y),o.r=u.attr("source"),o.st=m.getSourceType(u.attr("host")))),p="/api/2.0/analytics/collect",e.get(p,{params:o}).success(function(e){a(e)})}}]),mainApp.service("campaignService",["$http",function(e){"use strict";this.addContactToCampaign=function(t,n,o){var a="/api/1.0/"+["campaigns",t,"contact",n].join("/");e({url:a,method:"POST"}).success(function(e){o(e)}).error(function(e){})},this.getCampaign=function(t,n){var o="/api/1.0/"+["campaigns",t].join("/");e({url:o,method:"GET"}).success(function(e){n(e)}).error(function(e){})}}]),function(){"use strict";function e(e){function t(e,t){angular.isDefined(e)||(e=0),angular.isDefined(t)||(t=!1);var a=0,r=0,i=0,s=0,c=0,l=0,d=0,u=0,p={chargeType:null,charge:null};o.commerceSettings&&o.commerceSettings.shipping&&o.commerceSettings.shipping.enabled&&(p.chargeType=o.commerceSettings.shipping.chargeType,p.charge=o.commerceSettings.shipping.charge||0),_.each(o.items,function(e){var t=e.regular_price;n(e)&&(t=e.sale_price),a=parseFloat(a)+parseFloat(t)*e.quantity,e.taxable&&o.showTax&&(c+=t*e.quantity),e.taxable||(o.showNotTaxed=!0),p.chargeType&&("item"===p.chargeType?e.shipping_charges&&e.shipping_charges.item_override_charge?l+=e.quantity*e.shipping_charges.item_override_charge:d=d+=e.quantity*parseFloat(p.charge):"order"===p.chargeType&&e.shipping_charges&&e.shipping_charges.item_order_additive_charge&&(l+=e.quantity*e.shipping_charges.item_order_additive_charge))}),"order"===p.chargeType?u=l+parseFloat(p.charge):"item"===p.chargeType&&(u=l+d),e&&!t?e/=100:e&&t&&(e=a*e/100),c>0&&(r=(c-e)*parseFloat(o.taxPercent)/100),r<0&&(r=0),o.isStateTaxable&&(i=u*parseFloat(o.taxPercent)/100),s=r+i,o.subTotal=a,o.cartTax=r,o.shippingTax=i,o.totalDiscount=e,o.totalShipping=u,o.totalTax=s,o.total=a+s+u-e>0?a+s+u-e:0}function n(e){if(e.on_sale){if(e.sale_date_from&&e.sale_date_to){var t=new Date,n=new Date(e.sale_date_from),o=new Date(e.sale_date_to);return n<=t&&t<=o}return!0}}var o={};return o.getCartItems=function(){return o.items},o.addItemToCart=function(e,n,a){o.items.push(e),o.items.forEach(function(e){"SUBSCRIPTION"===e.type&&(o.hasSubscriptionProduct=!0)}),t(n,a)},o.calculateTotalCharges=t,o.checkOnSale=n,o.removeItemFromCart=function(e,n,a){var r=_.filter(o.items,function(t){return t._id!==e._id});o.items=r,o.hasSubscriptionProduct=!1,o.items.forEach(function(e){"SUBSCRIPTION"===e.type&&(o.hasSubscriptionProduct=!0)}),t(n,a)},o.checkIfStateTaxable=function(n,a,r){if(n&&o.commerceSettings&&o.commerceSettings.shipping&&o.commerceSettings.shipping.enabled){var i=_.filter(e,function(e){return e.abbr===n});i&&i.length?o.isStateTaxable=!1:o.isStateTaxable=!0,t(a,r)}},o.productViewLoaded=!1,o.total=0,o.cartTax=0,o.subTotal=0,o.showTax=!1,o.taxPercent=0,o.showNotTaxed=!1,o.hasSubscriptionProduct=!1,o.shippingTax=0,o.totalTax=0,o.totalDiscount=0,o.commerceSettings={},o.isStateTaxable=!1,o.items=[],o}mainApp.factory("CartDetailsService",e),e.$inject=["nonShippingChargeStates"]}(),function(){"use strict";app.service("commonService",[function(){this.generateUniqueAlphaNumericShort=function(){return this.generateUniqueAlphaNumeric()},this.generateUniqueAlphaNumeric=function(e,t,n){if(null!==e&&0!==e||(e=10),e<=10&&!0!==t&&e<=10){var o=((new Date).getTime()*parseInt(1e3*(Math.random()+1))+(new Date).getTime()).toString(36);return isNaN(o)?this.generateUniqueAlphaNumeric():o.substring(0,e)}var a,r={min:49,max:57},i={min:65,max:90},s={min:97,max:122},c=[];for(a=s.min;a<=s.max;a++)c.push(String.fromCharCode(a));if(!0!==n)for(a=i.min;a<=i.max;a++)c.push(String.fromCharCode(a));if(!0!==t){var l,d=c.length/10/2;for(l=0;l<d;l++)for(a=r.min;a<=r.max;a++)c.push(String.fromCharCode(a))}for(var u="",p=c.length,m=null;u.length<e;)null!==(m=c[Math.round(Math.random()*p)])&&(u+=m);return u}}])}(),mainApp.service("contactService",["$http",function(e){"use strict";this.getContact=function(t,n){var o="/api/1.0/"+["contact",t].join("/");e.get(o).success(function(e){n(e)})},this.putContact=function(t,n){var o="/api/1.0/"+["contact"].join("/");e.put(o,t).success(function(e){n(e)})},this.getAddressByType=function(e,t){return e.details&&e.details.length>0&&e.details&&e.details[0].addresses&&e.details[0].addresses.length>0?("billing"===t?_.findWhere(e.details[0].addresses,{defaultBilling:!0}):_.findWhere(e.details[0].addresses,{defaultShipping:!0}))||"":""},this.getGeoSearchAddress=function(t,n){var o="/api/1.0/"+["geo","search","address",t].join("/");e.get(o).success(function(e){n(e)})},this.postCsvContacts=function(t,n){var o="/api/1.0/"+["contact","importcsv"].join("/");e.post(o,t).success(function(e){n(e)})}}]),mainApp.factory("embeddedSiteDataService",["$http","$location","$cacheFactory",function(e,t){"use strict";function n(){var e=t.$$path.toLowerCase().replace("/page/","");return"/"!==e&&""!==e||(e="index"),"/signup"===e&&(e="signup"),"/trial"===e&&(e="trial"),e.indexOf("blog/")>-1&&(e=!0===window.indigenous.ssbBlog?"blog-post":"single-post"),e.indexOf("post/")>-1&&(e="single-post"),("blog"===e||"/blog"===e||"blog-list"===e||"/blog-list"===e||e.indexOf("tag/")>-1||e.indexOf("category/")>-1||e.indexOf("author/")>-1)&&(e=!0===window.indigenous.ssbBlog?"blog-list":"blog"),0===e.indexOf("/")&&(e=e.replace("/","")),e}var o={};return o.urlPathFallbacks=n,o.getSiteData=function(){window.indigenous&&window.indigenous.precache&&window.indigenous.precache.siteData&&(o.siteData=window.indigenous.precache.siteData)},o.getPageData=function(e,t){o.path=n(),void 0!==o.siteData.pages[o.path]?t(null,o.siteData.pages[o.path]):t("page not found",null)},o.getPostData=function(e){void 0!==o.siteData.posts?e(null,o.siteData.posts):e("posts not found")},o.getSiteData(),o}]),mainApp.service("geocodeService",["$http",function(e){"use strict";this.getGeoSearchAddress=function(t,n){var o="/api/1.0/"+["geo","search","address",t].join("/");e.get(o).success(function(e){n(e)})},this.stringifyAddress=function(e,t){if(e&&(e.address||e.address2||e.city||e.state||e.zip)){var n=" ",o=_.filter([e.address,e.address2],function(e){return""!==e}).join(", "),a=_.filter([e.city,e.state,e.zip],function(e){return""!==e}).join(", ");return o?(t&&(n=" <br> "),o+n+a):a}},this.validateAddress=function(e,t){if("object"==typeof google){var n=new google.maps.Geocoder,o=new google.maps.LatLng(e.lat,e.lon),a=this.stringifyAddress(e);e.city||e.state||e.zip?n.geocode({latLng:o,address:a},function(e,n){n===google.maps.GeocoderStatus.OK?t(!0,e):t(!1,null)}):t(!1,null)}else t(!1,null)},this.getLocations=function(t,n,o){var a="/api/1.0/geo/locations?lat="+t+"&lon="+n+"&d="+o;return e.get(a)},this.getAllLocations=function(){return e.get("/api/1.0/geo/all/locations")},this.getDirectionsLinkGoogle=function(e,t){return"//maps.google.com/maps?saddr="+encodeURIComponent(e||"")+"&daddr="+encodeURIComponent(t)}}]),mainApp.service("orderService",["$http",function(e){"use strict";var t="/api/1.0/";this.createOrder=function(n,o){var a=t+["orders"].join("/");e({url:a,method:"POST",data:angular.toJson(n)}).success(function(e){o(e)}).error(function(e){o(e)})},this.createPaypalOrder=function(n,o){var a=t+["orders","payment","paypal"].join("/");e({url:a,method:"POST",data:angular.toJson(n)}).success(function(e){o(e)}).error(function(e){o(e)})},this.getOrder=function(n,o){var a=t+["orders",n].join("/");e({url:a,method:"GET"}).success(function(e){o(e)}).error(function(e){o(e)})},this.setOrderPaid=function(n,o){var a=t+["orders",n._id,"paid"].join("/");e({url:a,method:"POST",data:angular.toJson(n)}).success(function(e){o(e)}).error(function(e){o(e)})},this.deletePaypalOrder=function(n,o){var a=t+["orders",n._id,"paypal"].join("/");a=a+"?payKey="+n.payment_details.payKey,e({url:a,method:"DELETE"}).success(function(e){o(e)}).error(function(e){o(e)})},this.getEstimatedTax=function(n,o){var a=t+["orders","estimatedTax"].join("/");e({url:a,method:"POST",data:angular.toJson(n)}).success(function(e){o(e)}).error(function(e){o(e)})},this.checkForInactiveProducts=function(n,o){var a=t+["orders","inactiveProducts"].join("/");e({url:a,method:"POST",data:angular.toJson(n)}).success(function(e){o(e,null)}).error(function(e){o(null,e)})}}]),mainApp.service("pageService",["$http",function(e){"use strict";this.createPage=function(t,n,o){var a="/api/1.0/"+["cms","website",t,"page"].join("/");e({url:a,method:"POST",data:angular.toJson(n)}).success(function(e){o(e)}).error(function(){})},this.addNewComponent=function(t,n,o,a,r){var i="/api/1.0/"+["cms","page",t,"components"].join("/"),s={title:n,type:o,cmpVersion:a};e({url:i,method:"POST",data:angular.toJson(s)}).success(function(e){r(e)}).error(function(){})}}]),mainApp.service("paymentService",["$http","ENV","$timeout",function(e,t,n){"use strict";var o="/api/1.0/";!function e(){if("function"!=typeof Stripe)return n(e,50);Stripe.setPublishableKey(t.stripeKey)}(),this.getStripeCardToken=function(e,t){Stripe.card.createToken(e,function(e,n){t(n.id,n.error)})},this.postStripeCustomer=function(t,n,a,r){var i=o+["integrations","payments","customers"].join("/");e.post(i,{cardToken:t,user:n,accountId:a}).success(function(e){r(e)})},this.putCustomerCard=function(t,n,a){var r=o+["integrations","payments","customers",t,"cards",n].join("/");e.put(r).success(function(e){a(e)})},this.getStripeCustomer=function(t){var n=o+["integrations","payments","customers"].join("/");e.get(n).success(function(e){t(e)})},this.getListPlans=function(t){var n=o+["integrations","payments","plans"].join("/");e.get(n).success(function(e){t(e)})},this.postCreateStripeSubscription=function(t,n,a){var r=o+["integrations","payments","customers",t,"subscriptions"].join("/");e.post(r,{plan:n}).success(function(e){ToasterService.show("success","Subscribed to plan."),a(e)})},this.saveCartDetails=function(t,n,a){var r=o+["integrations","payments","charges"].join("/");e.post(r,{amount:n,currency:"usd",card:t}).success(function(e){a(e)})},this.getPlanPromise=function(t){var n=o+["integrations","payments","plans",t].join("/");return e.get(n)},this.validateCoupon=function(t,n){var a=o+["integrations","payments","coupon",t,"validate"].join("/");e.get(a).success(function(e){n(e)}).error(function(e){n(null,e)})},this.validateIndigenousCoupon=function(t,n){var a=o+["integrations","payments","org","coupons",t,"validate"].join("/");e.get(a).success(function(e){n(e)})}}]),mainApp.service("postService",["$http","$q",function(e,t){"use strict";var n="/api/1.0/";this.getAllPosts=function(t){var o=n+["cms","blog"].join("/");e.get(o).success(function(e){t(e)})},this.getSinglePost=function(t,o,a){var r=n+["cms","website",o,"blog",t].join("/");e.get(r).success(function(e){a(e)}).error(function(e){a(e,null)})},this.getAllPostsByPageId=function(t,o){var a=n+["cms","page",t,"blog"].join("/");e.get(a).success(function(e){o(e)})},this.createPost=function(t,o,a){var r=n+["cms","page",t,"blog"].join("/");e({url:r,method:"POST",data:angular.toJson(o)}).success(function(e){a(e)}).error(function(){})},this.deletePost=function(t,o,a){var r=n+["cms","page",t,"blog",o].join("/");e({url:r,method:"DELETE"}).finally(function(){a()})},this.updatePost=function(t,o,a,r){var i=n+["cms","page",t,"blog",o].join("/");e({url:i,method:"POST",data:angular.toJson(a)}).success(function(e){r(e)}).error(function(e){r(e,null)})},this.sharePostOnFacebook=function(t,o){var a=n+["social","facebook","share","link"].join("/");e({url:a,method:"POST",data:angular.toJson(t)}).success(function(e){o(e)}).error(function(e){o(e,null)})},this.sharePostOnLinkedIn=function(t,o){var a=n+["social","linkedin","share","link"].join("/");e({url:a,method:"POST",data:angular.toJson(t)}).success(function(e){o(e)}).error(function(e){o(e,null)})},this.sharePostOnTwitter=function(t,o){var a=n+["social","twitter","status"].join("/");e({url:a,method:"POST",data:angular.toJson(t)}).success(function(e){o(e)}).error(function(e){o(e,null)})},this.isValidImage=function(e){var n=t.defer(),o=new Image;return o.onerror=function(){n.resolve(!1)},o.onload=function(){n.resolve(!0)},o.src=e,n.promise}}]),mainApp.factory("postsService",["accountService","$http",function(e,t){"use strict";var n=this;return function(o){n.posts?o(null,n.posts):e(function(e,n){e?o(e,null):t.get("/api/1.0/cms/blog",{cache:!0}).success(function(e){null!==e?o(null,e):o("post not found")}).error(function(e){o(e)})})}}]),mainApp.factory("previewPagesService",["$http","$location",function(e,t){"use strict";function n(t,n){window.indigenous&&window.indigenous.precache&&e.get("/api/1.0/cms/page/"+t+"/blog/preview/"+n,{cache:!1}).success(function(e){window.indigenous.precache.siteData.post=e}).error(function(e){})}function o(t,n){window.indigenous&&window.indigenous.precache&&e.get("api/1.0/cms/blog",{cache:!0}).success(function(e){window.indigenous.precache.siteData.posts=e,n(null,t)}).error(function(e){n(e,t)})}return function(a,r){var i=t.$$path.toLowerCase().replace("/preview/",""),s=i;return 0===i.indexOf("/")?s=i.replace("/",""):-1!==i.indexOf("/")&&n(s=i.split("/")[0],i.split("/")[1]),e.get("/api/2.0/cms/pages/"+s,{cache:!0}).success(function(e){var t=_.pluck(_.flatten(_.pluck(e.sections,"components")),"type"),n=_.contains(t,"ssb-blog-post-list")||_.contains(t,"ssb-recent-post")||_.contains(t,"ssb-recent-tag")||_.contains(t,"ssb-recent-category");"blog-list"===e.handle||"blog-post"===e.handle||n?o(e,function(e,t){r(e,t)}):r(null,e)}).error(function(e){r(e)})}}]),mainApp.service("productService",["$http",function(e){"use strict";var t="/api/1.0/products";this.getProduct=function(n,o){var a=[t,n].join("/");e.get(a).success(function(e){o(e)})},this.getAllProducts=function(t){e.get("/api/1.0/products",{cache:!0}).success(function(e){t(e)})},this.getActiveProducts=function(n,o){var a=[t,"active"].join("/"),r=!n;e.get(a,{cache:r}).success(function(e){o(e)})},this.getTax=function(n,o){var a=[t,"tax",n].join("/");e.get(a).success(function(e){o(e)})},this.getAllOrdersForProduct=function(n,o){var a=[t,n,"orders"].join("/");e.get(a).success(function(e){o(e)})},this.getDonationOrdersForProduct=function(n,o){var a=[t,n,"donation/orders"].join("/");e.get(a).success(function(e){o(e)})}}]),function(){"use strict";mainApp.factory("SsbPageSectionService",function(){var e={};return e.offset=0,e.getSectionOffset=function(){return e.offset},e.setSectionOffset=function(t){e.offset=t},e})}(),mainApp.service("userService",["$http","ipCookie",function(e,t){"use strict";var n="/api/1.0/";this.addContact=function(t,o){var a=n+["contact","signupnews"].join("/");e({url:a,method:"POST",data:angular.toJson(t)}).success(function(e){o(e,null)}).error(function(e){o(null,e)})},this.postContact=function(t,o){var a=n+["contact"].join("/");e({url:a,method:"POST",data:angular.toJson(t)}).success(function(e){o(e,null)}).error(function(e){o(null,e)})},this.createUser=function(t,o){var a=n+["user"].join("/");e({url:a,method:"POST",data:angular.toJson(t)}).success(function(e){o(e)}).error(function(e){})},this.createCustomerUser=function(t,o){var a=n+["user","member"].join("/");e({url:a,method:"POST",data:angular.toJson(t)}).success(function(e){o(e)}).error(function(e){})},this.initializeUser=function(o,a){o.session_permanent=t("permanent_cookie"),o.fingerprint=(new Fingerprint).get();var r=n+["user","initialize"].join("/");e({url:r,method:"POST",data:angular.toJson(o)}).success(function(e){a(null,e)}).error(function(e){a(e,null)})},this.checkDomainExists=function(t,o){var a=n+["account",t,"available"].join("/");e({url:a,method:"GET"}).success(function(e){o(null,e)}).error(function(e){o(e,null)})},this.checkEmailExists=function(t,o){var a=n+["user","exists",t].join("/");e({url:a,method:"GET"}).success(function(e){o(e)}).error(function(e){})},this.checkDuplicateEmail=function(t){var o=n+["user","exists",t].join("/");return e.get(o)},this.getTmpAccount=function(t){var o=n+["account","tmp"].join("/");e({url:o,method:"GET"}).success(function(e){t(e)}).error(function(e){})},this.getLoggedInUser=function(t){var o=n+["user"].join("/");e({url:o,method:"GET"}).success(function(e){t(e)}).error(function(e){})},this.isAuthenticatedSession=function(t){var o=n+["user","authenticated"].join("/");e({url:o,method:"GET"}).success(function(e){t(e.currentSession)}).error(function(e){t(!1)})},this.saveOrUpdateTmpAccount=function(t,o){var a=n+["account","tmp"].join("/");e({url:a,method:"POST",data:angular.toJson(t)}).success(function(e){o(e)}).error(function(e){})},this.postAccountBilling=function(t,o,a){var r=n+["account","billing"].join("/");e.post(r,{stripeCustomerId:t,cardToken:o}).success(function(e){a(e)})},this.addContactActivity=function(t,o){var a=n+["contact","activity"].join("/");e({url:a,method:"POST",data:angular.toJson(t)}).success(function(e){o(e)}).error(function(e){o(e)})}}]),mainApp.factory("websiteService",["accountService","$http",function(e,t){"use strict";var n={};return function(o){0!==Object.getOwnPropertyNames(n).length?o(null,n):e(function(e,a){e||!a?o(e,null):a?t.get("/api/1.0/cms/website/"+a.website.websiteId,{cache:!0}).success(function(e){e&&(n=e),o(null,e)}).error(function(e){o(e,null)}):o("data is null",null)})}}]);