<!--
CONTACTS MAIN VIEW
-->
<script type="text/x-handlebars-template" name="contacts-main">
    <div id="contacts-main-container">

        <div class="row">
            <strong style="font-size:1.5em; text-align:center" class="col-xs-2 col-sm-offset-5">Contacts</strong>

            <div class="col-xs-1 col-xs-offset-9 visible-xs">
                <div class="btn-link" style="font-size:2em; text-align:">+</div>
            </div>

            <div class="hidden-xs" style="margin-bottom:5px;">
                <button type="button" class="btn btn-primary btn-sm hidden-xs">Add contact</button>
            </div>
        </div>


        <div class="form form-horizontal">
            <div class="form-group">
                <label class="col-xs-1 hidden-md hidden-lg col-sm-1 control-label">{{currentLetter}}</label>
                <div class="col-xs-11 col-sm-11 col-md-12">
                    <input type="text" placeholder="search contacts" class="form-control col-xs-12"/>
                </div>
            </div>
        </div>

        {{> contact-paginator}}

        <div class="row">
            <ul class="pull-right hidden-md hidden-lg unstyled col-sm-1" style="margin-top:15px;">
                {{#eachLetter}}
                <li><a class="btn-letter" href="#">{{letter}}</a></li>
                {{/eachLetter}}
            </ul>

            <div id="contacts-list-container" class="col-sm-11 col-md-12">
                {{#each contacts}}
                <div class="col-xs-11 col-sm-6 col-md-4 contact-thumbnail">
                    <div class="inner btn-view-contact-details" data-contactid="{{_id}}">
                        <strong>{{first}} {{middle}} {{last}}</strong> <span class="visible-inline-xs"><small>{{contactTypeLabel}}</small></span>
                        <div class="hidden-xs"><small>{{contactTypeLabel}}</small></div>

                        <div class="contacts-photo-container">
                            <img class="img-circle" src="{{#if photo}}{{photo}}{{else}}/assets/icons/blank-user.jpeg{{/if}}">
                        </div>

                        <div class="hidden-xs contact-thumbnail-details">
                            <div>Last Active: </div>
                            <div>Purchased: </div>
                            <div>Emails Opened: </div>
                            <div>Calls Made: </div>
                        </div>

                        <div class="contact-thumbnail-actions hidden-xs">
                            <div class="fa fa-envelope-o" title="send-message"/>
                        </div>
                    </div>
                </div>
                {{else}}

                <div class="visible-xs col-xs-10">
                    <h3>No Records Available</h3>
                </div>

                <div class="visible-xs btn btn-primary col-xs-8">Add a new contact</div>
                {{/each}}

                {{#iterateDifference min count 0}}
                <div class="col-xs-11 col-sm-6 col-md-4 contact-thumbnail hidden-xs {{#if $last}}hidden-md hidden-lg{{/if}}">
                    <div class="inner">
                        <strong>Create new Contact</strong>

                        <div class="contacts-photo-container">
                            <img class="img-circle" src="/assets/icons/blank-user.jpeg">
                        </div>

                        <div class="hidden-xs">
                            <div class="btn btn-success btn-add-contact">Add Contact</div>
                        </div>

                    </div>
                </div>
                {{/iterateDifference}}
            </div>
        </div>


        {{> contact-paginator}}
    </div>
</script>


<script type="text/x-handlebars-template" name="contact-paginator" partial="true">
    <ul class="pagination hidden-sm hidden-xs">
        {{#eachLetter}}
        <li class="{{#check currentLetter letter}}active{{/check}}"><a class="btn-letter" href="#">{{letter}}</a></li>
        {{/eachLetter}}
    </ul>
</script>
<!-- END CONTACTS MAIN -->


<!--
CONTACT DETAILS VIEW
-->
<script type="text/x-handlebars-template" name="contact-details-main">
    <div id="contact-details-container">
        <div class="row">
            <div class="col-md-6">
                {{> contact-details}}
            </div>

            <div class="col-md-6">
                {{> contact-activity}}
            </div>
        </div>

    </div>
</script>


<script type="text/x-handlebars-template" name="contact-details" partial="true">
    <span id="btn-back-to-contacts" class="btn-link"><i class="fa fa-angle-left"/></span>
    <span id="contact-name">{{contact.first}} {{contact.middle}} {{contact.last}}</span>
    <div id="btn-edit-contact-primary" class="btn-edit-contact btn btn-xs btn-primary hidden-xs">Edit</div>

    <div id="contact-type"><small>{{contactTypeLabel contact}}</small></div>

    <div class="contact-photo-container">
        <img class="img-circle" src="{{#if contact.photo}}{{contact.photo}}{{else}}/assets/icons/blank-user.jpeg{{/if}}">
    </div>

    <div id="contact-summary">
        <div>Last Active: </div>
        <div>Purchased: </div>
        <div>Emails Opened: </div>
        <div>Calls Made: </div>
    </div>

    <div id="contact-information">
        <h4>Contact Information</h4>
        <hr/>

        <div id="phone-row" class="row">
            <div class="col-xs-1"><i class="icon-main fa fa-phone"/> </div>
            <div class="col-xs-10">
                {{#each contact.details}}
                    {{#each phones}}
                        <div>
                            <a href="tel:{{number}}">{{number}}</a> <small>{{phoneTypeLabel type}}</small> <i class="icon-social {{iconFromType ../type}}"/>
                        </div>
                    {{/each}}
                {{/each}}
            </div>
        </div>

        <div id="address-row" class="row">
            <div class="col-xs-1"><i class="icon-main fa fa-map-marker"/> </div>
            <div class="col-xs-10">
                {{#each contact.details}}
                    {{#if address}}
                        {{#with address}}
                            {{#if address}}<div>{{address}}</div>{{/if}}
                            {{#if address2}}</div>{{address2}}</div>{{/if}}
                            <div>
                                {{city}}, {{state}}, {{zip}} {{#if country}}, {{country}}{{/if}} <i class="icon-social {{iconFromType ../../type}}"/>
                            </div>
                        {{/with}}
                    {{/if}}
                {{/each}}
            </div>
        </div>

        <div id="email-row" class="row">
            <div class="col-xs-1"><i class="icon-main fa fa-envelope"/></div>
            <div class="col-xs-10">
                {{#each contact.details}}
                    {{#if email}}
                        <a href="mailto:{{email}}">{{email}}</a> <i class="icon-social {{iconFromType ../type}}"/>
                    {{/if}}
                {{/each}}
            </div>
        </div>

        <div id="btn-edit-contact-mobile" class="btn-edit-contact visible-xs col-12-xs btn btn-primary">Edit Contact</div>
    </div>

</script>


<script type="text/x-handlebars-template" name="contact-activity" partial="true">

</script>
<!-- END CONTACT DETAILS VIEW -->


<!--
CONTACTS EDIT VIEW
-->
<script type="text/x-handlebars-template" name="contact-edit-main">
    <div id="contact-edit-container">
        <div class="row">
            <div class="col-md-6">
                <!-- UPDATE NAME -->
                <div class="form" role="form">
                    <div class="form-group">
                        <label class="sr-only">Full Name</label>
                        <input id="input-fullname" type="text" class="form-control" value="{{contact.first}} {{contact.middle}} {{contact.last}}" placeholder="full name">
                        <small style="margin-left:10px;">
                            <strong>first:</strong> <code><span id="hint-first">{{contact.first}}</span></code>
                            <strong>middle:</strong> <code><span id="hint-middle">{{contact.middle}}</span></code>
                            <strong>last:</strong> <code><span id="hint-last">{{contact.last}}</span></code>
                        </small>
                    </div>
                </div>

                <!-- UPDATE PHOTO -->
                <div id="contact-photo-container">
                    <img id="contact-photo" class="img-circle hand" src="{{#if contact.photo}}{{contact.photo}}{{else}}/assets/icons/blank-user.jpeg{{/if}}">
                    <div class="btn-edit-photo img-circle hand">
                        <div class="edit-photo-controls">
                            <i class="fa fa-upload btn-upload-photo" title="Upload new photo"/>
                            <i class="fa fa-times-circle-o btn-remove-photo" title="Remove photo"/>
                        </div>
                    </div>

                    <div class="btn-edit-photo-mobile hidden-md hidden-lg">
                        <div class="btn btn-primary btn-remove-photo">Remove Photo</div>
                        <div class="btn btn-primary btn-upload-photo">Upload Photo</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modal-change-photo" tabindex="-1" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Add or Remove Photo</h4>
                </div>

                <div class="modal-body">
                    <div class="btn-group-vertical">

                    </div>
                    <div class="row">
                        <div class="btn btn-primary col-xs-12">Remove Photo</div>
                    </div>

                    <div class="row" style="margin-top:6px;">
                        <div id="btn-upload-photo-modal" class="btn btn-primary col-xs-12">Upload new photo</div>
                    </div>

                    <br/>

                    <div id="upload-photo-container"/>
                </div>
            </div>
        </div>
    </div>
</script>
<!-- END CONTACT EDIT VIEW -->



<!--
HELPERS
-->
<script type="text/javascript">
    Handlebars.registerHelper("eachLetter", function(options) {
        var charCode = "A".charCodeAt();
        var str = "";
        for (var i = 0; i < 26; i++) {
            this.letter = String.fromCharCode(charCode);
            str += options.fn(this);
            //str += options.fn(String.fromCharCode(charCode));
            charCode++;
        }
        return str;
    });


    Handlebars.registerHelper("contactTypeLabel", function(contact) {
        if (contact == null) {
            contact = this;
        }
        switch(contact.type) {
            case "cu": return "Customer";
            case "co": return "Colleague";
            case "fr": return "Friend";
            case "mb": return "Member";
            case "fa": return "Family";
            case "ad": return "Admin";
        }
        return "";
    });


    Handlebars.registerHelper("phoneTypeLabel", function(type) {
        switch(type) {
            case "m": return "mobile";
            case "w": return "work";
            case "h": return "home";
        }
        return "";
    });

    Handlebars.registerHelper("iconFromType", function(type) {
        switch(type) {
            case "lo": return "";
            case "fb": return "fa fa-facebook";
            case "tw": return "fa fa-twitter";
            case "li": return "fa fa-linkedin";
            case "go": return "fa fa-google-plus";
        }
    });
</script>