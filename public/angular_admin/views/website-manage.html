<toaster-container toaster-options="{{toasterOptions}}"></toaster-container>
<div ng-if="showOnboarding">
    <onboarding-popover enabled='showOnboarding' steps='onboardingSteps' step-index='stepIndex'></onboarding-popover>
</div>
<div class="website-manage">
    <div class="pageheader row">
        <div class="col-xs-5">
            <h2><i class="fa fa-desktop"></i> Website</h2>
        </div>

        <div class="col-xs-7">
            <a class="btn btn-success pull-right media-modal" on-insert-mediacb="insertMedia" user='user' data-main='true'>
                <i class="fa fa fa-image"></i>
                <span class="hidden-xs">Media</span>
            </a>
            <div class="btn-group pull-right btn-add" ng-show="!isEditing" style="margin-right: 10px;">
                <button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown">
                    <i class="fa fa-plus"></i>
                    <span class="hidden-xs">Add</span>
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="" data-toggle="modal" data-target="#create-page-modal"> Page</a>
                    </li>
                    <li><a href="" data-toggle="modal" data-target="#create-post-modal"> Post</a>
                    </li>
                </ul>
            </div>

        </div>
    </div>

    <div class="header-menu-row">
        <div class="btn-group col-xs-12 template-btns">
            <button type="button" class="btn btn-default btn-lg col-xs-4 btn-view-themes" ng-class="{'active': activeTab === 'themes'}" ng-click="showToaster = false; activeTab = 'themes'">
                <i class="fa fa-paint-brush"></i>
                <span class="hidden-xs">Themes</span>
            </button>
            <button type="button" class="btn btn-default btn-lg col-xs-4 btn-view-pages" ng-class="{'active': activeTab === 'pages'}" ng-click="showToaster = false; activeTab = 'pages'">
                <i class="fa fa-file-text-o"></i>
                <span class="hidden-xs">Pages
                </span>
            </button>
            <button type="button" class="btn btn-default btn-lg col-xs-4 btn-view-posts" ng-class="{'active': activeTab === 'posts'}" ng-click="showToaster = false; activeTab = 'posts'">
                <i class="fa fa-newspaper-o"></i>
                <span class="hidden-xs">Posts</span>
            </button>
        </div>
    </div>

    <div style="background: #e7e7e7;" id="scrollTop" ng-switch="activeTab" class="contentpanel" ng-style="styleWebsiteManage()" indigeweb-resize>
            <div class="theme-section" ng-switch-when="themes">
                <div class="row">
                    <div class="panel panel-success">
                        <div class="panel-heading">
                            <h3 class="panel-title">Current Theme</h3>
                        </div>
                        <div class="panel-body">
                            <div ng-if="currentTheme">
                                <div class="col-sm-6">
                                    <img class="img-thumbnail" ng-src="{{currentTheme.previewUrl}}">
                                </div>
                                <div class="col-sm-6">
                                    <div class="caption">
                                        <h4>{{currentTheme.name}}</h4>
                                        <p><b>{{currentTheme.description}}</b>
                                        </p>
                                        <hr>
                                        <div class="mb30"></div>
                                        <div class="col-sm-6">
                                            <div class="form-group">
                                                <label for="colorpicker">Color Primary:</label>
                                                <spectrum-colorpicker format="'hex'" options="spectrum.options" ng-model="website.settings.primary_color" class="pull-right" ng-change="updateThemeSettings()"></spectrum-colorpicker>
                                            </div>
                                            <div class="form-group">
                                                <label for="colorpicker">Color Secondary:</label>
                                                <spectrum-colorpicker format="'hex'" options="spectrum.options" ng-model="website.settings.secondaryColor" class="pull-right" ng-change="updateThemeSettings()"></spectrum-colorpicker>
                                            </div>
                                            <div class="form-group">
                                                <label for="colorpicker">Highlight Primary:</label>
                                                <spectrum-colorpicker format="'hex'" options="spectrum.options" ng-model="website.settings.primaryHighlight" class="pull-right" ng-change="updateThemeSettings()"></spectrum-colorpicker>
                                            </div>
                                            <div class="form-group">
                                                <label for="colorpicker">Text Color Primary:</label>
                                                <spectrum-colorpicker format="'hex'" options="spectrum.options" ng-model="website.settings.primaryTextColor" class="pull-right" ng-change="updateThemeSettings()"></spectrum-colorpicker>
                                            </div>

                                            <div class="form-group">
                                                <label for="colorpicker">Fav Icon:</label>
                                                <img ng-if = "website.settings.favicon" class=" center pull-right" style="max-height:40px;max-width:40px" ng-src="{{ website.settings.favicon }}">
                                            </div>
                                        </div>
                                        <div class="col-sm-6">
                                            <div class="form-group">
                                                <label for="colorpicker">Font Family Primary:</label>
                                                <jd-fontselect on-open="editPage()" stack="primaryFontStack" on-change="updatePrimaryFont(font)" rawText="{ toggleOpenLabel: 'Mach uff!' }"></jd-fontselect>
                                            </div>
                                            <div class="form-group">
                                                <label for="colorpicker">Font Family Secondary:</label>
                                                <jd-fontselect stack="secondaryFontStack" rawText="{ toggleOpenLabel: 'Mach uff!' }"></jd-fontselect>
                                            </div>
                                            <div class="form-group">
                                                <a class="btn btn-success btn-block media-modal ng-isolate-scope" media-modal-show-insert="true" on-insert-mediacb="insertMedia" user="user" data-toggle="modal" data-target="#media-manager-modal"> <span class="fa fa-image"></span> <span class="hidden-xs">Change Icon</span> </a>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div ng-if="!currentTheme">
                                <h3 class="center">Select a Theme From Below</h3>
                            </div>
                        </div>
                    </div>
                    <div class="themes">
                        <div class="col-sm-4 theme" ng-class="{success: theme.name == currentTheme.name, selected: theme.name == selectedTheme.name}" ng-repeat="theme in themes">
                        <div class="ribbon-wrapper-green" ng-if="theme.coming_soon == true"><div class="ribbon-green">COMING SOON</div></div>
                            <div class="thumbnail" data-themeid="">
                                <div class="check-theme" style="display:none"><i class="fa fa-check-circle"></i>
                                </div>
                                <img ng-src="{{theme.previewUrl}}">
                                <div class="caption">
                                    <h5>{{theme.name}}</h5>
                                    <p>{{theme.description}}</p>
                                    <button class="btn btn-primary btn-lg btn-block" ng-if="theme.name != currentTheme.name" ng-click="changeTheme(theme)" ng-disabled="theme.coming_soon">Switch Theme</button>
                                    <h1 class="center" ng-if="theme.name == currentTheme.name" style="height:47px"><span class="label label-success">CURRENT THEME</span></h1>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pages-section" ng-switch-when="pages">

                <div class="row">

                    <div class="col-xs-18 col-sm-6 col-md-3" ng-repeat="page in pages|orderBy:'modified.date':true">
                        <div class="thumbnail layered-paper">
                            <h4 class="title">{{page.title || page.handle | characters:25 }}</h4>
                            <h5 style="margin-top:0;color: #999;font-weight: normal;">{{page.modified.date | timeAgoFilter}}</h5>
                            <div class="screenshot-wrap scrollhover">
                                <!-- <div class="screenshot" ng-if="page.screenshot" style="background-image: url({{page.screenshot}});height: 160px;background-size: cover;"></div> -->
                                <img ng-if="page.screenshot" src="{{page.screenshot}}" alt="" class="screenshot">
                                <div ng-if="!page.screenshot"><h1 class="center" style="font-size: 98px;margin-top: 10px;color: #e7e7e7;"><i class="fa fa-photo"></i></h1></div>
                            </div>
                            <div class="caption">
                                <a href="/admin#/website-editor?pagehandle={{page.handle}}" class="btn btn-green btn-block" role="button"><i class="fa fa-edit"></i> Edit</a>
                            </div>
                        </div>
                    </div>

                </div>
                <!-- End row -->
            </div>

            <div class="posts-section" ng-switch-when="posts">
                <div class="row">

                    <div class="col-xs-12 col-sm-6 col-md-3" ng-repeat="post in posts | orderBy :'created.date':true">
                        <!-- <div class="thumbnail box14">
                            <div class="caption">
                                <a href="#" class="btn btn-green btn-block" role="button"><i class="fa fa-edit"></i> Edit</a>
                            </div>
                        </div>
                    </div> -->
                        <div class="paper-wrap">
                            <div class="paper">
                                <div class="tape"></div>
                                <!-- <div class="red-line first"></div>
                            <div class="red-line"></div> -->
                                <ul id="lines">
                                    <li class="first">
                                        <h4 class="title">{{post.post_title | characters:25 }}</h4>
                                    </li>
                                    <li class="second">
                                        <h5 class="timeago" style="font-weight: normal;">{{post.modified.date | timeAgoFilter}}</h5>
                                    </li>
                                    <li></li>
                                    <li></li>
                                    <li></li>
                                    <li></li>
                                    <li></li>
                                    <li></li>
                                    <li></li>
                                    <div class="screenshot-wrap">
                                        <div class="screenshot-overflow">
                                            <div class="screenshot" ng-if="post.featured_image" style="background-image: url({{post.featured_image}});width: 255px;height: 120px;background-size: cover;margin: 0 auto;border: 1px solid #ddd;"></div>
                                            <div class="excerpt" ng-if="!post.featured_image"><h1 class="center" style="font-size: 98px;margin-top: 10px;color: #e7e7e7;"><i class="fa fa-photo"></i></h1></div>
                                            <!-- <img ng-if="!post.screenshot" src="{{post.featured_image || 'http://placehold.it/500x300'}}" alt=""> -->
                                        </div>
                                    </div>
                                    <div class="caption">
                                        <a href="/admin#/website-editor?posthandle={{post.post_url}}" class="btn btn-green btn-block" role="button"><i class="fa fa-edit"></i> Edit</a>
                                    </div>
                                </ul>
                            </div>
                            <div class="left-shadow"></div>
                            <div class="right-shadow"></div>
                        </div>

                    </div>
                </div>
            </div>

            <!-- End container -->
        </div>

        <div class="rightpanel rightpanel-website">
            <ul class="nav nav-tabs nav-justified">
                <li class="active"><a href="#rp-settings" data-toggle="tab">Settings</a>
                </li>
            </ul>

            <!-- Tab panes -->

            <div class="tab-content">
                <div class="tab-pane pane-settings active" id="rp-settings">
                    <div class="rightpanelinner">
                    <div id="current-settings">
                        <h3>Default Tab</h3>
                        <div class="radio">
                            <label>
                                <input type="radio" name="default_tab" id="pages" ng-value="'pages'"
                                ng-model="userPreferences.website_default_tab"
                                ng-change="showToaster = true; activeTab = 'pages'">Pages
                            </label>
                        </div>
                        <div class="radio">
                            <label>
                                <input type="radio" name="default_tab" id="posts" ng-value="'posts'" ng-model="userPreferences.website_default_tab"
                                ng-change="showToaster = true; activeTab = 'posts'">Posts
                            </label>
                        </div>
                        <div class="radio disabled">
                            <label>
                                <input type="radio" name="default_tab" id="themes" ng-value="'themes'"
                                ng-model="userPreferences.website_default_tab"
                                ng-change="showToaster = true; activeTab = 'themes'">Themes
                            </label>
                        </div>
                    </div>
                </div>
                </div>
                <!-- tab-pane -->
            </div>
        </div>
    </div>

    <!-- Create Page Modal -->
    <div class="modal fade" id="create-page-modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Create Page</h4>
                </div>
                <div class="modal-body">
                    <div id="new_page">
                        <div class="form-group" ng-class="{ 'has-error': titleError}">
                            <label for="page-title" tooltip-placement="bottom" tooltip="Provide the title of the page you want to create">Page Title</label>
                            <input id="page-title" class="form-control input-lg" type="text" ng-model="page.title" ng-change="validateCreatePage(page)">
                        </div>
                        <div class="form-group" ng-class="{ 'has-error': handleError}">
                            <slug from="page.title" to="page.handle"></slug>
                            <label for="page-url" class="tooltips" tooltip-placement="bottom" tooltip="Modify the url where your page will be reached">Page Url</label>
                            <input id="page-url" class="form-control input-lg" type="text" ng-model="page.handle" ng-change="validateCreatePage(page)">
                        </div>
                        <div class="clearfix mb15"></div>
                        <div class="form-group">
                            <div class="ckbox ckbox-success">
                                <input type="checkbox" id="add-to-menu" ng-model="page.mainmenu" checked>
                                <label for="add-to-menu">Add to Main Menu?</label>
                            </div>
                        </div>
                    </div>
                    <div class="clearfix"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" ng-click="createPage(page, $event)">Create Page</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->

    <!-- Post Modal -->
    <div class="modal fade" id="create-post-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="myModalLabel">Add Post</h4>
                </div>
                <div class="modal-body">
                    <div id="new_page">
                        <div class="form-group">
                            <label for="page-author" tooltip-placement="bottom" tooltip="Provide the author of the post you want to create">Post Author</label>
                            <input id="page-author" class="form-control input-lg" type="text" ng-model="post.post_author">
                        </div>
                        <div class="form-group">
                            <label for="page-title" tooltip-placement="bottom" tooltip="Provide the title of the post you want to create">Post Title</label>
                            <input id="page-title" class="form-control input-lg" type="text" ng-model="post.post_title">
                        </div>
                        <div class="form-group">
                            <slug from="post.post_title" to="post.post_url"></slug>
                            <label for="post-url" tooltip-placement="bottom" tooltip="Provide the url of the post you want to create">Post Url</label>
                            <input id="post-url" class="form-control input-lg" type="text" ng-model="post.post_url">
                        </div>
                        <div class="clearfix mb15"></div>
                        <div class="form-group">
                            <div class="ckbox ckbox-success">
                                <input type="checkbox" id="comment_status" ng-model="post.comment_status" checked>
                                <label for="comment_status">Comment Status On?</label>
                            </div>
                        </div>
                    </div>
                    <div class="clearfix"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" ng-click="createPost(post, $event)" data-dismiss="modal">Create</button>
                </div>
            </div>
        </div>
    </div>
    <!-- /.modal -->
    <div id="model_container"></div>
</div>
