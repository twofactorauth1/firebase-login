<style>
    /*

    TODO:
        - decide on classnames for all hook-able stuff
        - mirror classnames here and in theme stylesheet(s)
        - add the hook classes to all relevant component markup

    */


    .email-theme-{{vm.website.theme.handle}} {
        color: {{vm.website.themeOverrides.styles.primaryTextColor}};
        font-family: {{vm.website.themeOverrides.defaultFontStack}};
        background-color: {{vm.website.themeOverrides.styles.bodyBackgroundColor}};
    }

    .email-theme-{{vm.website.theme.handle}} .ssb-section-layout {
        background-color: {{vm.website.themeOverrides.styles.bodyBackgroundColor}};
    }

    .email-theme-{{vm.website.theme.handle}} .ssb-navigation a {
        color: {{vm.website.themeOverrides.styles.primaryTextColor}};
    }

    .email-theme-{{vm.website.theme.handle}} .ssb-page-section-layout-header {
        background-color: {{vm.website.themeOverrides.styles.headerBackgroundColor}};
        color: {{vm.website.themeOverrides.styles.headerTextColor}};
    }

    .email-theme-{{vm.website.theme.handle}} .ssb-page-section-layout-header [ssb-text-component] {
        /*color: {{vm.website.themeOverrides.styles.headerTextColor}};*/
        /*font-size: {{vm.website.themeOverrides.styles.headerSize}};*/
    }

    .email-theme-{{vm.website.theme.handle}} .ssb-page-section-layout-hero {
        background-color: {{vm.website.themeOverrides.styles.heroBackgroundColor}};
        color: {{vm.website.themeOverrides.styles.heroTextColor}};
        text-align: center;
    }

    .email-theme-{{vm.website.theme.handle}} .ssb-page-section-layout-hero [ssb-text-component] {
        /*color: {{vm.website.themeOverrides.styles.heroTextColor}};*/
        /*font-size: {{vm.website.themeOverrides.styles.heroSize}};*/
    }

    .email-theme-{{vm.website.theme.handle}} .email-theme-heading-text {
        font-size: {{vm.website.themeOverrides.styles.headingSize}};
    }

    .email-theme-{{vm.website.theme.handle}} .email-theme-paragraph-text {
        font-size: {{vm.website.themeOverrides.styles.paragraphSize}};
    }

    .email-theme-{{vm.website.theme.handle}} .email-theme-btn, .email-theme-{{vm.website.theme.handle}} .email-theme-btn:hover {
        background-color: {{vm.website.themeOverrides.styles.primaryBtnBackgroundColor}};
        color: {{vm.website.themeOverrides.styles.primaryBtnTextColor}};
        border-color: {{vm.website.themeOverrides.styles.primaryBtnBackgroundColor}};
    }

    .email-theme-{{vm.website.theme.handle}} .email-theme-btn:hover, .email-theme-{{vm.website.theme.handle}} .email-theme-btn:active, .email-theme-{{vm.website.theme.handle}} .email-theme-btn:focus {
        background-color: {{vm.website.themeOverrides.styles.primaryBtnBackgroundColor}}!important;
    }

    .email-theme-young-soul .navbar-toggle .icon-bar {
        /*background-color: {{vm.website.themeOverrides.styles.primaryBtnTextColor}};*/
    }

    @media screen and (min-width: 768px) {

        .email-theme-{{vm.website.theme.handle}} .ssb-page-section-layout-header [ssb-text-component] {
            font-size: {{vm.website.themeOverrides.styles.headerSize}};
        }

        .email-theme-{{vm.website.theme.handle}} .ssb-page-section-layout-hero [ssb-text-component] {
            font-size: {{vm.website.themeOverrides.styles.heroSize}};
        }

        .email-theme-{{vm.website.theme.handle}} .email-theme-heading-text {
            font-size: {{vm.website.themeOverrides.styles.headingSize}};
        }

        .email-theme-{{vm.website.theme.handle}} .email-theme-paragraph-text {
            font-size: {{vm.website.themeOverrides.styles.paragraphSize}};
        }

    }

</style>

<div class="indi-email-builder">
    <indig-navprompt class="indig-navprompt" my-state="{{$state.$current.name}}" reset-dirty="vm.resetDirty()" check-if-dirty="vm.checkIfDirty()" save-page="vm.saveEmail()" save-page-check="!vm.pageSaving"></indig-navprompt>
    <!-- start: PAGE TITLE -->
    <section id="page-title" class="padding-top-15 padding-bottom-15">
        <div class="row">
            <div class="col-sm-8">
                <h1 class="mainTitle">Email Builder</h1>
                <span class="mainDescription">Fill out details below</span></span>
            </div>
        </div>
    </section>

    <div ng-class="{'load1 csspinner': !vm.dataLoaded}">
        <div class="container-fluid container-fullw bg-white padding-top-0 padding-bottom-0">
            <div class="row">
                <span class="padding-15 padding-right-0"><b>{{vm.email.title}}</b></span>
                <a href="#email-settings" class="btn btn-link text-primary" data-toggle="collapse" target="_self">
                    <i class="ti-settings"></i>
                    <span>Edit Settings</span>
                </a>
                <div id="email-settings" class="collapse no-transition bg-white margin-bottom-15 padding-top-0 padding-bottom-15 no-border-bottom clearfix">
                    <div class="form-group col-xs-12 col-sm-6" ng-class="{ 'has-error' : emailSettingForm.subject.$invalid && !emailSettingForm.subject.$pristine }">
                        <label>Title</label>
                        <input class='form-control' type='text' placeholder='Untitled Email' ng-model='vm.email.title' />
                    </div>
                    <div class="form-group col-xs-12 col-sm-6" ng-class="{ 'has-error' : emailSettingForm.subject.$invalid && !emailSettingForm.subject.$pristine }">
                        <label>Subject</label>
                        <input name="subject" class="form-control" type="text" ng-model="vm.email.subject" required>
                    </div>
                    <div class="form-group col-xs-12 col-sm-6" ng-class="{ 'has-error' : emailSettingForm.fromName.$invalid && !emailSettingForm.fromName.$pristine }">
                        <label>From Name</label>
                        <input name="fromName" class="form-control" type="text" ng-model="vm.email.fromName" required>
                    </div>
                    <div class="form-group col-xs-12 col-sm-6" ng-class="{ 'has-error' : emailSettingForm.fromEmail.$invalid && !emailSettingForm.fromEmail.$pristine }">
                        <label>From Email</label>
                        <input name="fromEmail" ng-pattern="formValidations.email" class="form-control" type="email" ng-model="vm.email.fromEmail" required>
                    </div>
                    <div class="form-group  col-xs-12 col-sm-6 margin-bottom-0" ng-class="{ 'has-error' : emailSettingForm.replyTo.$invalid && !emailSettingForm.replyTo.$pristine }">
                        <label>Reply To</label>
                        <input name="replyTo" class="form-control" type="email" ng-model="vm.email.replyTo">
                    </div>
                </div>
            </div>
        </div>

        <div class="container-fluid container-fullw bg-white padding-top-0 padding-bottom-0">
            <div class="row">
                <div class="col-xs-12 margin-top-10 margin-bottom-10">
                    <button type="button" ng-disabled="saveLoading" ng-click="vm.openModalFn('add-email-component-modal')" class="btn btn-primary padding-right-10 margin-bottom-5">
                        <i class="ti-plus"></i>
                        <span>Add Component</span>
                    </button>
                    <button type="button" ng-disabled="saveLoading" ng-click='vm.saveFn()' class="btn btn-primary padding-right-10 margin-bottom-5">
                        <i class="ti-save"></i>
                        <span>Save</span>
                    </button>
                    <button type="button" ng-disabled="saveLoading" class="btn btn-primary padding-right-10 margin-bottom-5">
                        <i class="ti-layout-media-overlay-alt"></i>
                        <span>One-time email</span>
                    </button>
                    <button type="button" ng-disabled="saveLoading" class="btn btn-primary padding-right-10 margin-bottom-5">
                        <i class="ti-layout-media-overlay-alt"></i>
                        <span>Create Campaign</span>
                    </button>
                    <button type="button" ng-disabled="saveLoading" ng-click='vm.deleteFn()' class="btn btn-danger padding-right-10 margin-bottom-5">
                        <i class="ti-trash"></i>
                        <span>Delete</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="row email-builder-toolbar">
            <div id='ssb-froala-scrollable-container'></div>
        </div>

        <div class="row">
            <div class="email-builder-main custom-fonts email-theme-{{vm.website.theme.name| slugify}}" data-eq-pts="small: 400, medium: 768, large: 1240" ng-hide="!vm.dataLoaded">
                <div class='components'>
                    <table class="device-width email-body" align="center" width="680" cellpadding="0" cellspacing="0" border="0" style="border-collapse: collapse;">
                        <tr ng-if="vm.dataLoaded && !vm.email.components.length">
                            <td>
                                <div class="well empty-page center">
                                    <h1>This Email is Empty.</h1>
                                    <h4>Add some components and start editing!</h4>
                                    <button class="btn btn-info margin-top-15" ng-click="vm.openModalFn('email-component-modal', null, null, 'lg')">Add Component</button>
                                </div>
                                <div class="clearfix mb15"></div>
                            </td>
                        </tr>

                        <tr id="{{component._id}}" ng-if="vm.email.components.length" ng-repeat="component in vm.email.components" class="fragment show-settings {{component.type}}" style="position:relative;" email-component-loader
                            component-class="vm.componentClassFn(component, $index)"
                            component-style="vm.componentStyleFn(component, $index)"
                            component="component"
                            website="vm.website"
                            account="vm.account"
                            component-index="$index"
                            component-count="vm.email.components.length"
                            ></tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<div data-ng-include data-src=" 'assets/views/partials/add-email-component-modal.html' " ></div>
