<section ng-init="vm.state.editSection=false"
    ng-if="(vm.uiState.showSectionPanel && vm.state.page.sections[vm.uiState.activeSectionIndex]) ||
            (vm.uiState.showSectionPanel && vm.uiState.openSidebarSectionPanel.id && vm.uiState.activeElement.id)"
    class="ssb-sidebar-section-panel draggable fade-in"
    ind-draggable>

    <h4 class="ssb-sidebar-sub-heading draggable-handle">

        <span
            onhide="vm.state.editSection=false"
            id="edit_section_name"
            ng-if="vm.state.editSection"
            editable-text="vm.state.page.sections[vm.uiState.activeSectionIndex].name">

            {{vm.state.page.sections[vm.uiState.activeSectionIndex].name}}

        </span>

        <div>
            <i ng-if="vm.uiState.navigation.sectionPanel.navigationHistory.length > 1" class="fa fa-arrow-left" ng-click="vm.uiState.navigation.sectionPanel.back();"></i>
            <!-- Heading for Component and text elements -->
            <span ng-if="!vm.state.editSection && vm.uiState.openSidebarSectionPanel.id">
                {{vm.uiState.openSidebarSectionPanel.name | cleanType}}
            </span>
            <!-- Heading for Sections -->
            <span ng-if="!vm.state.editSection && !vm.uiState.openSidebarSectionPanel.id">
                {{vm.state.page.sections[vm.uiState.activeSectionIndex].name | cleanType}}
            </span>
        </div>
    </h4>

    <div class="close-panel fa fa-close" ng-click="vm.closeSectionPanel()"></div>

    <!-- Loading background -->
    <div class="ssb-sidebar-section-panel-loading-background">
        <div class="center"><br><span class="fa fa-spinner fa-spin"></span><br>Loading menu...</div>
    </div>

    <!-- Scrollable menu container -->
    <div class="ssb-sidebar-section-panel-scrollable">

        <!-- Section Settings Home -->
        <ssb-sidebar-settings-panel
            ng-if="!vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/ssb-page-section/sidebar.settings.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <!-- Section Settings Design -->
        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="'design' === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/ssb-page-section/sidebar.settings.design.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <!-- Section Settings Version -->
        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="'version' === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/ssb-page-section/sidebar.settings.version.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <!-- Section Settings Layout -->
        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="'layout' === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/ssb-page-section/sidebar.settings.layout.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <!-- Section Settings Settings -->
        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="'settings' === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/ssb-page-section/sidebar.settings.settings.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <!-- Component Settings Home -->
        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.uiState.activeComponentIndex !== undefined && vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id !== undefined && vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/#COMPONENTTYPE#/sidebar.settings.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <!-- Component Settings Design -->
        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] && ('design' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/sidebar.settings.design.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <!-- Component Settings Layout -->
        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] && ('layout' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/sidebar.settings.layout.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <!-- Component Settings Form Builder Layout -->
        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] && ('form-builder-layout' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/form-builder-layout.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <!-- Component Settings Form Builder -->
        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] && ('form-builder' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/form-builder.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <!-- Component Settings Form Builder -->
        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] && ('form-builder-settings' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/form-builder-settings.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <!-- Component Settings Form Builder Layout -->
        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] && ('form-donate-layout' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/form-builder-layout.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <!-- Component Settings Form Builder -->
        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] && ('form-donate' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/form-builder.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <!-- Component Settings Form Builder -->
        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] && ('form-donate-settings' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/form-donate-settings.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <!-- Component Settings Advanced -->
        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] && ('advanced' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/sidebar.settings.advanced.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <!-- Component Settings Specific -->
        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] &&  ('navigation' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/navigation.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] &&  ('video' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/video.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] &&  ('simple-form' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/simple-form.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] &&  ('products' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/products.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] &&  ('team' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/meet-team.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] &&  ('testimonials' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/testimonials.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] &&  ('top-bar' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/top-bar.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex] &&  ('blog' + vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]._id) === vm.uiState.openSidebarSectionPanel.id"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/blog.html"
            component="vm.state.page.sections[vm.uiState.activeSectionIndex].components[vm.uiState.activeComponentIndex]"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel"
            ng-if="vm.uiState.openSidebarSectionPanel.id === vm.uiState.activeElement._id && vm.uiState.activeElement._id.indexOf('button-element_') == 0"
            settings-template="assets/js/ssb-site-builder/ssb-components/ssb-theme-btn/sidebar.settings.html"
            component="vm.uiState.activeElement"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>


        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="'design' + vm.uiState.activeElement._id === vm.uiState.openSidebarSectionPanel.id && vm.uiState.activeElement._id && vm.uiState.activeElement._id.indexOf('button-element_') == 0"
            settings-template="assets/js/ssb-site-builder/ssb-components/ssb-theme-btn/sidebar.settings.design.html"
            component="vm.uiState.activeElement"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="'button-version' + vm.uiState.activeElement._id === vm.uiState.openSidebarSectionPanel.id && vm.uiState.activeElement._id && vm.uiState.activeElement._id.indexOf('button-element_') == 0"
            settings-template="assets/js/ssb-site-builder/ssb-components/ssb-theme-btn/sidebar.settings.version.html"
            component="vm.uiState.activeElement"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="'layout' + vm.uiState.activeElement._id === vm.uiState.openSidebarSectionPanel.id && vm.uiState.activeElement._id && vm.uiState.activeElement._id.indexOf('button-element_') == 0"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/sidebar.settings.layout.html"
            component="vm.uiState.activeElement"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>


        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="'settings' + vm.uiState.activeElement._id === vm.uiState.openSidebarSectionPanel.id && vm.uiState.activeElement._id && vm.uiState.activeElement._id.indexOf('button-element_') == 0"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/sidebar.settings.advanced.html"
            component="vm.uiState.activeElement"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>


        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel"
            ng-if="vm.uiState.openSidebarSectionPanel.id === vm.uiState.activeElement._id && vm.uiState.activeElement._id.indexOf('text-element_') == 0"
            settings-template="assets/js/ssb-site-builder/ssb-components/ssb-text-settings/sidebar.settings.html"
            component="vm.uiState.activeElement"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>


        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="'design' + vm.uiState.activeElement._id === vm.uiState.openSidebarSectionPanel.id && vm.uiState.activeElement._id && vm.uiState.activeElement._id.indexOf('text-element_') == 0"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/sidebar.settings.design.html"
            component="vm.uiState.activeElement"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="'layout' + vm.uiState.activeElement._id === vm.uiState.openSidebarSectionPanel.id && vm.uiState.activeElement._id && vm.uiState.activeElement._id.indexOf('text-element_') == 0"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/sidebar.settings.layout.html"
            component="vm.uiState.activeElement"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>


        <ssb-sidebar-settings-panel
            class="ssb-sidebar-section-panel-component-panel container-fluid"
            ng-if="'settings' + vm.uiState.activeElement._id === vm.uiState.openSidebarSectionPanel.id && vm.uiState.activeElement._id && vm.uiState.activeElement._id.indexOf('text-element_') == 0"
            settings-template="assets/js/ssb-site-builder/ssb-components/shared/sidebar.settings.advanced.html"
            component="vm.uiState.activeElement"
            state="vm.state"
            ui-state="vm.uiState">
        </ssb-sidebar-settings-panel>

    </div>
</section>
