<div class="ssb-sidebar-inner" ng-class="vm.navigation.indexClass">

	<div class="site-editor-group editor-group">
		<div class="ssb-sidebar-heading">
			<div class="ti-arrow-left" ng-click="vm.navigation.goToPagesListPage()"></div>
			<h4>Site Settings</h4>
			<div class="ti-arrow-right" ng-click="vm.navigation.loadPage(vm.state.page._id)"></div>
		</div>

        <section>
            <h4 class="ssb-sidebar-sub-heading">Pages</h4>
            <ul class="list-unstyled">
                <li ng-repeat="page in vm.state.pages track by $index" class="ssb-page-section-settings-item">
                    <div class="ssb-sidebar-item-icon ti-plus display-ib" tooltip-placement="left" tooltip-html-unsafe="Add to Main Menu"></div>
                    <div class="panel-group">
                        <div class="ssb-sidebar-sortable-item panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                    <a href page-id="page._id" ng-click="vm.navigation.loadPage(page._id)">{{page.title}}</a>
                                </h4>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
        </section>

		<section>
	        <h4 class="ssb-sidebar-sub-heading">Theme Settings</h4>
	        <ul class="list-unstyled">
				<li class="ssb-page-section-settings-item">
					<div class="ssb-sidebar-item-icon ti-settings display-ib"></div>
					<accordion close-others="oneAtATime" class="accordion">
						<accordion-group heading="{{vm.state.website.theme.name || 'Default'}}"
							ng-class="{ 'ssb-sidebar-section-open': isOpen }"
							class="ssb-sidebar-sortable-item">

							<div class="form-group">
								<h5 class="ssb-sidebar-settings-heading">Theme - {{vm.state.website.theme.name}}</h5>

                <ui-select ng-model="vm.state.website.theme" ng-change="vm.applyThemeToSite($select.selected)" theme="bootstrap">
                  <ui-select-match placeholder="Select a theme">
                      <small ng-bind-html="$select.selected.name"></small>
                  </ui-select-match>
                  <ui-select-choices repeat="theme in vm.state.themes | filter: $select.search track by $index">
                      <small ng-bind-html="theme.name | highlight: $select.search"></small>
                  </ui-select-choices>
                </ui-select>

								<ul class="list-unstyled panel-body">
                  <li class="clearfix">
                    Header Background Color:
                    <spectrum-colorpicker class="pull-right" format="'hex'" options="vm.spectrum.options" ng-model="vm.state.website.themeOverrides.styles.headerBackgroundColor"></spectrum-colorpicker>
                  </li>
                  <li class="clearfix">
                    Body Background Color:
                    <spectrum-colorpicker class="pull-right" format="'hex'" options="vm.spectrum.options" ng-model="vm.state.website.themeOverrides.styles.bodyBackgroundColor"></spectrum-colorpicker>
                  </li>
                  <li class="clearfix">
                    Text Color (Primary):
                    <spectrum-colorpicker class="pull-right" format="'hex'" options="vm.spectrum.options" ng-model="vm.state.website.themeOverrides.styles.primaryTextColor"></spectrum-colorpicker>
                  </li>
                  <li class="clearfix">
                    Text Color (Buttons):
                    <spectrum-colorpicker class="pull-right" format="'hex'" options="vm.spectrum.options" ng-model="vm.state.website.themeOverrides.styles.primaryBtnTextColor"></spectrum-colorpicker>
                  </li>
                  <li class="clearfix">
                    Button Background Color:
                    <spectrum-colorpicker class="pull-right" format="'hex'" options="vm.spectrum.options" ng-model="vm.state.website.themeOverrides.styles.primaryBtnBackgroundColor"></spectrum-colorpicker>
                  </li>
                  <li class="clearfix">
                    Heading Size: <pre>{{vm.state.website.themeOverrides.styles.headingSize}}</pre>
                  </li>
                  <li class="clearfix">
                    Paragraph Size: <pre>{{vm.state.website.themeOverrides.styles.paragraphSize}}</pre>
                  </li>
                  <li class="clearfix">
                    Font Stack (Default): <pre>{{vm.state.website.themeOverrides.defaultFontStack}}</pre>
                  </li>
                  <li class="clearfix">
                    Font Stack (Heading): <pre>{{vm.state.website.themeOverrides.headingFontStack}}</pre>
                  </li>
                  <li class="clearfix">
                    Font Stack (Paragraph): <pre>{{vm.state.website.themeOverrides.paragraphFontStack}}</pre>
                  </li>
								</ul>

							</div>

						</accordion-group>
					</accordion>
				</li>
			</ul>
	    </section>

	    <section ng-repeat="linkList in vm.state.website.linkLists track by $index">
	        <h4 class="ssb-sidebar-sub-heading">{{::linkList.name}}</h4>
	        <ul class="list-unstyled" ng-sortable="vm.sortableOptions" ng-model="linkList.links">
	        	<li ng-repeat="link in linkList.links track by $index" class="ssb-page-section-settings-item">
	        		<div class="ssb-sidebar-item-icon ssb-sidebar-move-handle ti-move display-ib"></div>
	        		<div class="ssb-sidebar-item-icon ssb-sidebar-item-icon-offset-1 ti-close display-ib" tooltip-placement="left" tooltip-html-unsafe="Remove from {{::linkList.name}}"></div>
	        		<div class="panel-group">
		        		<div class="ssb-sidebar-sortable-item panel panel-default">
			        		<div class="panel-heading">
				        		<h4 class="panel-title">
				        			<a href page-id="page._id" ng-click="vm.navigation.loadPage(page._id)">{{link.label}}</a>
				        		</h4>
				        	</div>
			        	</div>
			        </div>
	        	</li>
	        </ul>
	    </section>

	</div>

	<div class="page-editor-group editor-group">

		<div class="ssb-sidebar-heading">
			<div class="ti-arrow-left" ng-click="vm.navigation.back()"></div>
			<h4>{{vm.state.page.title}}</h4>
		</div>

		<section>
	        <h4 class="ssb-sidebar-sub-heading">Page Settings</h4>
	        <ul class="list-unstyled ssb-settings-list">
				<li>
					<label>
						Title:
						<span editable-text="vm.state.page.title" onbeforesave="">{{vm.state.page.title}}</span>
					</label>
				</li>
				<li>
          <label>
            URL:
            <span editable-text="vm.state.page.handle" onbeforesave="">{{vm.state.page.handle}}</span>
          </label>
        </li>
        <li>
					<label>
						Page Template:
						<span>{{vm.state.page.handle}}</span>
					</label>
				</li>
			</ul>
		</section>

		<section>
	        <h4 class="ssb-sidebar-sub-heading">
	        	<span>Page Sections ({{vm.state.page.sections.length || 0}})</span>
	        	<div ng-click="vm.openModal('ssb-add-section-modal', 'SiteBuilderAddSectionModalController', null, 'lg');" class="ssb-sidebar-item-icon ti-plus display-ib" tooltip-placement="left" tooltip-html-unsafe="Add Section"></div>
	        </h4>
			<ul ng-if="vm.state.page.sections" class="list-unstyled" ng-sortable="vm.sortableOptions" ng-model="vm.state.page.sections">
				<li ng-repeat="section in vm.state.page.sections track by $index" ng-init="sectionIndex = $index" class="ssb-page-section-settings-item">
					<div class="ssb-sidebar-item-icon ssb-sidebar-move-handle ti-move display-ib"></div>
					<div class="ssb-sidebar-item-icon ssb-sidebar-item-icon-offset-1 ti-close display-ib" ng-if="vm.uiState.accordion.sections[sectionIndex].isOpen" ng-click="vm.removeSectionFromPage(sectionIndex)" tooltip-placement="left" tooltip-html-unsafe="Remove section"></div>
					<!-- <div ng-hide="!vm.uiState.accordion.sections[sectionIndex].isOpen" class="ssb-sidebar-item-icon ssb-sidebar-move-handle ti-angle-down display-ib"></div>
					<div ng-hide="vm.uiState.accordion.sections[sectionIndex].isOpen" class="ssb-sidebar-item-icon ssb-sidebar-move-handle ti-angle-up display-ib"></div> -->
					<accordion close-others="oneAtATime" class="accordion">
						<accordion-group heading="{{section.name}}"
							is-open="vm.uiState.accordion.sections[sectionIndex].isOpen"
							ng-click="vm.togglePageSectionAccordion(sectionIndex)"
							ng-class="{ 'ssb-sidebar-section-open': vm.uiState.accordion.sections[sectionIndex].isOpen }"
							class="ssb-sidebar-sortable-item">

							<div class="clearfix overflow-auto" ng-include=" 'assets/js/ssb-site-builder/ssb-components/ssb-page-section/sidebar.settings.html' "></div>

							<div class="form-group padding-top-10">
								<h5 class="ssb-sidebar-settings-heading">Components ({{section.components.length}})</h5>
								<ul class="list-unstyled ssb-sidebar-section-components-list">
									<li ng-repeat="component in section.components track by $index" ng-init="componentIndex = $index">
										<accordion close-others="oneAtATime" class="accordion">
											<accordion-group
												is-open="vm.uiState.accordion.sections[sectionIndex].components[componentIndex].isOpen"
												ng-click="vm.togglePageSectionComponentAccordion(componentIndex)"
												class="ssb-sidebar-sortable-item ssb-sidebar-sortable-item-component">

												<accordion-heading>
													<div ng-class="{ 'ssb-sidebar-component-open': vm.uiState.accordion.sections[sectionIndex].components[componentIndex].isOpen }">
														{{(componentIndex + 1)}} - {{component.header_title || component.type}}
													</div>
													<div class="ssb-sidebar-item-icon ssb-sidebar-move-handle ti-move display-ib"></div>
													<div
														class="ssb-sidebar-item-icon ssb-sidebar-item-icon-offset-1 ti-close display-ib"
														ng-if="vm.uiState.accordion.sections[sectionIndex].components[componentIndex].isOpen"
														ng-click="vm.removeComponentFromSection(componentIndex)"
														tooltip-placement="left"
														tooltip-html-unsafe="Remove component">
													</div>
												</accordion-heading>

												<div ng-include=" 'assets/js/ssb-site-builder/ssb-components/shared/basic.html' "></div>

												<ul class="list-unstyled">
													<li>
														<accordion close-others="oneAtATime" class="accordion">
															<div ng-if="component.type !== undefined" ng-include=" 'assets/js/ssb-site-builder/ssb-components/' + component.type + '/sidebar.settings.html' "></div>
															<ssb-action-buttons save-action="vm.savePage()" cancel-action="vm.cancelPendingEdits()" ng-show="vm.state.pendingChanges"></ssb-action-buttons>
														</accordion>
													</li>
												</ul>
												<!-- <div class="form-group">
													<button class="btn btn-block btn-danger btn-ssb-remove-component" ng-disabled="vm.uiState.loading > 0" ng-click="vm.removeComponentFromSection($index)"><i class="fa fa-trash"></i> Remove</button>
												</div> -->
											</accordion-group>
										</accordion>
									</li>
									<li ng-if="section.canAddComponents !== false" class="ssb-sidebar-component-list">
										<accordion close-others="oneAtATime" class="accordion" ng-click="vm.getPlatformComponents()">
											<accordion-group heading="Add + ">
												<ul class="list-unstyled">
													<li ng-repeat="component in vm.platformComponents track by $index" ng-click="vm.addComponentToSection(component, sectionIndex)" class="center">
														<img src="{{component.preview}}" alt="{{component.type}}" />
														{{component.header_title || component.title || component.type}}
													</li>
												</ul>
											</accordion-group>
										</accordion>
									</li>
								</ul>
							</div>

							<!-- <div class="form-group">
								<button class="btn btn-block btn-danger mb10" ng-disabled="vm.uiState.loading > 0" ng-click="vm.removeSectionFromPage($index)"><i class="fa fa-trash"></i> Remove</button>
							</div> -->


						</accordion-group>

					</accordion>
				</li>
			</ul>
		</section>

	</div>

</div>
