<section ng-if="vm.uiState.openBlogPanel.id === 'blog'" class="ssb-sidebar-panel-inner-container">
    <header class="ssb-sidebar-panel-header margin-bottom-0">

        <h4 class="ssb-sidebar-sub-heading">
            {{vm.uiState.openBlogPanel.name}}
        </h4>

        <div class="close-panel ti-close" ng-click="vm.closeBlogPanel()"></div>

    </header>

    <div class="ssb-sidebar-section-panel-loading-background">
        <div class="center"><br><span class="fa fa-spinner fa-spin"></span><br>Loading menu...</div>
    </div>

    <div class="ssb-sidebar-section-panel-scrollable">

        <div class="margin-top-10">

            <button ng-click="vm.refreshPost(); vm.uiState.navigation.blogPanel.loadPanel({ name: 'Edit Post', id: 'edit' });" class="ssb-sidebar-section-panel-btn btn btn-link">
                <i class="fa fa-plus display-ib"></i> New Post
            </button>

            <button ng-click="vm.uiState.navigation.blogPanel.loadPanel({ name: 'Manage Blog Templates', id: 'manage' });" class="ssb-sidebar-section-panel-btn btn btn-link">
                <i class="fa fa-align-justify display-ib"></i> Manage Blog Templates
            </button>



            <h4 class="ssb-sidebar-sub-heading-separator margin-top-10 padding-left-15">Show Posts</h4>

            <ul class="list-unstyled margin-top-20">
                <li
                    ng-repeat="postFilter in vm.state.blog.postFilters track by $index"
                    ng-class="{ 'active-post-filter': postFilter === vm.uiState.activePostFilter }"
                    class="ssb-page-section-settings-item">
                    <div
                        class="ssb-sidebar-item-icon-left display-ib fa"
                        ng-class="{'fa-folder': postFilter === 'all', 'fa-file': postFilter === 'published', 'fa-file-o': postFilter === 'draft', 'fa-star': postFilter === 'featured' }">
                    </div>
                    <div class="checkbox clip-check check-primary checkbox-inline-right">
                        <input
                            id="filter-split-{{$index}}"
                            type="checkbox"
                            ng-model="vm.uiState.activePostFilter"
                            ng-true-value="'{{postFilter}}'"
                        />
                        <label for="filter-split-{{$index}}">
                            {{postFilter}}
                        </label>
                    </div>
                </li>
            </ul>

            <h4 class="ssb-sidebar-sub-heading text-bold padding-left-0">Posts</h4>

            <ul class="ssb-blog-post-list list-unstyled">
                <li ng-repeat="post in vm.state.blog.posts | filter:vm.filter | orderBy:'-modified.date' track by $index" class="ssb-media-default">
                    <section
                        ssb-blog-post-card-component
                        post="post"
                        compact-view="true">
                    </section>
                    <section class="ssb-blog-post-list-item">
                        <div class="ssb-blog-post-toggles">
                            <div class="btn-group btn-group-sm" role="group" aria-label="Post Status">

                                <button
                                    type="button"
                                    class="btn btn-default"
                                    tooltip-placement="top"
                                    tooltip-append-to-body="true"
                                    tooltip-html-unsafe="Toggle Featured"
                                    ng-click="vm.toggleFeatured(post)">

                                    <i ng-if="post.featured" class="fa fa-star"></i>
                                    <i ng-if="!post.featured" class="fa fa-star-o"></i>

                                </button>

                            </div>
                        </div>
                        <div class="ssb-blog-post-action-buttons">
                            <button class="btn btn-default" tooltip-placement="top" tooltip-html-unsafe="Create duplicate post" ng-click="vm.duplicatePost(post)">
                                <i class="fa fa-copy"></i><span class="sr-only">Duplicate</span>
                            </button>
                            <button class="btn btn-default" tooltip-placement="top" tooltip-html-unsafe="View post" ng-click="vm.viewPost(post)">
                                <i class="fa fa-television"></i><span class="sr-only">Preview</span>
                            </button>
                            <button class="btn btn-default" tooltip-placement="top" tooltip-html-unsafe="Delete post" ng-click="vm.deletePost(post)">
                                <i class="fa fa-trash"></i><span class="sr-only">Delete</span>
                            </button>
                            <button class="btn btn-primary" ng-click="vm.editPost(post)">
                                <i class="fa fa-pencil-square-o"></i><span> Edit</span>
                            </button>
                        </div>
                    </section>
                </li>
            </ul>

        </div>

    </div>

</section>

<section ng-show="vm.uiState.openBlogPanel.id !== 'blog'" class="ssb-sidebar-panel-inner-container">

    <header class="ssb-sidebar-panel-header margin-bottom-0">

        <h4 class="ssb-sidebar-sub-heading">

            <i
                ng-if="vm.uiState.navigation.blogPanel.navigationHistory.length > 1"
                class="fa fa-arrow-left"
                ng-click="vm.backBlogPanel()">
            </i>

            {{vm.uiState.openBlogPanel.name}}
        </h4>

        <div class="close-panel ti-close" ng-click="vm.closeBlogPanel()"></div>

    </header>

    <div class="ssb-sidebar-section-panel-loading-background">
        <div class="center"><br><span class="fa fa-spinner fa-spin"></span><br>Loading menu...</div>
    </div>

    <div class="ssb-sidebar-section-panel-scrollable">

        <div
            ng-if="vm.uiState.openBlogPanel.id === 'manage'"
            class="margin-top-10">

            <button ng-click="vm.refreshPost(); vm.uiState.navigation.blogPanel.loadPanel({ name: 'Edit Post', id: 'edit' });" class="ssb-sidebar-section-panel-btn btn btn-link">
                <i class="fa fa-plus display-ib"></i> New Post
            </button>

            <button ng-click="vm.uiState.navigation.blogPanel.loadPanel({ name: 'Blog', id: 'blog' });" class="ssb-sidebar-section-panel-btn btn btn-link">
                <i class="fa fa-align-justify display-ib"></i> Manage Blog Posts
            </button>

            <h4 class="ssb-sidebar-sub-heading-separator margin-top-10 padding-left-15">Blog Pages</h4>

            <ul class="list-unstyled site-editor-group-pages">
                <li
                    ng-if="page.handle === 'blog-list' || page.handle === 'blog-post'"
                    ng-repeat="page in vm.state.pages track by $index"
                    ng-class="{ 'active-page': page._id === vm.state.page._id }"
                    class="ssb-page-section-settings-item">
                    <div ng-click="vm.uiState.openPageSettingsModal('ssb-page-settings-modal', 'SiteBuilderPageSettingsModalController', null, 'lg', page._id);" class="ssb-sidebar-item-icon ti-settings display-ib" tooltip-placement="left" tooltip-html-unsafe="Page Settings"></div>
                    <div class="panel-group">
                        <div class="ssb-sidebar-sortable-item panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                    <a ng-if="page._id !== vm.state.page._id" href page-id="page._id" ng-click="vm.uiState.saveAndLoadPage(page)"><span tooltip-placement="bottom" tooltip="{{page.title}}">{{page.title | truncate : 60 : '...' : true}}</span></a>
                                    <a ng-if="page._id === vm.state.page._id" href page-id="page._id" ng-click="vm.uiState.navigation.loadPage(page._id)"><span tooltip-placement="bottom" tooltip="{{vm.state.page.title}}">{{vm.state.page.title | truncate : 60 : '...' : true}}</span></a>
                                </h4>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>

        </div>

        <div
            ng-if="vm.uiState.openBlogPanel.id === 'edit'"
            class="ssb-blog-editor-scrollable-container row">

            <div class="ssb-blog-editor">

                <input autocomplete="false" type="text" class="ssb-blog-editor-post-title" ng-model="vm.state.post.post_title" placeholder="Title" />

                <p
                    class="ssb-blog-editor-post-body"
                    elem
                    ssb-blog-editor="true"
                    ng-model="vm.state.post.post_content"
                    placeholder="Tell your story...">
                </p>

            </div>

            <div class="ssb-blog-editor-controls">

                <div class="ssb-blog-editor-controls-inner">
                    <div class="ssb-blog-editor-controls-inner-fixed">

                        <h4 class="text-u inline no-border">Status:</h4>
                        <span class="text-u text-indigenous-blue">{{vm.state.post.post_status || 'Unsaved Draft'}}</span>

                        <div class="btn-group btn-group-md row block clearfix" role="group" aria-label="Post Status">

                            <button
                                ng-disabled="!vm.isValidPost() || vm.uiState.saveLoading"
                                class="btn btn-primary"
                                ng-click="vm.savePost(vm.state.post)"
                                tooltip-placement="top"
                                tooltip-append-to-body="true"
                                tooltip="Save">

                                <i ng-if="!vm.uiState.saveLoading" class="fa fa-save"></i>
                                <span ng-if="!vm.uiState.saveLoading" class="sr-only">Save</span>
                                <span ng-hide="!vm.uiState.saveLoading" ng-if="vm.uiState.saveLoading"><i class="fa fa-spinner fa-spin"></i></span>
                                <span ng-if="vm.uiState.saveLoading" class="sr-only">Saving</span>

                            </button>

                            <button
                                ng-disabled="!vm.isValidPost() || vm.uiState.saveLoading"
                                type="button"
                                class="btn btn-primary"
                                ng-click="vm.toggleFeatured(vm.state.post)"
                                tooltip-placement="top"
                                tooltip-append-to-body="true"
                                tooltip-html-unsafe="Toggle Featured">

                                <i ng-if="!vm.state.post.featured" class="fa fa-star"></i>
                                <i ng-if="vm.state.post.featured" class="fa fa-star-o"></i>

                            </button>

                            <button
                                ng-disabled="!vm.isValidPost() || vm.uiState.saveLoading"
                                class="btn btn-primary"
                                ng-click="vm.viewPost(vm.state.post)"
                                tooltip-placement="top"
                                tooltip-append-to-body="true"
                                tooltip="Preview">
                                <i class="fa fa-television"></i><span class="sr-only">Preview</span>
                            </button>

                            <button
                                ng-disabled="!vm.isValidPost() || vm.uiState.saveLoading"
                                ng-if="vm.state.post.post_status !== 'PUBLISHED'"
                                class="btn btn-primary"
                                ng-click="vm.publishPost(vm.state.post)"
                                tooltip-placement="top"
                                tooltip-append-to-body="true"
                                tooltip="Publish">
                                <i class="fa fa-globe"></i><span class="sr-only">Publish</span>
                            </button>


                        </div>

                        <div class="row block ssb-blog-editor-controls-date">
                            <indi-datepicker ng-model="vm.state.post.publish_date" popup="MM/dd/yyyy"></indi-datepicker>
                        </div>

                        <div class="row block ssb-blog-editor-controls-author">
                            <input type="text" ng-model="vm.state.post.post_author" class="form-control" placeholder="Author's Name" />
                        </div>

                        <div class="row block ssb-blog-editor-controls-tags">
                            <h4 class="text-u">Tags</h4>
                            <tags-input min-length="1" ng-model="vm.state.post.post_tags"></tags-input>
                        </div>

                        <div class="row block ssb-blog-editor-featured-image">
                            <h4 class="text-u">Featured Image</h4>
                            <i ng-if="vm.state.post.featured_image" class="fa fa-close" ng-click="vm.removeFeaturedImage(vm.state.post);"></i>
                            <div class="center" ng-click="vm.setFeaturedImage(vm.state.post);">
                                <div ng-if="vm.state.post.featured_image">
                                    <img ng-src="{{vm.state.post.featured_image}}" />
                                </div>
                                <div class="ssb-no-image" ng-if="!vm.state.post.featured_image">
                                    <i class="fa fa-image"></i>
                                    <span>No Featured Image</span>
                                </div>
                            </div>
                        </div>

                    </div>

                </div>

            </div>

        </div>

    </div>

</section>
