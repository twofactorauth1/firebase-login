<div ng-controller="SSBComponentSettingsModalCtrl">
    
    <h4 class="ssb-sidebar-sub-heading-separator">Tag Submissions</h4>
    <div class="row padding-10">
        <div class="form-group" ng-repeat="field in component.fields">
            <label>
                Show "{{field.name | titleCase}}" field
                <span tooltip-placement="top" tooltip-append-to-body="true" tooltip="show '{{field.name | titleCase}}' field on form"><i class="fa fa-info-circle" /></span>
            </label>
            <switch name="chk_{{field.name}}" ng-model="field.value" class="pull-right"></switch>
        </div>

        <div class="form-group customer-tags">
            <label class="block">
                Add tag to contact
                <span tooltip-placement="top" tooltip-append-to-body="true" tooltip="Add a contact tag on signup"><i class="fa fa-info-circle" /></span>
            </label>
            <ui-select tagging="vm.tagToCustomer" tagging-match-to-key="label" multiple ng-model="component.tags" theme="bootstrap" ng-disabled="disabled">
                <ui-select-match placeholder="Select tags...">{{$item.label}}</ui-select-match>
                <ui-select-choices repeat="tag.data as tag in vm.contactTags | orderBy:'label' | filter:$select.search">
                    {{tag.label}}
                </ui-select-choices>
            </ui-select>
        </div>

        <div class="form-group">
            <label>
                Unique email check
                <span tooltip-placement="top" tooltip-append-to-body="true" tooltip="Enforced unique check on email for contact creation"><i class="fa fa-info-circle" /></span>
            </label>
            <switch name="uniqueemail" ng-model="component.uniqueEmail" class="pull-right"></switch>
        </div>
        <div class="form-group">
            <label>
                Opt-In Required
                <span tooltip-placement="top" tooltip-append-to-body="true" tooltip="Opt-in check on contact creation"><i class="fa fa-info-circle" /></span>
            </label>
            <switch name="optInRequired" ng-model="component.optInRequired" class="pull-right"></switch>
        </div>
    </div>

    <h4 class="ssb-sidebar-sub-heading-separator">Submit Settings</h4>
    <div class="row padding-10">
        <div class="form-group">
            <label>
                On Submit Message
                <span tooltip-placement="top" tooltip-append-to-body="true" tooltip="success message on submit"><i class="fa fa-info-circle" /></span>
            </label>
            <textarea id="successMessage" class="form-control margin-bottom-15 autosize area-animated msd-elastic: \n;" ng-model="component.formSettings.successMessage"></textarea>
        </div>

        <div class="form-group">
            <label>
                On Error Message
                <span tooltip-placement="top" tooltip-append-to-body="true" tooltip="error message on submit"><i class="fa fa-info-circle" /></span>
            </label>

            <textarea id="errorMessage" class="form-control margin-bottom-15 autosize area-animated msd-elastic: \n;" ng-model="component.formSettings.errorMessage"></textarea>
        </div>
    </div>

    <div class="row padding-10">
        <div class="well">
            <div class="row">
                <div class="col-sm-12">
                    <label class="block">
                        After Signup Event
                        <span tooltip-placement="top" tooltip-append-to-body="true" tooltip="Select the communication you would like intitiated"><i class="fa fa-info-circle" /></span>
                    </label>
                    <div class="radio radio-inline clip-radio radio-primary">
                        <input type="radio" id="radio3" name="vertical" value="true" ng-model="component.sendEmail">
                        <label for="radio3">
                            Email
                        </label>
                    </div>
                    <div class="radio radio-inline clip-radio radio-primary">
                        <input type="radio" id="radio4" name="vertical" value="false" ng-model="component.sendEmail">
                        <label for="radio4">
                            Campaign
                        </label>
                    </div>
                </div>
            </div>
            <div class="margin-bottom-5" ng-if="component.sendEmail == 'true'">
                <label for="link-page">
                    Select Email
                    <span tooltip-placement="top" tooltip-append-to-body="true" tooltip="Template for email"><i class="fa fa-info-circle" /></span>
                </label>
                <div ng-if="emails">
                    <ui-select ng-model="component.emailId" theme="bootstrap">
                        <ui-select-match placeholder="Select a email" style="outline:0 !important">
                            <small ng-bind-html="$select.selected.title"></small>
                            <span style="position:absolute; right:-15px" class="fa fa-times text-danger" ng-click="component.emailId = null;" ng-show='$select.selected.title'></span>
                        </ui-select-match>
                        <ui-select-choices repeat="email._id as email in emails | filter: $select.search track by $index">
                            <small ng-bind-html="email.title | highlight: $select.search"></small>
                        </ui-select-choices>
                    </ui-select>
                </div>
                <div ng-if="!emailLoaded">
                    <h4><span class="fa fa-spinner fa-spin"></span> Loading Emails...</h4>
                </div>
            </div>
            <div class="margin-bottom-5" ng-if="component.sendEmail == 'false'">
                <label for="link-page">
                    Select Autoresponder Campaign
                    <span tooltip-placement="top" tooltip-append-to-body="true" tooltip="Campaign Selection"><i class="fa fa-info-circle" /></span>
                </label>
                <div ng-if="emails">
                    <ui-select ng-model="component.campaignId" theme="bootstrap">
                        <ui-select-match placeholder="Select a campaign"  style="outline:0 !important">
                            <small ng-bind-html="$select.selected.name"></small>
                            <span style="position:absolute; right:-15px" class="fa fa-times text-danger" ng-click="component.campaignId = null;" ng-show='$select.selected.name'></span>
                        </ui-select-match>
                        <ui-select-choices repeat="campaign._id as campaign in campaigns | filter: $select.search | filter:{ type: 'autoresponder' } track by $index">
                            <small ng-bind-html="campaign.name | highlight: $select.search"></small>
                        </ui-select-choices>
                    </ui-select>
                </div>
                <div ng-if="!emails">
                    <h4><span class="fa fa-spinner fa-spin"></span> Loading Campaigns...</h4>
                </div>
            </div>
        </div>
    </div>
    <div class="row padding-10">
        <div class="well margin-bottom-0">
            <div class="form-group" ng-class="{'margin-bottom-0': !component.redirect}">
                <label for="redirect">
                    Redirect
                    <span tooltip-placement="top" tooltip-append-to-body="true" tooltip="Redirect after submission"><i class="fa fa-info-circle" /></span>
                </label>
                <switch name="redirect" ng-model="component.redirect" class="pull-right"></switch>
            </div>
            <div class="row padding-10">
                <div class="col-sm-12 col-xs-12">
                    <div class="form-group margin-bottom-5" ng-if="component.redirect">
                        <label for="link-title" class="block">
                            Redirect To
                        </label>
                        <div class="radio radio-inline clip-radio radio-primary">
                            <input type="radio" id="radio5" name="redirectOptions" value="page" ng-model="component.redirectType">
                            <label for="radio5">
                                Page
                            </label>
                        </div>
                        <div class="radio radio-inline clip-radio radio-primary">
                            <input type="radio" id="radio6" name="redirectOptions" value="external" ng-model="component.redirectType">
                            <label for="radio6">
                                External
                            </label>
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 col-xs-12">
                    <div class="form-group margin-bottom-5" ng-if="component.redirect && component.redirectType === 'page'">
                        <label for="link-page" class="block">
                            Select Page
                        </label>
                        <div ng-if="allPages" class="redirect-to-page-select">
                            <ui-select ng-model="component.redirectUrl" theme="bootstrap">
                                <ui-select-match placeholder="Select a page">
                                    <small ng-bind-html="$select.selected.title"></small>
                                </ui-select-match>
                                <ui-select-choices repeat="page.handle as page in allPages | filter: $select.search track by $index">
                                    <small ng-bind-html="page.title | highlight: $select.search"></small>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                        <div ng-if="!allPages">
                            <h4><span class="fa fa-spinner fa-spin"></span> Loading Pages...</h4>
                        </div>
                    </div>
                    <div class="form-group margin-bottom-5" ng-if="component.redirect && component.redirectType === 'external'">
                        <label>External URL</label>
                        <input class="form-control" type="text" ng-model="component.redirectUrl">
                    </div>
                </div>
            </div>
            <div class="clearfix"></div>
        </div>
    </div>
</div>
