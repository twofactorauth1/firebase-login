<div ng-controller="BillingCtrl" class="billing container-fluid no-pad-lr">
    <indig-onboarding min-requirements="minRequirements"></indig-onboarding>
    <!-- start: PAGE TITLE -->
    <section id="page-title" class="padding-top-15 padding-bottom-15">
        <div class="row">
            <div class="col-sm-8">
                <h1 class="mainTitle" translate="sidebar.nav.account.BILLING"></h1>
                <span class="mainDescription">View and manage your account.</span>
            </div>
            <div ncy-breadcrumb></div>
        </div>
    </section>
    <!-- end: PAGE TITLE -->
    <!-- start: YOUR CONTENT HERE -->
    <div ng-if="account.billing.plan==='NO_PLAN_ARGUMENT'">
        <billing-trial></billing-trial>
    </div>
    <div class="row" ng-if="account.billing.plan!=='NO_PLAN_ARGUMENT'">
        <div class="row container-fullw bg-white">
            <div class="col-sm-12">
                <div class="col-sm-6">
                    <button type="button" class="btn btn-o btn-lg btn-info btn-wide btn-block btn-scroll btn-scroll-top ti ti-receipt" ng-click="openModal('bill-summary-modal')">
                        <span>Bill Summary</span>
                    </button>
                    <div class="margin-bottom-15 visible-xs"></div>
                </div>
                <div class="col-sm-6">
                    <button type="button" class="btn btn-o btn-lg btn-info btn-wide btn-block btn-scroll btn-scroll-top ti ti-credit-card" ng-click="openModal('change-card-modal')">
                        <span>Payment Method</span>
                    </button>
                    <div class="margin-bottom-15 visible-xs"></div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-4 no-pad-lr">
                <div class="panel panel-info">
                    <div class="panel-heading">
                        <div class="panel-title">
                            <span>Current Plan</span>
                        </div>
                    </div>
                    <div class="panel-body">
                        <billing-subscription 
                            ng-show="!billingSubscriptionUnavailable || priceDollars">
                        </billing-subscription>
                    </div>
                </div>
            </div>
            <div class="col-sm-8 no-pad-lr">
                <div class="panel panel-info">
                    <div class="panel-heading">
                        <div class="panel-title">
                            <span>Invoices</span>
                        </div>
                    </div>
                    <div class="panel-body">
                        <billing-invoice-table></billing-invoice-table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- end: YOUR CONTENT HERE -->
    <script type="text/ng-template" id="view-transaction-modal">
        <div class="modal-header">
            <button type="button" class="close" ng-click="closeModal()">
                <span aria-hidden="true">&times;</span>
                <span class="sr-only">Close</span>
            </button>
            <h3 class="modal-title">Transaction #{{selectedItemIndex + 1}}</h3>
        </div>
        <div class="modal-body view-transaction-modal">
            <img src="../admin/assets/images/paid-in-full.png" class="center paid" width="100" />
            <h4>Pay To:
                        <span class="pull-right">Indigenous Software Inc.</span>
                    </h4>
            <!--<h4>Payment Method: <span class="pull-right">Visa xxxx-xxxx-xxxx-2345 06/15</span></h4>-->
            <h4>Date:
                        <span class="pull-right">{{_moment(selectedInvoice.date)}}</span>
                    </h4>
            <h4>Period:
                        <span class="pull-right">{{_moment(selectedInvoice.lines.data[0].period.start, {subtractNum: 30, subtractType: 'days'})}} - {{_moment(selectedInvoice.lines.data[0].period.start)}}</span>
                    </h4>
            <h4>Amount Paid:
                        <span class="pull-right">${{(selectedInvoice.total/100).toFixed( 2 )}}</span>
                    </h4>
        </div>
    </script>
    <script type="text/ng-template" id="bill-summary-modal">
        <div class="modal-header">
            <button type="button" class="close" ng-click="closeModal()">
                <span aria-hidden="true">×</span>
                <span class="sr-only">Close</span>
            </button>
            <h4 class="modal-title" id="myModalLabel">Bill Summary</h4>
        </div>
        <div ng-if="!upcomingInvoice" class="modal-body">
            No upcoming invoices found
        </div>
        <div ng-if="upcomingInvoice" class="modal-body">
            <billing-invoice upcoming-invoice="upcomingInvoice"></billing-invoice>
        </div>
    </script>
    <script type="text/ng-template" id="change-card-modal">
        <div class="modal-header">
            <button type="button" class="close" ng-click="closeModal()">
                <span aria-hidden="true">×</span>
                <span class="sr-only">Close</span>
            </button>
            <h4 class="modal-title" id="myModalLabel">Change Payment Method</h4>
        </div>
        <div style="padding:10px;">
            <div class="mb20"></div>
            <div class="card-wrapper-change"></div>
            <div class="indigeweb-skeuocard" user='user' update='updateStripeIdFn' auto-close=true wrapper-div="'card-wrapper-change'"></div>
        </div>
    </script>
    <script type="text/ng-template" id="pay-bill-modal">
        <div class="modal-header">
            <button type="button" class="close" ng-click="closeModal()">
                <span aria-hidden="true">×</span>
                <span class="sr-only">Close</span>
            </button>
            <h4 class="modal-title" id="myModalLabel">Verify Payment</h4>
        </div>
        <div class="modal-body">
            <div class="row mb20">
                <div class="col-xs-6">
                    <div class="mb30"></div>
                    <h4 class="center">Amount Due</h4>
                    <h1 class="center total">$99.98</h1>
                </div>
                <div class="col-xs-6">
                    <h4>Current Payment:</h4>
                    <span>due 01SEP14</span>
                    <h4>Period:</h4>
                    <span>01AUG14 - 31AUG14</span>
                </div>
            </div>
            <hr></hr>
            <h4>Pay To:
                        <span class="pull-right">Indigenous Software Inc.</span>
                    </h4>
            <h4 class="pull-left">Payment Method:</h4>
            <span class="pull-right">
                        <select class="form-control">
                            <option>Visa xxxx-xxxx-xxxx-2345 06/15</option>
                            <option>Mastercard xxxx-xxxx-xxxx-9894 09/15</option>
                            <option>Paypal mypaypalemail@gmail.com</option>
                        </select>
                    </span>
            <div class="clearfix"></div>
            <!-- <h4>Date: <span class="pull-right">Monday, September 1st, 2014</span></h4> -->
            <!-- <h4>Amount: <span class="pull-right">$99.98</span></h4> -->
        </div>
        <div class="modal-footer">
            <label class="col-xs-9">Please verify the information above and click "Submit" to authorize us to complete your payment.</label>
            <button type="button" class="btn btn-success btn-lg btn-pay-bill" id="" data-dismiss="modal">
                <span class="fa fa-lock"></span>Submit</button>
        </div>
    </script>
</div>
